function getPartialPage(n){$.ajax({url:"home/"+n,success:function(n){$("#main-content").html(n);$("#main-content").css("display","block");$("#contract-wizard").css("display","none");$("#divExit").css("display","none")}})}function activateNavigation(n){$(".dd-side").each(function(){this.id.toLowerCase()==n.toLowerCase()?$(this).addClass("active"):$(this).removeClass("active")})}function getIndexByProperty(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]==i)return r;return-1}function tagExist(n){var i=ContractEditorNS.TagsData,t;if(i)for(t=0;t<i.length;t++)if(i[t].name==n)return!0;return!1}function getIndexByProperty(n,t,i){for(var r=0;r<n.length;r++)if(n[r][t]==i)return r;return-1}function detailInitVendor(n){var t=n.detailRow;t.find(".contracts-grid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/clientContractList/"+n.data.vendorId,dataType:"json"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sortable:!0,pageable:!0,filterable:!0},dataBound:function(){$('[data-toggle="tooltip"]').tooltip()},scrollable:!1,sortable:!0,pageable:!0,columns:[{field:"title",title:"Name",template:'<div><span style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-html="true" title=" #=description # "> #=title# <\/span><\/div>',width:"250px"},{field:"status",title:"Status",template:"<div style='text-align: center;color:#: status == 'Draft' ?'blue':'green'#\" '> #=status# <\/div>",width:"100px",headerAttributes:{style:"text-align: center"}},{field:"payment",title:"Payment",template:"<div onclick=\"ContractManagementVendorNS.showPayment('#= contractId #')\" style='text-align:center; cursor:pointer; color:#: payment != 'Pending Payment' ? 'green' : 'red' #'>#=payment#<\/div>",width:"110px",headerAttributes:{style:"text-align: center"}},{field:"startDate",title:"Start Date",template:"<div'>#= kendo.toString(kendo.parseDate(startDate, 'yyyy-MM-dd'), 'MM/dd/yyyy') #<\/div>",width:"110px"},{field:"endDate",title:"End Date",template:"<div'>#= kendo.toString(kendo.parseDate(endDate, 'yyyy-MM-dd'), 'MM/dd/yyyy') #<\/div>",width:"110px"},{field:"ammendments",title:"Amendments",template:"<div style='text-align: right; color: #: ammendments == 0 ? 'green' : 'red' #'><span data-toggle='tooltip' data-placement='top' title='#= ammendments  > 0 ? \"View amendments\" : \"No amendments\" #' onclick=\"ContractManagementVendorNS.showAmmendments('#= contractId #', '#=ammendments#')\"> #=ammendments#<\/span><\/div>",width:"110px"},{field:"addProduct",title:"Add Product",template:"<div style='text-align: center; cursor:pointer'><i onclick=\"ContractManagementVendorNS.addProduct('"+n.data.vendorId+"','#= contractId #','#=status#','#=title#')\" class='fas fa-cube'><\/i><\/div>",width:"110px"},{field:"actions",title:"Edit Contract",template:"<div style='text-align:center; cursor:pointer'><i onclick=\"ContractManagementVendorNS.showEditContract('"+n.data.vendorId+"','#= contractId #','#=status#','#=title#')\" class='fas fa-pencil-alt'><\/i><\/div>",headerAttributes:{style:"text-align: center"},width:"100px"}]})}function detailInit(n){var t=n.detailRow;t.find(".contracts-grid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/contractList?vendorId="+n.data.vendorId,dataType:"json"}},serverPaging:!0,serverSorting:!0,serverFiltering:!0,pageSize:10,sortable:!0,pageable:!0,filterable:!0},dataBound:function(){$('[data-toggle="tooltip"]').tooltip()},scrollable:!1,sortable:!0,pageable:!0,columns:[{field:"title",title:"Name",template:'<div><span style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-html="true" title=" #=description # "> #=title# <\/span><\/div>',width:"250px"},{field:"status",title:"Status",template:"<div style='text-align: center;color:#: status == 'Draft' ?'blue':'green'#\" '> #=status# <\/div>",width:"100px",headerAttributes:{style:"text-align: center"}},{field:"payment",title:"Payment",template:"<div onclick=\"ContractManagementNS.showPayment('#= contractId #')\" style='text-align:center; cursor:pointer; color:#: payment != 'Pending Payment' ? 'green' : 'red' #'>#=payment#<\/div>",width:"110px",headerAttributes:{style:"text-align: center"}},{field:"startDate",title:"Start Date",template:"<div'>#= kendo.toString(kendo.parseDate(startDate, 'yyyy-MM-dd'), 'MM/dd/yyyy') #<\/div>",width:"110px"},{field:"endDate",title:"End Date",template:"<div'>#= kendo.toString(kendo.parseDate(endDate, 'yyyy-MM-dd'), 'MM/dd/yyyy') #<\/div>",width:"110px"},{field:"ammendments",title:"Amendments",template:"<div style='text-align: right; color: #: ammendments == 0 ? 'black' : 'green' #'><span data-toggle='tooltip' data-placement='top' title='#= ammendments  > 0 ? \"View amendments\" : \"No amendments\" #' onclick=\"ContractManagementNS.showAmmendments('#= contractId #', '#=ammendments#')\"> #=ammendments#<\/span><\/div>",headerAttributes:{style:"text-align: right"},width:"110px"},{field:"addProduct",title:"Add Product",template:"<div style='text-align: center; cursor:pointer'><i onclick=\"ContractManagementNS.addProduct('"+n.data.vendorId+"','#= contractId #','#=status#','#=title#')\" class='fas fa-cube'><\/i><\/div>",headerAttributes:{style:"text-align: center"},width:"110px"},{field:"actions",title:"Edit Contract",template:"<div style='text-align:center; cursor:pointer'><i onclick=\"ContractManagementNS.showEditContract('"+n.data.vendorId+"','#= contractId #','#=status#','#=title#')\" class='fas fa-pencil-alt'><\/i><\/div>",headerAttributes:{style:"text-align: center"},width:"100px"}]})}function parseBoolean(n){return n.toLowerCase()=="true"?!0:n.toLowerCase()=="false"?!1:undefined}function setError(n){$("#wizard").smartWizard("setError",{stepnum:n,iserror:!0})}function leaveAStepCallback(n,t){return validateSteps(t.toStep,t.fromStep)}function onFinishCallback(){}function validateSteps(n,t){var i=!0,r="Please check all required fields",u;return t==1&&n==2?(!ContractGeneralInformationNS.Mode==1||$("#contact-permission-grid").data().kendoGrid.dataSource.view().length<1)&&(i=!1,r="Please check all required fields. Should have a permission to continue"):t==2&&n==3?ContractEditorNS.SelSectionCount===0&&(r="Please select at least 1 section.",i=!1):t==3&&n==4&&(u=$("#contractProduct-grid").data("kendoGrid"),u.dataSource.total()===0&&(r="Please add at least 1 product.",i=!1)),i?ContractWizardNS.showPartialPage(n):toastr.info(r),i}function validateEmail(n){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())}function customCanReadEditor(n){var t=kendo.guid();$('<input class="k-checkbox" id="'+t+'" type="checkbox" name="canRead" data-type="boolean" data-bind="checked:canRead">').appendTo(n);$('<label class="k-checkbox-label" for="'+t+'">&#8203;<\/label>').appendTo(n)}function customCanWriteEditor(n){var t=kendo.guid();$('<input class="k-checkbox" id="'+t+'" type="checkbox" name="canWrite" data-type="boolean" data-bind="checked:canWrite">').appendTo(n);$('<label class="k-checkbox-label" for="'+t+'">&#8203;<\/label>').appendTo(n)}function customBoolEditor(n){var t=kendo.guid();$('<input class="k-checkbox" id="'+t+'" type="checkbox" name="Discontinued" data-type="boolean" data-bind="checked:Discontinued">').appendTo(n);$('<label class="k-checkbox-label" for="'+t+'">&#8203;<\/label>').appendTo(n)}function TryParseInt(n,t){var i=t;return n!==null&&n.length>0&&(isNaN(n)||(i=parseInt(n))),i}function TryParseInt(n,t){var i=t;return n!==null&&n.length>0&&(isNaN(n)||(i=parseInt(n))),i}function TryParseInt(n,t){var i=t;return n!==null&&n.length>0&&(isNaN(n)||(i=parseInt(n))),i}function validateEmail(n){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(n).toLowerCase())}function countChecked(){checkState==="all"&&$(".bulk_action input[name='table_records']").iCheck("check");checkState==="none"&&$(".bulk_action input[name='table_records']").iCheck("uncheck");var n=$(".bulk_action input[name='table_records']:checked").length;n?($(".column-title").hide(),$(".bulk-actions").show(),$(".action-cnt").html(n+" Records Selected")):($(".column-title").show(),$(".bulk-actions").hide())}var navList=[],app,ContractApprovalNonCreatorNS,ContractApprovalNS,ContractEditorManagementNS,ContractEditorNS,ContractGeneralInformationHistoryNS,ContractGeneralInformationNS,ContractManagementVendorNS,ContractManagementNS,ContractProductNS,ContractTemplateManagementNS,ContractWizardNS,EmailManagementNS,countryList,ProductManagementNS,AccessManagementNS,RoleManagementNS,UserManagementNS,MyProfile,VendorHistoryNS,VendorManagementNS,checkState;navList.push({Name:"dashboard"});navList.push({Name:"myprofile"});navList.push({Name:"contracts"});navList.push({Name:"users"});window.location.href.toLowerCase().indexOf("index")>-1&&(window.location="/#dashboard");app=$.sammy(function(){this.get("/home/index/#",function(){getPartialPage("dashboard")});this.get("#dashboard",function(){getPartialPage("dashboard")});this.get("#myprofile",function(){getPartialPage("myprofile")});this.get("#users",function(){getPartialPage("UserManagement")});this.get("#contracts",function(){getPartialPage("Contracts")});this.get("#profile",function(){getPartialPage("Profile")});this.get("#email",function(){getPartialPage("EmailManagement")});this.get("#product",function(){getPartialPage("ProductManagement")});this.get("#contact",function(){getPartialPage("ContactManagement")})}).run("#dashboard");ContractApprovalNonCreatorNS={};ContractApprovalNonCreatorNS.ContractId=null;ContractApprovalNonCreatorNS.ContractSectionId=null;ContractApprovalNonCreatorNS.CurrentUserId=null;ContractApprovalNonCreatorNS.OwnerId=null;ContractApprovalNonCreatorNS.SectionList=[];ContractApprovalNonCreatorNS.NewlyEntered=!0;ContractApprovalNonCreatorNS.OldVersionSectionCount=0;ContractApprovalNonCreatorNS.init=function(n,t,i){ContractApprovalNonCreatorNS.NewlyEntered=!0;ContractApprovalNonCreatorNS.CurrentUserId=t;ContractApprovalNonCreatorNS.ContractId=n;ContractApprovalNonCreatorNS.OwnerId=i;ContractApprovalNonCreatorNS.SectionList=[];ContractApprovalNonCreatorNS.ContractSectionId=null;ContractApprovalNonCreatorNS.initializeControls(n);ContractApprovalNonCreatorNS.getContractSections(n)};ContractApprovalNonCreatorNS.initializeControls=function(){$("#sectionList").kendoSortable({disabled:".list-item.not-sortable"});$("#contractSectionContent").kendoEditor({resizable:{content:!0,toolbar:!0},tools:[]});$($("#contractSectionContent").data().kendoEditor.body).attr("contenteditable",!1);$("#approver-history").kendoGrid({dataSource:{data:[],schema:{model:{fields:{dateSubmitted:{type:"date"},reviewer:{type:"string"},status:{type:"string"},remarks:{type:"string"}}}},pageSize:20},noRecords:!0,sortable:!0,filterable:!0,scrollable:!1,dataBound:function(){},messages:{noRecords:"No History Yet"},editable:"inline",columns:[{field:"dateSubmitted",title:"Date Submitted",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"reviewer",title:"Reviewer",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"status",title:"Status",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},template:'<div class="#: status  == 1 ? "gray-bg" : status == 2 ? "red-bg": status == 3 ? "orange-bg" : "green-bg" #" style="border-radius:2px;"> #=statusText#<\/div>'},{field:"remarks",title:"Remarks",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},]});$("#reviewers").length>0&&ContractApprovalNonCreatorNS.getReviewers(ContractApprovalNonCreatorNS.ContractId);$("#btnAddApprover").click(function(n){n.preventDefault();var t={};t.ApproverId=$("#reviewers").val();t.ContractSectionId=ContractApprovalNonCreatorNS.ContractSectionId;t.Remarks=$("#assingerRemarks").val();ContractApprovalNonCreatorNS.updateApprover(ContractApprovalNonCreatorNS.ContractSectionId,t)});$("#btnShowAddApprover").click(function(){$("#btnAddApprover").show()});$("#btnApproveSection").click(function(){var n={};n.UserInfoId=ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase();n.ContractSectionId=ContractApprovalNonCreatorNS.ContractSectionId;n.Remarks=$("#approverRemarks").val();n.Remarks==null?toastr.error("Remarks is required"):ContractApprovalNonCreatorNS.approveContractSection(ContractApprovalNonCreatorNS.ContractSectionId.toLowerCase(),n)});$("#btnRejectSection").click(function(){var n={};n.UserInfoId=ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase();n.ContractSectionId=ContractApprovalNonCreatorNS.ContractSectionId;n.Remarks=$("#approverRemarks").val();n.Remarks==null?toastr.error("Remarks is required"):ContractApprovalNonCreatorNS.rejectContractSection(ContractApprovalNonCreatorNS.ContractSectionId.toLowerCase(),n)});$("#contractApprovalSubmitToVendor").click(function(){for(var i,n=!0,t=0;t<ContractApprovalNonCreatorNS.SectionList.length;t++)ContractApprovalNonCreatorNS.SectionList[t].status!=4&&(n=!1);$("#contractNotesForApproval").val()||(n=!1,toastr.error("Notes is required"));n&&(i={},i.Notes=$("#contractNotesForApproval").val(),ContractApprovalNonCreatorNS.updateContractToApprove(ContractApprovalNonCreatorNS.ContractId,i))});$("#contractApprovalSubmitToVendor2").click(function(){var t=!0,n;$("#contractNotesForNotSigned").val()||(t=!1,toastr.error("Notes is required"));t&&(n={},n.Notes=$("#contractNotesForNotSigned").val(),ContractApprovalNonCreatorNS.updateContractToNotSigned(ContractApprovalNonCreatorNS.ContractId,n))});$("#approverChanger").click(function(){$("#approverAdder").show();$("#approverChanger").hide()})};ContractApprovalNonCreatorNS.updateContractToApprove=function(n,t){$.ajax({url:"api/contract/"+n+"/updateContractToApprove",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#approve-contract-modal").modal("toggle");$("#lblContractStatus").text("Approved");$("#contractGrid").data("kendoGrid").dataSource.read();toastr.success("Contract is now approved!");$(".buttonExit").trigger("click");$("#contractNotesForApproval").val(null)},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNonCreatorNS.updateContractToNotSigned=function(n,t){$.ajax({url:"api/contract/"+n+"/updateContractToNotSigned",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#not-signed-contract-modal").modal("toggle");$("#lblContractStatus").text("Not Signed");$("#contractGrid").data("kendoGrid").dataSource.read();toastr.success("Contract is not signed!");$(".buttonExit").trigger("click");$("#contractNotesForNotSigned").val(null)},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNonCreatorNS.getReviewers=function(n){$.ajax({url:"api/contract/"+n+"/companyusers",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){for(var t=0;t<n.length;t++)$("#reviewers").append($("<option><\/option>").attr("value",n[t].userInfoId).text(n[t].fullName))},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNonCreatorNS.getContractSections=function(n){ContractApprovalNonCreatorNS.SectionList=[];$.ajax({url:"api/contract/"+n+"/nonOwnerContractSections",type:"GET",contentType:"application/json; charset=utf-8",success:function(t){var f=0,o,r,e,u,i;for($("#sectionList").empty(),o="",i=0;i<t.length;i++)r="",t[i].status==1?r+="<li class='list-item not-sortable gray-bg section-list-item' onclick='ContractApprovalNonCreatorNS.loadContent(\""+t[i].contractSectionId+"\")' data-id='"+t[i].contractSectionId+"'> "+t[i].name+"<\/li>":t[i].status==2?r+="<li class='list-item not-sortable red-bg section-list-item' onclick='ContractApprovalNonCreatorNS.loadContent(\""+t[i].contractSectionId+"\")' data-id='"+t[i].contractSectionId+"'> "+t[i].name+"<\/li>":t[i].status==3?r+="<li class='list-item not-sortable orange-bg section-list-item' onclick='ContractApprovalNonCreatorNS.loadContent(\""+t[i].contractSectionId+"\")' data-id='"+t[i].contractSectionId+"'> "+t[i].name+"<\/li>":t[i].status==4&&(r+="<li class='list-item not-sortable green-bg section-list-item' onclick='ContractApprovalNonCreatorNS.loadContent(\""+t[i].contractSectionId+"\")' data-id='"+t[i].contractSectionId+"'>"+t[i].name+"<\/li>",f++),e=$("#sectionList"),e.append(r),ContractApprovalNonCreatorNS.SectionList.push({contractSectionId:t[i].contractSectionId,approverId:t[i].approverId,approver:t[i].approver,status:t[i].status,name:t[i].name,content:t[i].content,contractSectionTags:t[i].contractSectionTags});if($("#sectionList li").click(function(){$("#sectionList li").removeClass("highlight");$(this).addClass("highlight")}),ContractApprovalNonCreatorNS.NewlyEntered){for(u=!1,i=0;i<ContractApprovalNonCreatorNS.SectionList.length;i++)if(console.log(ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()+" "+ContractApprovalNonCreatorNS.SectionList[i].approverId),ContractApprovalNonCreatorNS.SectionList[i].approverId&&ContractApprovalNonCreatorNS.SectionList[i].approverId.toLowerCase()==ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()&&ContractApprovalNonCreatorNS.SectionList[i].status==2){$("ul li.section-list-item:nth-child("+(i+1)+")").trigger("click");u=!0;break}if(!u)for(i=0;i<ContractApprovalNonCreatorNS.SectionList.length;i++)if(console.log(ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()+" "+ContractApprovalNonCreatorNS.SectionList[i].approverId),ContractApprovalNonCreatorNS.SectionList[i].approverId&&ContractApprovalNonCreatorNS.SectionList[i].approverId.toLowerCase()==ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()&&ContractApprovalNonCreatorNS.SectionList[i].status==3){$("ul li.section-list-item:nth-child("+(i+1)+")").trigger("click");u=!0;break}u||$("ul li.section-list-item:nth-child(1)").trigger("click");ContractApprovalNonCreatorNS.NewlyEntered=!1}$.ajax({url:"api/contract/"+n+"/contractversion",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){f==t.length&&n%2!=0?$("#btnApproveContract").prop("disabled",!1):$("#btnApproveContract").prop("disabled",!0)},error:function(){toastr.error("Something went wrong with the request!")}})},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNonCreatorNS.loadContent=function(n){function r(t){return t.contractSectionId.toLowerCase()===n.toLowerCase()}var t,i;if(ContractApprovalNonCreatorNS.clearRemarkFields(),$("#approverRemarks").val(null),$("#assingerRemarks").val(null),t=ContractApprovalNonCreatorNS.SectionList.find(r),ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()!=ContractApprovalNonCreatorNS.OwnerId.toLowerCase()&&!t.approverId){toastr.error("You do not have access to see the content");return}if(ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()!=ContractApprovalNonCreatorNS.OwnerId.toLowerCase()&&t.approverId&&t.approverId.toLowerCase()!=ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()){toastr.error("You do not have access to see the content");return}i=$("#contractSectionContent").data("kendoEditor");i.value(t.content);$("#reviewers").val($("#reviewers option:first").val());ContractApprovalNonCreatorNS.ContractSectionId=t.contractSectionId;ContractApprovalNonCreatorNS.getHistory(t.contractSectionId);t.status==4?($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").hide()):t.approverId||ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()!=ContractApprovalNonCreatorNS.OwnerId.toLowerCase()?t.approverId||ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==ContractApprovalNonCreatorNS.OwnerId.toLowerCase()?t.approverId&&ContractApprovalNonCreatorNS.OwnerId.toLowerCase()==ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()&&t.status==2?($("#approverAdder").show(),$("#approverChanger").hide(),$("#approverControls").hide(),console.log("i am the creator and it is rejected")):t.approverId&&ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==t.approverId.toLowerCase()&&ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==ContractApprovalNonCreatorNS.OwnerId.toLowerCase()?(t.status==3&&$("#approverControls").show(),$("#approverAdder").hide(),$("#approverChanger").show()):t.approverId&&ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==t.approverId.toLowerCase()?($("#approverAdder").hide(),$("#approverChanger").hide(),$("#approverControls").show()):t.approverId&&ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==ContractApprovalNonCreatorNS.OwnerId.toLowerCase()?(t.status==3?$("#approverAdder").hide():$("#approverControls").hide(),$("#approverAdder").hide(),$("#approverChanger").show()):($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").hide()):($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").hide(),console.log("no approver yet and i am not creator")):($("#approverAdder").show(),$("#approverControls").hide(),$("#approverChanger").hide(),console.log("no approver yet and i am the creator"));ContractApprovalNonCreatorNS.getSectionTagsValue(t.contractSectionTags,t.content)};ContractApprovalNonCreatorNS.SplitTags=function(n){var r=[],t,i,u,f;if(n){if(t=n.split(","),t.length>0){for(i=0;i<t.length;i++)u={},u.ContractTagId=t[i],f=r.find(n=>n.ContractTagId===t[i]),f===undefined&&r.push(u);return r}return null}};ContractApprovalNonCreatorNS.ReplaceContentValue=function(n,t,i){var u,f,r,e,o;if(t){if(u=t.split(","),u.length>0)for(f=0;f<u.length;f++)r=n.find(n=>n.contractTagId===u[f]),e='<span style="color:white;padding:1px 5px;background-color:'+r.color+';">'+r.name+"<\/span>",i=i.replace(new RegExp(e,"g"),r.value)}else r=n.find(n=>n.contractTagId===u[0]),e='<span style="color:white;padding:1px 5px;background-color:'+r.color+';">'+r.name+"<\/span>",i=i.replace(new RegExp(e,"g"),r.value);o=$("#contractSectionContent").data("kendoEditor");o.value(i)};ContractApprovalNonCreatorNS.getSectionTagsValue=function(n,t){var i=ContractApprovalNonCreatorNS.SplitTags(n);n&&$.ajax({url:"api/Contract/getAllSectionTags",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(i){i!=!1&&i!="false"&&ContractApprovalNonCreatorNS.ReplaceContentValue(i,n,t)},error:function(){toastr.error("Something went wrong with GetSectionTags request!")}})};ContractApprovalNonCreatorNS.getHistory=function(n){$.ajax({url:"api/contract/"+n+"/nonOwnerContractsectionhistory",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){ContractApprovalNonCreatorNS.populateContractSectionHistory(n)},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNonCreatorNS.populateContractSectionHistory=function(n){$("#approver-history").data("kendoGrid").dataSource.data([]);var t=new kendo.data.DataSource({data:n,schema:{model:{fields:{dateSubmitted:{type:"date"},reviewer:{type:"string"},status:{type:"string"},remarks:{type:"string"}}}},pageSize:20}),i=$("#approver-history").data("kendoGrid");i.setDataSource(t)};ContractApprovalNonCreatorNS.updateApprover=function(n,t){$.ajax({url:"api/contract/"+n+"/updateNonOwnerApprover",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){toastr.success("Approver successfully updated");ContractApprovalNonCreatorNS.getHistory(n);ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==t.ApproverId.toLowerCase()?($("#approverAdder").hide(),$("#approverControls").show(),$("#approverChanger").show()):($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").show());ContractApprovalNonCreatorNS.getContractSections(ContractApprovalNonCreatorNS.ContractId);ContractApprovalNonCreatorNS.clearRemarkFields()},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNonCreatorNS.approveContractSection=function(n,t){$.ajax({url:"api/contract/"+n+"/approveNonOwner",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#approverControls").hide();toastr.success("Review submitted");ContractApprovalNonCreatorNS.getHistory(n);ContractApprovalNonCreatorNS.getContractSections(ContractApprovalNonCreatorNS.ContractId);ContractApprovalNonCreatorNS.clearRemarkFields();ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==ContractApprovalNonCreatorNS.OwnerId.toLowerCase()&&($("#approverAdder").hide(),$("#approverChanger").hide())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNonCreatorNS.rejectContractSection=function(n,t){$.ajax({url:"api/contract/"+n+"/rejectNonOwner",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#approverControls").hide();toastr.success("Review submitted");ContractApprovalNonCreatorNS.getHistory(n);ContractApprovalNonCreatorNS.getContractSections(ContractApprovalNonCreatorNS.ContractId);ContractApprovalNonCreatorNS.clearRemarkFields();ContractApprovalNonCreatorNS.CurrentUserId.toLowerCase()==ContractApprovalNonCreatorNS.OwnerId.toLowerCase()&&($("#approverAdder").show(),$("#approverControls").hide(),$("#approverChanger").hide())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNonCreatorNS.clearRemarkFields=function(){$("#approverRemarks").val(null);$("#assingerRemarks").val(null)};ContractApprovalNS={};ContractApprovalNS.ContractId=null;ContractApprovalNS.ContractSectionId=null;ContractApprovalNS.CurrentUserId=null;ContractApprovalNS.OwnerId=null;ContractApprovalNS.SectionList=[];ContractApprovalNS.NewlyEntered=!0;ContractApprovalNS.IsClient=null;ContractApprovalNS.AttachmentPaymentName="";ContractApprovalNS.TagsData=[];ContractApprovalNS.init=function(n,t,i,r){ContractApprovalNS.NewlyEntered=!0;ContractApprovalNS.CurrentUserId=t;ContractApprovalNS.ContractId=n;ContractApprovalNS.OwnerId=i;ContractApprovalNS.SectionList=[];ContractApprovalNS.ContractSectionId=null;ContractApprovalNS.initializeControls(n);ContractApprovalNS.getContractSections(n);ContractApprovalNS.IsClient=r};ContractApprovalNS.initializeControls=function(){$("#sectionList").kendoSortable({disabled:".list-item.not-sortable"});$("#contractSectionContent").kendoEditor({resizable:{content:!0,toolbar:!0},tools:[]});$($("#contractSectionContent").data().kendoEditor.body).attr("contenteditable",!1);$("#approver-history").kendoGrid({dataSource:{data:[],schema:{model:{fields:{dateSubmitted:{type:"date"},reviewer:{type:"string"},status:{type:"string"},remarks:{type:"string"}}}},pageSize:20},noRecords:!0,sortable:!0,filterable:!0,scrollable:!1,dataBound:function(){},messages:{noRecords:"No History Yet"},editable:"inline",columns:[{field:"dateSubmitted",title:"Date Submitted",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"reviewer",title:"Reviewer",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"status",title:"Status",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},template:'<div class="#: status  == 1 ? "gray-bg" : status == 2 ? "red-bg": status == 3 ? "orange-bg" : "green-bg" #" style="border-radius:2px;"> #=statusText#<\/div>'},{field:"remarks",title:"Remarks",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},]});$("#reviewers").length>0&&ContractApprovalNS.getReviewers(ContractApprovalNS.ContractId);$("#btnAddApprover").click(function(n){n.preventDefault();var t={};t.ApproverId=$("#reviewers").val();t.ContractSectionId=ContractApprovalNS.ContractSectionId;t.Remarks=$("#assingerRemarks").val();t.Remarks?ContractApprovalNS.updateApprover(ContractApprovalNS.ContractSectionId,t):toastr.add("Remarks is required")});$("#btnShowAddApprover").click(function(){$("#btnAddApprover").show()});$("#btnApproveSection").click(function(){var n={};n.UserInfoId=ContractApprovalNS.CurrentUserId.toLowerCase();n.ContractSectionId=ContractApprovalNS.ContractSectionId;n.Remarks=$("#approverRemarks").val();n.Remarks?ContractApprovalNS.approveContractSection(ContractApprovalNS.ContractSectionId.toLowerCase(),n):toastr.error("Remarks is required")});$("#btnRejectSection").click(function(){var n={};n.UserInfoId=ContractApprovalNS.CurrentUserId.toLowerCase();n.ContractSectionId=ContractApprovalNS.ContractSectionId;n.Remarks=$("#approverRemarks").val();n.Remarks?ContractApprovalNS.rejectContractSection(ContractApprovalNS.ContractSectionId.toLowerCase(),n):toastr.error("Remarks is required")});$("#contractApprovalSubmitToVendor").click(function(){for(var i,n=!0,t=0;t<ContractApprovalNS.SectionList.length;t++)ContractApprovalNS.SectionList[t].status!=4&&(n=!1);$("#contractNotesForSubmission").val()||(n=!1,toastr.error("Notes is required"));n&&(i={},i.Notes=$("#contractNotesForSubmission").val(),ContractApprovalNS.updateContractToPendingReview(ContractApprovalNS.ContractId,i))});$("#btnSetContractToActive").click(function(){for(var t=!0,n=0;n<ContractApprovalNS.SectionList.length;n++)ContractApprovalNS.SectionList[n].status!=4&&(t=!1);t?ContractApprovalNS.updateContractToActive(ContractApprovalNS.ContractId):toastr.error("Notes is required")});$("#approverChanger").click(function(){$("#approverAdder").show();$("#approverChanger").hide()})};ContractApprovalNS.getReviewers=function(n){$.ajax({url:"api/contract/"+n+"/companyusers",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){for(var t=0;t<n.length;t++)$("#reviewers").append($("<option><\/option>").attr("value",n[t].userInfoId).text(n[t].fullName))},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNS.getContractSections=function(n){ContractApprovalNS.SectionList=[];$.ajax({url:"api/contract/"+n+"/contractsections",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){var u=0,e,i,f,r,t;for($("#sectionList").empty(),e="",t=0;t<n.length;t++)i="",n[t].status==1?i+="<li class='list-item not-sortable gray-bg section-list-item' onclick='ContractApprovalNS.loadContent(\""+n[t].contractSectionId+"\")' data-id='"+n[t].contractSectionId+"'> "+n[t].name+"<\/li>":n[t].status==2?i+="<li class='list-item not-sortable red-bg section-list-item' onclick='ContractApprovalNS.loadContent(\""+n[t].contractSectionId+"\")' data-id='"+n[t].contractSectionId+"'> "+n[t].name+"<\/li>":n[t].status==3?i+="<li class='list-item not-sortable orange-bg section-list-item' onclick='ContractApprovalNS.loadContent(\""+n[t].contractSectionId+"\")' data-id='"+n[t].contractSectionId+"'> "+n[t].name+"<\/li>":n[t].status==4&&(i+="<li class='list-item not-sortable green-bg section-list-item' onclick='ContractApprovalNS.loadContent(\""+n[t].contractSectionId+"\")' data-id='"+n[t].contractSectionId+"'>"+n[t].name+"<\/li>",u++),f=$("#sectionList"),f.append(i),ContractApprovalNS.SectionList.push({contractSectionId:n[t].contractSectionId,approverId:n[t].approverId,approver:n[t].approver,status:n[t].status,name:n[t].name,content:n[t].content,contractSectionTags:n[t].contractSectionTags});if($("#sectionList li").click(function(){$("#sectionList li").removeClass("highlight");$(this).addClass("highlight")}),u==n.length?$("#btnToSubmitToVendor").prop("disabled",!1):$("#btnToSubmitToVendor").prop("disabled",!0),ContractApprovalNS.NewlyEntered){for(r=!1,t=0;t<ContractApprovalNS.SectionList.length;t++)if(console.log(ContractApprovalNS.CurrentUserId.toLowerCase()+" "+ContractApprovalNS.SectionList[t].approverId),ContractApprovalNS.SectionList[t].approverId&&ContractApprovalNS.SectionList[t].approverId.toLowerCase()==ContractApprovalNS.CurrentUserId.toLowerCase()&&ContractApprovalNS.SectionList[t].status==2){$("ul li.section-list-item:nth-child("+(t+1)+")").trigger("click");r=!0;break}if(!r)for(t=0;t<ContractApprovalNS.SectionList.length;t++)if(console.log(ContractApprovalNS.CurrentUserId.toLowerCase()+" "+ContractApprovalNS.SectionList[t].approverId),ContractApprovalNS.SectionList[t].approverId&&ContractApprovalNS.SectionList[t].approverId.toLowerCase()==ContractApprovalNS.CurrentUserId.toLowerCase()&&ContractApprovalNS.SectionList[t].status==3){$("ul li.section-list-item:nth-child("+(t+1)+")").trigger("click");r=!0;break}r||$("ul li.section-list-item:nth-child(1)").trigger("click");ContractApprovalNS.NewlyEntered=!1}},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNS.loadContent=function(n){function r(t){return t.contractSectionId.toLowerCase()===n.toLowerCase()}var t,i;if(ContractApprovalNS.clearRemarkFields(),$("#approverRemarks").val(null),$("#assingerRemarks").val(null),t=ContractApprovalNS.SectionList.find(r),ContractApprovalNS.CurrentUserId.toLowerCase()!=ContractApprovalNS.OwnerId.toLowerCase()&&!t.approverId){toastr.error("You do not have access to see the content");return}if(ContractApprovalNS.CurrentUserId.toLowerCase()!=ContractApprovalNS.OwnerId.toLowerCase()&&t.approverId&&t.approverId.toLowerCase()!=ContractApprovalNS.CurrentUserId.toLowerCase()){toastr.error("You do not have access to see the content");return}i=$("#contractSectionContent").data("kendoEditor");i.value(t.content);$("#reviewers").val($("#reviewers option:first").val());ContractApprovalNS.ContractSectionId=t.contractSectionId;ContractApprovalNS.getHistory(t.contractSectionId);t.status==4?($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").hide()):t.approverId||ContractApprovalNS.CurrentUserId.toLowerCase()!=ContractApprovalNS.OwnerId.toLowerCase()?t.approverId||ContractApprovalNS.CurrentUserId.toLowerCase()==ContractApprovalNS.OwnerId.toLowerCase()?t.approverId&&ContractApprovalNS.OwnerId.toLowerCase()==ContractApprovalNS.CurrentUserId.toLowerCase()&&t.status==2?($("#approverAdder").show(),$("#approverChanger").hide(),$("#approverControls").hide(),console.log("i am the creator and it is rejected")):t.approverId&&ContractApprovalNS.CurrentUserId.toLowerCase()==t.approverId.toLowerCase()&&ContractApprovalNS.CurrentUserId.toLowerCase()==ContractApprovalNS.OwnerId.toLowerCase()?(t.status==3&&$("#approverControls").show(),$("#approverAdder").hide(),$("#approverChanger").show()):t.approverId&&ContractApprovalNS.CurrentUserId.toLowerCase()==t.approverId.toLowerCase()?($("#approverAdder").hide(),$("#approverChanger").hide(),$("#approverControls").show()):t.approverId&&ContractApprovalNS.CurrentUserId.toLowerCase()==ContractApprovalNS.OwnerId.toLowerCase()?(t.status==3?$("#approverAdder").hide():$("#approverControls").hide(),$("#approverAdder").hide(),$("#approverChanger").show()):($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").hide()):($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").hide(),console.log("no approver yet and i am not creator")):($("#approverAdder").show(),$("#approverControls").hide(),$("#approverChanger").hide(),console.log("no approver yet and i am the creator"));ContractApprovalNS.getSectionTagsValue(t.contractSectionTags,t.content)};ContractApprovalNS.SplitTags=function(n){var r=[],t,i,u,f;if(n){if(t=n.split(","),t.length>0){for(i=0;i<t.length;i++)u={},u.ContractTagId=t[i],f=r.find(n=>n.ContractTagId===t[i]),f===undefined&&r.push(u);return r}return null}};ContractApprovalNS.ReplaceContentValue=function(n,t,i){var u,f,r,e,o;if(t){if(u=t.split(","),u.length>0)for(f=0;f<u.length;f++)r=n.find(n=>n.contractTagId===u[f]),e='<span style="color:white;padding:1px 5px;background-color:'+r.color+';">'+r.name+"<\/span>",i=i.replace(new RegExp(e,"g"),r.value)}else r=n.find(n=>n.contractTagId===u[0]),e='<span style="color:white;padding:1px 5px;background-color:'+r.color+';">'+r.name+"<\/span>",i=i.replace(new RegExp(e,"g"),r.value);o=$("#contractSectionContent").data("kendoEditor");o.value(i)};ContractApprovalNS.getSectionTagsValue=function(n,t){var i=ContractApprovalNS.SplitTags(n);n&&$.ajax({url:"api/Contract/getAllSectionTags",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(i){i!=!1&&i!="false"&&ContractApprovalNS.ReplaceContentValue(i,n,t)},error:function(){toastr.error("Something went wrong with GetSectionTags request!")}})};ContractApprovalNS.getHistory=function(n){$.ajax({url:"api/contract/"+n+"/contractsectionhistory",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){ContractApprovalNS.populateContractSectionHistory(n)},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNS.populateContractSectionHistory=function(n){$("#approver-history").data("kendoGrid").dataSource.data([]);var t=new kendo.data.DataSource({data:n,schema:{model:{fields:{dateSubmitted:{type:"date"},reviewer:{type:"string"},status:{type:"string"},remarks:{type:"string"}}}},pageSize:20}),i=$("#approver-history").data("kendoGrid");i.setDataSource(t)};ContractApprovalNS.updateApprover=function(n,t){$.ajax({url:"api/contract/"+n+"/updateapprover",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){toastr.success("Approver successfully updated");ContractApprovalNS.getHistory(n);ContractApprovalNS.CurrentUserId.toLowerCase()==t.ApproverId.toLowerCase()?($("#approverAdder").hide(),$("#approverControls").show(),$("#approverChanger").show()):($("#approverAdder").hide(),$("#approverControls").hide(),$("#approverChanger").show());ContractApprovalNS.getContractSections(ContractApprovalNS.ContractId);ContractApprovalNS.clearRemarkFields()},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNS.approveContractSection=function(n,t){$.ajax({url:"api/contract/"+n+"/approve",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#approverControls").hide();toastr.success("Review submitted");ContractApprovalNS.getHistory(n);ContractApprovalNS.getContractSections(ContractApprovalNS.ContractId);ContractApprovalNS.clearRemarkFields();ContractApprovalNS.CurrentUserId.toLowerCase()==ContractApprovalNS.OwnerId.toLowerCase()&&($("#approverAdder").hide(),$("#approverChanger").hide())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNS.rejectContractSection=function(n,t){$.ajax({url:"api/contract/"+n+"/reject",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#approverControls").hide();toastr.success("Review submitted");ContractApprovalNS.getHistory(n);ContractApprovalNS.getContractSections(ContractApprovalNS.ContractId);ContractApprovalNS.clearRemarkFields();ContractApprovalNS.CurrentUserId.toLowerCase()==ContractApprovalNS.OwnerId.toLowerCase()&&($("#approverAdder").show(),$("#approverControls").hide(),$("#approverChanger").hide())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNS.updateContractToPendingReview=function(n,t){$("#contractNotesForSubmission").val(null);$.ajax({url:"api/contract/"+n+"/updateContractToPendingReview",type:"PUT",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(){$("#submit-to-other-entity").modal("toggle");$("#lblContractStatus").text("Pending Review");toastr.success("Contract successfully submitted for review");$(".buttonExit").trigger("click");$("#contractGrid").data("kendoGrid").dataSource.read()},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNS.updateContractToActive=function(n){$.ajax({url:"api/contract/"+n+"/updateContractToActive",type:"PUT",contentType:"application/json; charset=utf-8",success:function(){ContractApprovalNS.IsClient=="True"||ContractApprovalNS.IsClient=="true"?(ContractApprovalNS.initEditor(),ContractApprovalNS.populateContractPayment(),$("#approval-contract-payment").modal("show")):($("#lblContractStatus").text("Active"),$("#contractGrid").data("kendoGrid").dataSource.read(),$(".buttonExit").trigger("click"),toastr.success("Contract successfully submitted for review"))},error:function(){toastr.error("Something went wrong with the request")}})};ContractApprovalNS.initEditor=function(){$("#approval-payment-attachment").change(function(){ContractApprovalNS.ReadFile(this)});$("#approval-contract-payment").on("hidden.bs.modal",function(){$("#lblContractStatus").text("Active");$("#contractGrid").data("kendoGrid").dataSource.read();$(".buttonExit").trigger("click");toastr.success("Contract successfully submitted for review")})};ContractApprovalNS.ReadFile=function(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(n){$("#approval-payment-attachment").attr("src",n.target.result);var t=n.target.result;attachementURL=t.replace(" ","+")};t.readAsDataURL(n.files[0]);ContractApprovalNS.AttachmentPaymentName=n.files[0].name}};ContractApprovalNS.populateContractPayment=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/contract/getContractPaymentByContractId/"+ContractApprovalNS.ContractId,dataType:"json"}},batch:!1,pageSize:10,schema:{model:{id:"contractPaymentId",fields:{contractPaymentId:{editable:!1,type:"guid"},purchaseOrderNo:{editable:!1,validation:{required:!0}},datePurchase:{editable:!1,validation:{required:!0}},status:{editable:!1,validation:{required:!0}},dateReceive:{editable:!1,validation:{required:!0}},attachmentURL:{editable:!1,validation:{required:!0}},attachmentName:{editable:!1,validation:{required:!0}},remark:{editable:!1,validation:{required:!0}}}}}});$("#approval-contract-payment-grid").kendoGrid({dataSource:n,pageable:!0,columns:[{field:"contractPaymentId",title:"ContractProductId",hidden:!0},{field:"purchaseOrderNo",title:"Purchase Order No"},{field:"datePurchase",title:"Date Purchase",template:'#if(datePurchase != null) {# #= kendo.toString(kendo.parseDate(datePurchase), "MM/dd/yyyy")# #} else {#<span> <\/span>#}#'},{field:"status",title:"Status",template:"<div style='text-align: left;color:#: status == 'Approved' ? 'green' : status == 'Waiting for Approval' ? 'blue' : 'red'  # '> #=status# <\/div>"},{field:"dateReceive",title:"Date Receive",template:'#if(dateReceive != null) {# #= kendo.toString(kendo.parseDate(dateReceive), "MM/dd/yyyy")# #} else {#<span> <\/span>#}#'},{field:"attachmentName",title:"Attachment",template:'<a href="#=attachmentURL#"> #=attachmentName# <\/a>'},{field:"remark",title:"Remark"},{field:" ",title:"Delete",width:"50px",filterable:!1,template:"#if(status == 'Waiting for Approval') {#<center><span class='fas fa-trash' style='text-align: center; cursor:pointer' onclick=\"ContractApprovalNS.deletePurchaseOrder('#= contractPaymentId #')\" > <\/span><\/center># } else {#<center><span class='fas fa-trash' style='cursor: not-allowed;'> <\/span><\/center>#}#"}],scrollable:!1,sortable:!0,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};ContractApprovalNS.addPurchaseOrder=function(){var n={};n.ContractId=ContractApprovalNS.ContractId;n.PurchaseOrderNo=$("#approval-payment-po").val();n.AttachmentURL=$("#approval-payment-attachment").attr("src");n.AttachmentName=ContractApprovalNS.AttachmentPaymentName;$.ajax({url:"api/contract/contractPayment",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#approval-contract-payment-grid").data("kendoGrid").dataSource.read(),$("#approval-payment-po").val(null),$("#approval-payment-attachment").val(""),ContractApprovalNS.AttachmentPaymentName="",toastr.success("Purchase Order successfully added")):toastr.error("Purchase Order already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNS.deletePurchaseOrder=function(n){confirm("Are you sure you want to delete this item?")&&$.ajax({url:"api/contract/contractPayment/"+n,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?$("#approval-contract-payment-grid").data("kendoGrid").dataSource.read():toastr.error("Error deleting product!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractApprovalNS.clearRemarkFields=function(){$("#approverRemarks").val(null);$("#assingerRemarks").val(null)};ContractEditorManagementNS={};ContractEditorManagementNS.EditorValue="";ContractEditorManagementNS.ContractTagType=[{name:"text",value:"text"},{name:"date",value:"date"},{name:"number",value:"number"}];ContractEditorManagementNS.SectionId=null;ContractEditorManagementNS.ContractSectionTemplateArr="";ContractEditorManagementNS.EditorValueEdited=[];ContractEditorManagementNS.ContractTemplateId="";ContractEditorManagementNS.RemoveContractTemplate=[];ContractEditorManagementNS.ControlValue=null;ContractEditorManagementNS.TemplateName="";ContractEditorManagementNS.SelectedTag="";ContractEditorManagementNS.init=function(){var i,r,t,n;$("h3#page-title").text("Contract Management");i=$("#form-tag-create").kendoValidator().data("kendoValidator");ContractEditorManagementNS.initTagEditor();$(".editorDiv").kendoEditor({tools:["print","bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","tableWizard","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn","viewHtml","formatting","cleanFormatting","fontName","fontSize","foreColor","backColor",{name:"addTag",tooltip:"Add Tag",exec:function(){var t=$(".editorDiv").data("kendoEditor"),n=t.getRange().toString().trim(),i=n.split(/\s+|\./).length;ContractEditorManagementNS.SelectedTag=n;i>1||n==""?toastr.error("Please highlight one word only!"):($("#tag-name span").text(n),$("#tag-create-popup").modal("show"))}},{name:"deleteTag",tooltip:"Delete Tag",exec:function(){var t=$(".editorDiv").data("kendoEditor"),n=t.getRange().toString().trim(),i=n.split(/\s+|\./).length;i>1||n==""?toastr.error("Please highlight one word only!"):$.ajax({url:"api/contract/contractTag/"+n,type:"GET",contentType:"application/json; charset=utf-8",success:function(n){n!=null&&ContractEditorManagementNS.RemoveBackgroundColorForSection(n.color,n.name,n.contractTagId)},error:function(){toastr.error("Something went wrong with the request!")}})}}]});$("form#form-tag-create").submit(function(n){if(n.preventDefault(),i.validate()){var t={};t.ContractTagId=null;t.Name=ContractEditorManagementNS.SelectedTag;t.Type=$("#tag-type").val();t.Color=$("#tag-color").val();ContractEditorManagementNS.addTag(t)}});$("#updateTextAreaEditor").kendoEditor({tools:["print","bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","insertImage","insertFile","tableWizard","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn","viewHtml","formatting","cleanFormatting","fontName","fontSize","foreColor","backColor"]});$("#sortableListLeft").kendoSortable({connectWith:"#sortableListRight",placeholder:ContractEditorManagementNS.placeholder,end:ContractEditorManagementNS.onEndRemove});$("#sortableListRight").kendoSortable({connectWith:"#sortableListLeft",placeholder:ContractEditorManagementNS.placeholder,end:ContractEditorManagementNS.onEnd});$("#textAreaEditor").kendoEditor({resizable:{content:!0,toolbar:!0}});$("#section-add-ordernum").kendoNumericTextBox({format:"#",decimals:0});$("#btnAddSection").click(function(){ContractEditorManagementNS.clearSectionPopUp();$("#section-create-popup").modal("show")});$("#btnSaveSection").click(function(n){n.preventDefault();ContractEditorManagementNS.saveSection()});$("#btnUpdateDeleteSection").click(function(n){var t,i;n.preventDefault();$("#section-update-name").data("kendoDropDownList").select(0);t=ContractEditorManagementNS.EditorValue.find(n=>n.sectionTemplateId===$("#section-update-name").val());t!=undefined&&(i=$("#updateTextAreaEditor").data("kendoEditor"),i.value(t.value));$("#section-update-popup").modal("show")});$("#btnUpdateSection").click(function(n){n.preventDefault();ContractEditorManagementNS.UpdateSection()});$("#btnDeleteSection").click(function(n){var t,i,r;n.preventDefault();t=!1;$("#sortableListRight li").each(function(n){if($(this).attr("id")!=="placeholder"&&n<$("#sortableListRight li").length&&$(this)[0].dataset.id===ContractEditorManagementNS.SectionId.sectionTemplateId)return t=!0,!1});t?(i=confirm("Section been selected. Unmapped the section if you want to delete this section."),i===!0&&$("#section-update-popup").modal("toggle")):(r=confirm("Are you sure you want to delete this section?"),r===!0&&ContractEditorManagementNS.DeleteSection(),$("#section-update-popup").modal("toggle"))});$("#btnSave").click(function(n){n.preventDefault();ContractEditorManagementNS.SaveContractTemplate()});$(".editorDiv").mouseleave(function(n){var i,t,u,f,e,r;for(n.preventDefault(),i=$(".editorDiv"),t=1;t<i.length;t++)u=ContractEditorManagementNS.EditorValueEdited.find(n=>n.sectionId===i[t].dataset.id),u!==undefined?(f=jQuery.inArray(u,ContractEditorManagementNS.EditorValueEdited),ContractEditorManagementNS.EditorValueEdited[f].content=u.content):(e=ContractEditorManagementNS.EditorValue.find(n=>n.sectionTemplateId===i[t].dataset.id&&n.value!==i[t].innerHTML),e!=undefined&&(r={},r.id=i[t].id,r.sectionId=i[t].dataset.id,r.content=i[t].innerHTML,ContractEditorManagementNS.EditorValueEdited.push(r)))});$("#contract-template-tab").click(function(){$("#contract-template-grid").data("kendoGrid").clearSelection()});$("#btn-search-text").click(function(){var u=$("#searchEditorText").val(),i=$("#editorWrapper"),f;if(u!=""){if(r!=u){i.find("span.match").contents().unwrap();var e=i.html(),o=new RegExp("("+u+")","igm"),s=e.replace(o,"<span class='match'>$1<\/span>");i.html(s);r=u;t=i.find("span.match").length;n=0}else n<t-1?n++:n=0;$("#search-result").text(n+1+"/"+t);f=$("#editorWrapper span.match").eq(n);$("span.active").removeClass("active");f.addClass("active");$("html,body").animate({scrollTop:f.offset().top-50},200)}else i.find("span.match").contents().unwrap(),$("#search-result").text("")})};ContractEditorManagementNS.clearSectionPopUp=function(){$("#section-add-name").val("");var n=$("#textAreaEditor").data("kendoEditor");n.value(" ")};ContractEditorManagementNS.saveSection=function(){var i=$("#form-section-create").kendoValidator().data("kendoValidator"),t,n;i.validate()&&(t=$("#textAreaEditor").data("kendoEditor"),n={},n.SectionTemplateId="00000000-0000-0000-0000-000000000000",n.Name=$("#section-add-name").val(),n.Value=t.value(),n.OrderNo=$("#section-add-ordernum").val(),$.ajax({url:"api/Contract/createSection",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!==!1&&n!=="false"&&(ContractEditorManagementNS.clearSectionPopUp(),ContractEditorManagementNS.EditorValue.push(n),ContractEditorManagementNS.UpdateSectionRight(n,-1),$("#section-update-name").data("kendoDropDownList").setDataSource(ContractEditorManagementNS.EditorValue),$("#section-create-popup").modal("toggle"))},error:function(){toastr.error("Something went wrong with the saving section request!")}}))};ContractEditorManagementNS.UpdateSection=function(){var t=$("#updateTextAreaEditor").data("kendoEditor"),n={};n.SectionTemplateId=ContractEditorManagementNS.SectionId.sectionTemplateId;n.Name=ContractEditorManagementNS.SectionId.name;n.Value=t.value();n.OrderNo=parseInt(ContractEditorManagementNS.SectionId.orderNo);$.ajax({url:"api/Contract/updateSection",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){if(n!==!1&&n!=="false"){var t=getIndexByProperty(ContractEditorManagementNS.EditorValue,"sectionTemplateId",n.sectionTemplateId);t>-1&&(ContractEditorManagementNS.EditorValue[t].value=n.value);ContractEditorManagementNS.LoadEditor();$("#section-update-popup").modal("toggle")}},error:function(){toastr.error("Something went wrong with the saving section request!")}})};ContractEditorManagementNS.DeleteSection=function(){$.ajax({url:"api/contract/deleteSection/"+ContractEditorManagementNS.SectionId.sectionTemplateId,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){var t,i;if(n!==!1&&n!=="false"){for(t=0;t<ContractEditorManagementNS.EditorValue.length;t++)if(ContractEditorManagementNS.EditorValue[t].sectionTemplateId===ContractEditorManagementNS.SectionId.sectionTemplateId){i=ContractEditorManagementNS.EditorValue[t];ContractEditorManagementNS.EditorValue.splice(t,1);break}ContractEditorManagementNS.UpdateSectionLeft()}},error:function(){toastr.error("Something went wrong with the saving section request!")}})};ContractEditorManagementNS.SaveContractTemplate=function(){var t=$(".editorDiv").data("kendoEditor"),n="";n=ContractEditorManagementNS.ControlValue==="existing"?ContractTemplateManagementNS.ContractTemplateId:$("#ContractTemplate").val();n===""?toastr.error("Please set template name"):ContractEditorManagementNS.ContractTemplateId==""&&ContractEditorManagementNS.ControlValue==="new"?$.ajax({url:"api/Contract/createContractTemplate/"+$("#ContractTemplate").val(),type:"POST",contentType:"application/json; charset=utf-8",success:function(n){n!==!1&&n!=="false"&&(ContractEditorManagementNS.ContractTemplateId=n,ContractEditorManagementNS.GetAllSelectedSectionRight(),$("#contract-template-grid").data("kendoGrid").dataSource.read())},error:function(){toastr.error("Something went wrong with the saving contract section template request!")}}):ContractEditorManagementNS.GetAllSelectedSectionRight()};ContractEditorManagementNS.placeholder=function(){return $("<li class='list-item' id='placeholder'>Drop Here!<\/li>")};ContractEditorManagementNS.onEnd=function(n){var u=$(".editorDiv").data("kendoEditor"),i="",t=n.item[0].id,f=n.action,r="";$("#sortableListRight li").each(function(){if(r="",$(this).attr("id")==="placeholder")i+="<div class='editorDiv' id="+t+" data-id="+ContractEditorManagementNS.EditorValue[t].sectionTemplateId+">",r=ContractEditorManagementNS.CheckIfSectionIsEdited(ContractEditorManagementNS.EditorValue[t].sectionTemplateId),i+=r!==""?r:ContractEditorManagementNS.EditorValue[t].content!==undefined?ContractEditorManagementNS.EditorValue[t].content:ContractEditorManagementNS.EditorValue[t].value,i+="<\/div>";else if(t!==$(this).attr("id")){var n=parseInt($(this).attr("id"));i+="<div class='editorDiv' id="+n+" data-id="+ContractEditorManagementNS.EditorValue[n].sectionTemplateId+">";r=ContractEditorManagementNS.CheckIfSectionIsEdited(ContractEditorManagementNS.EditorValue[n].sectionTemplateId);i+=r!==""?r:ContractEditorManagementNS.EditorValue[t].content!==undefined?ContractEditorManagementNS.EditorValue[t].content:ContractEditorManagementNS.EditorValue[t].value;i+="<\/div>"}u.value(i)})};ContractEditorManagementNS.onEndRemove=function(n){var i=$(".editorDiv").data("kendoEditor"),t="",r=n.action,u=n.item[0].dataset.id;$("#sortableListRight li").each(function(n){var f,s,e,o;$("#sortableListRight li").length===0&&(t="",i.value(""));r!=="receive"?($(this).attr("id")!=="placeholder"&&n<parseInt($("#sortableListRight li").length)&&(f=parseInt($(this).attr("id")),t+="<div class='editorDiv' id="+f+" data-id="+ContractEditorManagementNS.EditorValue[f].sectionTemplateId+">",editedSection=ContractEditorManagementNS.CheckIfSectionIsEdited(ContractEditorManagementNS.EditorValue[f].sectionTemplateId),t+=editedSection!==""?editedSection:ContractEditorManagementNS.EditorValue[f].content!==undefined?ContractEditorManagementNS.EditorValue[f].content:ContractEditorManagementNS.EditorValue[f].value,t+="<\/div>"),i.value(t)):$(this).attr("id")!=="placeholder"&&n<parseInt($("#sortableListRight li").length)&&(f=parseInt($(this).attr("id")),u===ContractEditorManagementNS.EditorValue[f].sectionTemplateId&&(s=ContractEditorManagementNS.RemoveSectionIsEdited(ContractEditorManagementNS.EditorValue[f].sectionTemplateId),s==!1&&ContractEditorManagementNS.ContractSectionTemplateArr!=""&&(e="",e=ContractEditorManagementNS.ControlValue=="existing"?ContractTemplateManagementNS.ContractTemplateId:ContractEditorManagementNS.ContractTemplateId,o=ContractEditorManagementNS.ContractSectionTemplateArr.find(n=>n.contractTemplateId===e&&n.sectionTemplateId===ContractEditorManagementNS.EditorValue[f].sectionTemplateId),o!=undefined&&ContractEditorManagementNS.RemoveContractTemplate.push(o.contractSectionTemplateId))))})};ContractEditorManagementNS.CheckIfSectionIsEdited=function(n){var i="",r=ContractEditorManagementNS.EditorValueEdited.find(t=>t.sectionId===n),t;return r!==undefined&&(t=jQuery.inArray(r,ContractEditorManagementNS.EditorValueEdited),i=ContractEditorManagementNS.EditorValue[t].content!==undefined?ContractEditorManagementNS.EditorValue[t].content:ContractEditorManagementNS.EditorValue[t].value),i};ContractEditorManagementNS.RemoveSectionIsEdited=function(n){var t=!1,i=ContractEditorManagementNS.EditorValueEdited.find(t=>t.sectionId===n),r;return i!==undefined&&(r=jQuery.inArray(i,ContractEditorManagementNS.EditorValueEdited),ContractEditorManagementNS.EditorValueEdited.splice(r,1),t=!0),t};ContractEditorManagementNS.GetAllSectionTemplate=function(n){var t="";t=n===""?"api/contract/getAllSectionTemplate":"api/contract/getAllSectionTemplateByTemplate/"+n;$.ajax({url:t,type:"GET",contentType:"application/json; charset=utf-8",success:function(n){n!==!1&&n!=="false"&&(ContractEditorManagementNS.EditorValue=n,ContractEditorManagementNS.UpdateSectionLeft(),$("#section-update-name").kendoDropDownList({dataTextField:"name",dataValueField:"sectionTemplateId",dataSource:ContractEditorManagementNS.EditorValue,index:0,change:ContractEditorManagementNS.onChangeSectionTemplate}),ContractEditorManagementNS.onChangeSectionTemplate())},error:function(){toastr.error("Something went wrong with the request for get all sections!")}})};ContractEditorManagementNS.onChangeSectionTemplate=function(){var t=$("#section-update-name").val(),n=$("#updateTextAreaEditor").data("kendoEditor");ContractEditorManagementNS.SectionId=ContractEditorManagementNS.EditorValue.find(n=>n.sectionTemplateId===t);n!==undefined&&n.value(ContractEditorManagementNS.SectionId.content)};ContractEditorManagementNS.UpdateSectionLeft=function(){var t=$("#sortableListLeft").empty(),n="";for(i=0;i<ContractEditorManagementNS.EditorValue.length;i++)ContractEditorManagementNS.EditorValue[i].contractSectionTemplateId===undefined||ContractEditorManagementNS.EditorValue[i].selected===0?n+="<li class='list-item' ondblclick='ContractEditorManagementNS.loadContent(this)' id="+i+" data-id="+ContractEditorManagementNS.EditorValue[i].sectionTemplateId+">"+ContractEditorManagementNS.EditorValue[i].name+"<\/li>":ContractEditorManagementNS.UpdateSectionRight(ContractEditorManagementNS.EditorValue[i],i);t.append(n)};ContractEditorManagementNS.UpdateSectionRight=function(n,t){var i=$("#sortableListRight"),r=t==-1?ContractEditorManagementNS.EditorValue.length-1:t,u="<li class='list-item' ondblclick='ContractEditorManagementNS.loadContent(this)' id="+r+" data-id="+n.sectionTemplateId+">"+n.name+"<\/li>";i.append(u);ContractEditorManagementNS.LoadEditor()};ContractEditorManagementNS.GetAllSelectedSectionRight=function(){var n=[],t,i;if($("#sortableListRight li").each(function(t){var i,t,r;if($(this).attr("id")!=="placeholder"&&t<$("#sortableListRight li").length)for(i=$(".editorDiv"),t=1;t<i.length;t++)$(this).attr("data-id")==i[t].dataset.id&&(r=ContractEditorManagementNS.SectionSelectedContent($(this).attr("data-id"),i[t].innerHTML),n.push(r))}),ContractEditorManagementNS.RemoveContractTemplate.length>0)for(t=0;t<ContractEditorManagementNS.RemoveContractTemplate.length;t++)i={},i.RemoveContractSectionTemplateId=ContractEditorManagementNS.RemoveContractTemplate[t],n.push(i);if(n.length>0){var f=n.find(n=>n.ContractSectionTemplateId!="00000000-0000-0000-0000-000000000000"),r="api/Contract/createContractSectionTemplate",u="POST";f!=undefined&&(r="api/Contract/updateContractSectionTemplate",u="PUT");$.ajax({url:r,type:u,data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!==!1&&n!=="false"&&(ContractEditorManagementNS.ContractSectionTemplateArr=n,toastr.success("Contract Template successfully updated!"))},error:function(){toastr.error("Something went wrong with the saving contract section template request!")}})}};ContractEditorManagementNS.SectionSelectedContent=function(n,t){var i={},r,u;return i.ContractTemplateId=ContractEditorManagementNS.ControlValue=="existing"?ContractTemplateManagementNS.ContractTemplateId:ContractEditorManagementNS.ContractTemplateId,ContractEditorManagementNS.ContractSectionTemplateArr!=""?(r=ContractEditorManagementNS.ContractSectionTemplateArr.find(t=>t.contractTemplateId===i.ContractTemplateId&&t.sectionTemplateId===n),i.ContractSectionTemplateId=r!==undefined?r.contractSectionTemplateId:"00000000-0000-0000-0000-000000000000"):(u=ContractEditorManagementNS.EditorValue.find(t=>t.sectionTemplateId===n&&t.contractSectionTemplateId!==undefined),i.ContractSectionTemplateId=u!==undefined?u.contractSectionTemplateId:"00000000-0000-0000-0000-000000000000"),i.SectionTemplateId=n,i.Content=t,i};ContractEditorManagementNS.LoadEditor=function(){var t=$(".editorDiv").data("kendoEditor"),n="";$("#sortableListRight li").each(function(i){if($(this).attr("id")!=="placeholder"){var r=parseInt($(this).attr("id"));i<$("#sortableListRight li").length&&(n+="<div class='editorDiv' id="+r+" data-id="+ContractEditorManagementNS.EditorValue[r].sectionTemplateId+" data-contractsectiontemplateid="+ContractEditorManagementNS.EditorValue[r].contractSectionTemplateId+">",editedSection=ContractEditorManagementNS.CheckIfSectionIsEdited(ContractEditorManagementNS.EditorValue[r].sectionTemplateId),n+=editedSection!==""?editedSection:ContractEditorManagementNS.EditorValue[r].content!==undefined?ContractEditorManagementNS.EditorValue[r].content:ContractEditorManagementNS.EditorValue[r].value,n+="<\/div>")}t.value(n)})};ContractEditorManagementNS.loadContent=function(n){var t=n.id,i=n.textContent};ContractEditorManagementNS.tabShow=function(){var n=$(".editorDiv").data("kendoEditor");n.value("");ContractEditorManagementNS.ControlValue==="existing"?($("#templateForm .k-dropdown").css("display","block"),$("#ContractTemplate").css("display","none"),$("#sortableListRight").empty(),$("#templateForm span").html("<strong>"+ContractEditorManagementNS.TemplateName+"<\/strong>")):ContractEditorManagementNS.ControlValue==="new"&&($("#templateForm .k-dropdown").css("display","none"),$("#ContractTemplate").css("display","block"),$("#ContractTemplate").val(""),$("#sortableListRight").empty(),$("#templateForm span").html(""));ContractEditorManagementNS.GetAllSectionTemplate(ContractTemplateManagementNS.ContractTemplateId)};ContractEditorManagementNS.initTagEditor=function(){$("#tag-type").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:{transport:{read:{dataType:"json",url:"api/contract/getAllContractTemplateTagType"}}},suggest:!0});$("#tag-color").kendoColorPicker({buttons:!1})};ContractEditorManagementNS.addTag=function(n){$.ajax({url:"api/contract/createTag",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?ContractEditorManagementNS.AddBackgroundColorForSection($("#tag-color").val(),ContractEditorManagementNS.SelectedTag,n.contractTagId):toastr.error("Tag already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractEditorManagementNS.AddBackgroundColorForSection=function(n,t,i){for(var f,u,r=0;r<ContractEditorManagementNS.EditorValue.length;r++)f="ContractEditorManagementNS."+t+"'",u="<span style='color:white;padding:1px 5px;background-color:"+n+";'>"+t+"<\/span>",ContractEditorManagementNS.EditorValue[r].content=ContractEditorManagementNS.EditorValue[r].content.replace(new RegExp(t,"g"),u),ContractEditorManagementNS.EditorValue[r].content.indexOf(t)>=0&&(ContractEditorManagementNS.EditorValue[r].tags=i,ContractEditorManagementNS.updateContractSectionTag(ContractEditorManagementNS.EditorValue[r],i))};ContractEditorManagementNS.RemoveBackgroundColorForSection=function(n,t,i){for(var u,r=0;r<ContractEditorManagementNS.EditorValue.length;r++)u="<span style='color:white;padding:1px 5px;background-color:"+n+";'>"+t+"<\/span>",ContractEditorManagementNS.EditorValue[r].content=ContractEditorManagementNS.EditorValue[r].content.replace(new RegExp(u,"g"),t),ContractEditorManagementNS.EditorValue[r].content.indexOf(t)>=0&&(ContractEditorManagementNS.EditorValue[r].tags=i,ContractEditorManagementNS.removeContractSectionTag(ContractEditorManagementNS.EditorValue[r],i))};ContractEditorManagementNS.updateContractSectionTag=function(n,t){var i={};i.ContractSectionId=n.contractSectionTemplateId;i.Tags=t;i.Content=n.content;$.ajax({url:"api/contract/updateTagContractSectionTemplate/",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(){ContractEditorManagementNS.LoadEditor();toastr.success("Tag successfully added");ContractEditorManagementNS.SelectedTag="";$("#tag-name span").text("");$("#tag-type").data("kendoComboBox").value("");$("#tag-create-popup").modal("toggle")}})};ContractEditorManagementNS.removeContractSectionTag=function(n,t){var i={};i.ContractSectionId=n.contractSectionTemplateId;i.Tags=t;i.Content=n.content;$.ajax({url:"api/contract/deleteTagContractSectionTemplate/",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(){ContractEditorManagementNS.LoadEditor();toastr.success("Tag successfully removed")}})};ContractEditorNS={};ContractEditorNS.EditorValue="";ContractEditorNS.TagsData=[];ContractEditorNS.Name="";ContractEditorNS.TemplateContractValue="";ContractEditorNS.ContractId="";ContractEditorNS.SelSectionCount=0;ContractEditorNS.NewContractType="";ContractEditorNS.editor="";ContractEditorNS.newEditor="";ContractEditorNS.SelectedTag="";ContractEditorNS.AvailableTags=[];ContractEditorNS.IsTagValue=!1;ContractEditorNS.PreviousTagValue="";ContractEditorNS.Permission="";ContractEditorNS.PrevVersion=1;ContractEditorNS.init=function(n){ContractEditorNS.ContractId=n!==null?n:ContractWizardNS.ContractId;ContractEditorNS.initializeKendoEditorAndDnD();ContractEditorNS.initTagEditor()};ContractEditorNS.initializeKendoEditorAndDnD=function(){var i,r,t,n;ContractEditorNS.IsReadOnly();i=$("#form-contract-tag-create").kendoValidator().data("kendoValidator");$(".editor").kendoEditor({tools:["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","tableWizard","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn","viewHtml","formatting","cleanFormatting","fontName","fontSize","foreColor",{name:"addTag",tooltip:"Add Tag",exec:function(){var t=$(".editor").data("kendoEditor"),n=t.getRange().toString().trim(),i=n.split(/\s+|\./).length;ContractEditorNS.SelectedTag=n;$("#contract-tag-create-popup").modal("hide");i>1||n==""?toastr.error("Please highlight one word only!"):tagExist(n)?toastr.error("Tag already Exist!"):($("#contract-tag-name span").text(n),$("#contract-tag-create-popup").modal("show"))}},{name:"deleteTag",tooltip:"Delete Tag",exec:function(){var t=$(".editor").data("kendoEditor"),n=t.getRange().toString().trim(),i=n.split(/\s+|\./).length;i>1||n==""?toastr.error("Please highlight one word only!"):$.ajax({url:"api/contract/contractTag/"+n,type:"GET",contentType:"application/json; charset=utf-8",success:function(n){n!=null&&ContractEditorNS.RemoveBackgroundColorForSection(n.color,n.name,n.contractTagId)},error:function(){toastr.error("Something went wrong with the request!")}})}}]});$("#textAreaEditor").kendoEditor({tools:["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink","insertImage","insertFile","tableWizard","createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn","viewHtml","formatting","cleanFormatting","fontName","fontSize","foreColor"]});ContractEditorNS.editor=$(".editor").data("kendoEditor");ContractEditorNS.newEditor=$("#textAreaEditor").data("kendoEditor");$("form#form-contract-tag-create").submit(function(n){if(n.preventDefault(),i.validate()){var t={};t.ContractTagId=null;t.Name=ContractEditorNS.SelectedTag;t.Type=$("#contract-tag-type").val();t.Type=="Text"?t.Value=$("#contract-tag-value-text").val():t.Type=="Date"?t.Value=$("#contract-tag-value-datetime").val():t.Type=="Int"?t.Value=$("#contract-tag-value-int").val():t.Type=="Decimal"&&(t.Value=$("#contract-tag-value-decimal").val());t.Color=$("#contract-tag-color").val();ContractEditorNS.addTag(t)}});$("#sortableListLeft").kendoSortable({connectWith:"#sortableListRight",placeholder:ContractEditorNS.placeholder,end:ContractEditorNS.onEndRemove});$("#sortableListRight").kendoSortable({connectWith:"#sortableListLeft",placeholder:ContractEditorNS.placeholder,end:ContractEditorNS.onEnd});$("#sortableListRight li").on("dblclick",".item",function(){});$("#btnCompareTemplate").click(function(n){n.preventDefault();var t=window.location.origin+"/Contract/ContractVersion?contractId="+ContractEditorNS.ContractId+"&contractTemplateId="+ContractEditorNS.TemplateContractValue;window.open(t)});ContractEditorNS.GetContractType();$(".editor").mouseleave(function(n){var r,u,t,f,i;for(n.preventDefault(),console.log("save content"),r=$(".editor"),u=!0,t=1;t<r.length;t++)f=ContractEditorNS.EditorValue.find(n=>n.sectionTemplateId===r[t].dataset.id),f!==undefined&&(i=jQuery.inArray(f,ContractEditorNS.EditorValue),ContractEditorNS.EditorValue[i].content!==r[t].innerHTML&&ContractEditorNS.IsTagValue===!1&&ContractEditorNS.EditorValue[i].sectionTemplateId!=="a0428daa-f20e-4a57-98f5-b02d96fdefdf"&&(ContractEditorNS.Permission.updateContractVersion==!0&&(ContractEditorNS.Permission.status===2||ContractEditorNS.Permission.status===7)?u&&ContractEditorNS.PrevVersion==ContractEditorNS.EditorValue[i].version&&(ContractEditorNS.EditorValue[i].content=r[t].innerHTML,ContractEditorNS.updateContractSectionToDraft(),u=!1,ContractEditorNS.Permission.updateContractVersion=!1):(ContractEditorNS.EditorValue[i].content=r[t].innerHTML,ContractEditorNS.UpdateContractSection(ContractEditorNS.EditorValue[i]))))});$("#btnAddSection").click(function(n){n.preventDefault();ContractEditorNS.clearSectionPopUp();$("#instance-section-create-popup").modal("show")});$("#btnSaveSection").click(function(n){n.preventDefault();$("#instance-section-create-popup").modal("hide");ContractEditorNS.saveSection()});$("#change-contract-type").click(function(n){n.preventDefault();$("#contract-change-type-popup").modal("hide");ContractEditorNS.DeleteContractTypeByContract()});$("#contract-type-dismiss").click(function(n){n.preventDefault();$("#drpContractTemplate").data("kendoDropDownList").select(0)});$("#contract-change-close").click(function(n){n.preventDefault();$("#drpContractTemplate").data("kendoDropDownList").select(0)});$("#btnAddTags").click(function(n){n.preventDefault();$("#instance-tags-create-popup").modal("show")});$("#btnPreviewInstanceTemplate").click(function(n){n.preventDefault();var t=window.location.origin+"/Contract/ContractPreview?contractId="+ContractEditorNS.ContractId+"&contractTemplateId="+ContractEditorNS.TemplateContractValue;window.open(t)});$("#btn-search-text").click(function(){var u=$("#searchEditorText").val(),i=$("#editorWrapper"),f;if(u!=""){if(r!=u){i.find("span.match").contents().unwrap();var e=i.html(),o=new RegExp("("+u+")","igm"),s=e.replace(o,"<span class='match'>$1<\/span>");i.html(s);r=u;t=i.find("span.match").length;n=0}else n<t-1?n++:n=0;$("#search-result").text(n+1+"/"+t);f=$("#editorWrapper span.match").eq(n);$("span.active").removeClass("active");f.addClass("active");$("html,body").animate({scrollTop:f.offset().top-50},200)}else i.find("span.match").contents().unwrap(),$("#search-result").text("")});$("#btnToggleTagsValue").click(function(n){n.preventDefault();ContractEditorNS.ToggleEditorContent("")})};ContractEditorNS.ToggleEditorContent=function(n){for(var f,t,r=$(".editor"),u="",i=1;i<r.length;i++)f=ContractEditorNS.EditorValue.find(n=>n.sectionTemplateId===r[i].dataset.id),f!==undefined&&(t=jQuery.inArray(f,ContractEditorNS.EditorValue),u+="<div class='editor' id="+t+" data-id="+ContractEditorNS.EditorValue[t].sectionTemplateId+" data-contractsectionid="+ContractEditorNS.EditorValue[t].contractSectionId+">",u+=n==="tagUpdate"?ContractEditorNS.ReplaceTagContentValue(ContractEditorNS.EditorValue[t].tags,r[i].innerHTML,n):ContractEditorNS.IsTagValue?ContractEditorNS.ReplaceContentName(ContractEditorNS.EditorValue[t].tags,r[i].innerHTML):ContractEditorNS.ReplaceTagContentValue(ContractEditorNS.EditorValue[t].tags,r[i].innerHTML,n),u+="<\/div>");n!=="tagUpdate"&&(ContractEditorNS.IsTagValue=ContractEditorNS.IsTagValue==!1?!0:!1);ContractEditorNS.editor.value(u)};ContractEditorNS.ReplaceTagContentValue=function(n,t,i){var u,f,r,e;if(n)if(u=n.split(","),u.length>0)for(f=0;f<u.length;f++)r=ContractEditorNS.TagsData.find(n=>n.contractTagId===u[f]),r!==undefined&&(e=i==="tagUpdate"?ContractEditorNS.PreviousTagValue:r.name,t=t.replace(new RegExp(e,"g"),r.value));else r=ContractEditorNS.TagsData.find(n=>n.contractTagId===u[0]),r!==undefined&&(e=i==="tagUpdate"?ContractEditorNS.PreviousTagValue:r.name,t=t.replace(new RegExp(e,"g"),r.value));return t};ContractEditorNS.ReplaceContentName=function(n,t){var r,u,i;if(n)if(r=n.split(","),r.length>0)for(u=0;u<r.length;u++)i=ContractEditorNS.TagsData.find(n=>n.contractTagId===r[u]),i!==undefined&&(t=t.replace(new RegExp(i.value,"g"),i.name));else i=ContractEditorNS.TagsData.find(n=>n.contractTagId===r[0]),i!==undefined&&(t=t.replace(new RegExp(i.value,"g"),i.name));return t};ContractEditorNS.clearSectionPopUp=function(){$("#section-add-name").val("");ContractEditorNS.newEditor.value(" ")};ContractEditorNS.IsReadOnly=function(){$.ajax({url:"api/Contract/getContractData/"+ContractEditorNS.ContractId,type:"POST",contentType:"application/json; charset=utf-8",async:!1,success:function(n){$("#lockIcon").css("pointer-events","none");n!==!1&&n!=="false"&&(n?(ContractEditorNS.Permission=n,n.canWrite==!1?($("#divContractType").css("pointer-events","none"),$("#divSearch").css("pointer-events","none"),$("#divEditorWrapper").css("pointer-events","none"),$("#lockIcon").show()):($("#divContractType").css("pointer-events",""),$("#divSearch").css("pointer-events",""),$("#divEditorWrapper").css("pointer-events",""),$("#lockIcon").hide())):($("#divContractType").css("pointer-events","none"),$("#divSearch").css("pointer-events","none"),$("#divEditorWrapper").css("pointer-events","none"),$("#lockIcon").show()))},error:function(){toastr.error("Something went wrong with getting contract info!")}})};ContractEditorNS.updateContractSectionToDraft=function(){var n={};n.ContractId=ContractEditorNS.ContractId;n.Version=ContractEditorNS.EditorValue[0].version;n.Version+=1;console.log(n);$.ajax({url:"api/Contract/updateContractVersion",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",async:!1,success:function(n){if(n!==!1&&n!=="false"){for(var t=0;t<ContractEditorNS.EditorValue.length;t++)(ContractEditorNS.EditorValue[t].contractSectionId!==null||ContractEditorNS.EditorValue[t].contractSectionId==="00000000-0000-0000-0000-000000000000")&&(ContractEditorNS.EditorValue[t].version+=1,ContractEditorNS.EditorValue[t].status=1,ContractEditorNS.EditorValue[t].remarks="",ContractEditorNS.EditorValue[t].nonOwnerRemarks="",ContractEditorNS.EditorValue[t].onOwnerStatus=1,ContractEditorNS.EditorValue[t].nonOwnerApprover="00000000-0000-0000-0000-000000000000",ContractEditorNS.UpdateContractSection(ContractEditorNS.EditorValue[t]));$("#lblVersion").text("Version "+ContractEditorNS.EditorValue[0].version);ContractEditorNS.EditorValue[0].version===1&&$("#lblContractStatus").text("Draft")}},error:function(){toastr.error("Something went wrong with the saving contract section request!")}})};ContractEditorNS.saveSection=function(){var t=$("#form-section-create").kendoValidator().data("kendoValidator"),n;t.validate()&&(n={},n.SectionTemplateId="00000000-0000-0000-0000-000000000000",n.Name=$("#section-add-name").val(),n.Value=ContractEditorNS.newEditor.value(),n.OrderNo=$("#section-add-ordernum").val(),$.ajax({url:"api/Contract/createSection",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",async:!1,success:function(n){n!==!1&&n!=="false"&&(ContractEditorNS.CreateContractSection(n,1),toastr.success("Contract section successfully added"))},error:function(){toastr.error("Something went wrong with the saving contract section request!")}}))};ContractEditorNS.CreateContractSection=function(n,t){var r=jQuery.inArray(n,ContractEditorNS.EditorValue),i;ContractEditorNS.TemplateContractValue=$("#drpContractTemplate").val();i={};i.ContractTemplateId=ContractEditorNS.TemplateContractValue;i.ContractId=ContractEditorNS.ContractId;i.SectionTemplateId=n.sectionTemplateId;i.Content=n.value!==undefined?n.value:n.content;i.Tags="";i.OrderNo=n.orderNo;i.Status=1;i.Name=n.name;i.Version=1;i.Title=$("#drpContractTemplate").data("kendoDropDownList").text();$.ajax({url:"api/Contract/createContractSection",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(n){n!==!1&&n!=="false"&&(ContractEditorNS.clearSectionPopUp(),r>-1?(ContractEditorNS.EditorValue[r].contractSectionId=n.contractSectionId,ContractEditorNS.EditorValue[r].contractId=n.contractId,ContractEditorNS.EditorValue[r].contractTemplateId=n.contractTemplateId,ContractEditorNS.EditorValue[r].selected=1,ContractEditorNS.EditorValue[r].version=n.version,ContractEditorNS.EditorValue[r].status=n.status):(n.selected=1,ContractEditorNS.EditorValue.push(n)),t===1&&ContractEditorNS.loadRightSection(),ContractEditorNS.Permission.updateContractVersion==!0&&(ContractEditorNS.Permission.status===2||ContractEditorNS.Permission.status===7)&&ContractEditorNS.PrevVersion==ContractEditorNS.EditorValue[r].version&&(ContractEditorNS.updateContractSectionToDraft(),ContractEditorNS.Permission.updateContractVersion=!1))},error:function(){toastr.error("Something went wrong with the saving contract section request!")}})};ContractEditorNS.DeleteContractSection=function(n){$.ajax({url:"api/Contract/deleteContractSection/"+n.contractSectionId,type:"DELETE",contentType:"application/json; charset=utf-8",async:!1,success:function(t){if(t!==!1&&t!=="false"){var i=jQuery.inArray(n,ContractEditorNS.EditorValue);ContractEditorNS.EditorValue[i].contractSectionId=null;ContractEditorNS.EditorValue[i].contractId=null;ContractEditorNS.EditorValue[i].contractTemplateId=null;ContractEditorNS.EditorValue[i].selected=0;ContractEditorNS.Permission.updateContractVersion==!0&&(ContractEditorNS.Permission.status===2||ContractEditorNS.Permission.status===7)&&ContractEditorNS.PrevVersion==ContractEditorNS.EditorValue[i].version&&(ContractEditorNS.updateContractSectionToDraft(),ContractEditorNS.Permission.updateContractVersion=!1);toastr.success("Contract section successfully remove")}},error:function(){toastr.error("Something went wrong with the saving contract section request!")}})};ContractEditorNS.DeleteContractTypeByContract=function(){$.ajax({url:"api/Contract/deleteContractType/"+ContractEditorNS.ContractId,type:"DELETE",contentType:"application/json; charset=utf-8",async:!1,success:function(n){n!==!1&&n!=="false"&&ContractEditorNS.loadContentTemplateData(ContractEditorNS.TemplateContractValue)},error:function(){toastr.error("Something went wrong with the saving contract section request!")}})};ContractEditorNS.UpdateContractSection=function(n){$.ajax({url:"api/Contract/updateContractSection",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",async:!0,success:function(n){n!==!1&&n!=="false"},error:function(){toastr.error("Something went wrong in updating contract section data request!")}})};ContractEditorNS.GetContractType=function(){if(ContractEditorNS.Permission.canView){$("#btnPreviewInstanceTemplate").prop("disabled",!1);$("#btnCompareTemplate").prop("disabled",!1);$("#btnToggleTagsValue").prop("disabled",!1);var n="";n=ContractEditorNS.Permission.updateContractVersion?"api/Contract/getAllContractTypeByEntityIdPreviousVersion?contractId="+ContractEditorNS.ContractId:"api/Contract/getAllContractTypeByEntityId?contractId="+ContractEditorNS.ContractId;$("#drpContractTemplate").kendoDropDownList({dataTextField:"title",dataValueField:"contractTemplateId",dataSource:{transport:{read:{dataType:"json",url:n,async:!1}}},index:0,change:ContractEditorNS.onChangeTemplate,dataBound:ContractEditorNS.ContractTemplateDataBound}).data("kendoDropDownList")}else $("#btnPreviewInstanceTemplate").prop("disabled",!0),$("#btnCompareTemplate").prop("disabled",!0),$("#btnToggleTagsValue").prop("disabled",!0)};ContractEditorNS.ContractTemplateDataBound=function(){ContractEditorNS.TemplateContractValue=this.value();ContractEditorNS.loadContentTemplateData(ContractEditorNS.TemplateContractValue)};ContractEditorNS.onChangeTemplate=function(){ContractEditorNS.TemplateContractValue=this.value();$("#contract-change-type-popup").modal("show")};ContractEditorNS.placeholder=function(){return $("<li class='list-item' id='placeholder'>Drop Here!<\/li>")};ContractEditorNS.loadContentTemplateData=function(n){var t={},i;t.ContractTemplateId=n;t.ContractId=ContractEditorNS.ContractId;i="";i=ContractEditorNS.Permission.canView==!0&&ContractEditorNS.Permission.canWrite==!1?"api/Contract/getAllContractSectionByTemplateIdPreviousVersion":"api/Contract/getAllContractSectionByTemplateId";$.ajax({url:i,type:"POST",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",async:!1,success:function(n){n!=!1&&n!="false"&&($("#lblVersion").text("Version "+n[0].version),ContractEditorNS.AvailableTags=[],ContractEditorNS.EditorValue=n,ContractEditorNS.PrevVersion=ContractEditorNS.EditorValue[0].version,ContractEditorNS.loadLeftSection(),ContractEditorNS.loadRightSection(),ContractEditorNS.GetSectionTags())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractEditorNS.GetSectionTags=function(){ContractEditorNS.AvailableTags.length>0?$.ajax({url:"api/Contract/getAllSectionTags",type:"POST",data:JSON.stringify(ContractEditorNS.AvailableTags),contentType:"application/json; charset=utf-8",async:!1,success:function(n){n!=!1&&n!="false"?(ContractEditorNS.TagsData=n,ContractEditorNS.GetContentType(n),$("#btnToggleTagsValue").prop("disabled",!1)):($("#grdTags").append("No tags available."),$("#btnToggleTagsValue").prop("disabled",!0))},error:function(){toastr.error("Something went wrong with GetSectionTags request!")}}):($("#grdTags").append("No tags available."),$("#btnToggleTagsValue").prop("disabled",!0))};ContractEditorNS.loadLeftSection=function(){var t=$("#sortableListLeft").empty(),n="";for(i=0;i<ContractEditorNS.EditorValue.length;i++)(ContractEditorNS.EditorValue[i].contractSectionId===undefined||ContractEditorNS.EditorValue[i].selected===0)&&(n+="<li class='list-item' ondblclick='ContractEditorNS.loadContent(this)' id="+i+" data-id="+ContractEditorNS.EditorValue[i].sectionTemplateId+">"+ContractEditorNS.EditorValue[i].name+"<\/li>"),ContractEditorNS.SplitTagsAvailable(ContractEditorNS.EditorValue[i].tags);t.append(n)};ContractEditorNS.SplitTagsAvailable=function(n){var t,r,u,i;if(n)if(t=n.split(","),t.length>0)for(r=0;r<t.length;r++)i={},i.ContractTagId=t[r],u=ContractEditorNS.AvailableTags.find(n=>n.ContractTagId===t[r]),u===undefined&&ContractEditorNS.AvailableTags.push(i);else i={},i.ContractTagId=t[0],ContractEditorNS.AvailableTags.push(i)};ContractEditorNS.loadRightSection=function(){var r=$("#sortableListRight").empty(),n="",t;for(i=0;i<ContractEditorNS.EditorValue.length;i++)ContractEditorNS.EditorValue[i].selected>0&&(n+="<li class='list-item' ondblclick='ContractEditorNS.loadContent(this)' id="+i+" data-id="+ContractEditorNS.EditorValue[i].sectionTemplateId+">"+ContractEditorNS.EditorValue[i].name+"<\/li>",ContractEditorNS.EditorValue[i].orderNo=i+1,ContractEditorNS.EditorValue[i].contractId===null&&ContractEditorNS.CreateContractSection(ContractEditorNS.EditorValue[i],0),(ContractEditorNS.EditorValue[i].status==4||ContractEditorNS.Permission.updateContractVersion==!0&&ContractEditorNS.Permission.status>0)&&(t=$("#drpContractTemplate").data("kendoDropDownList"),t.enable(!1)));r.append(n);ContractEditorNS.LoadEditor()};ContractEditorNS.GetContentType=function(n){var t,o,r;if($("#grdTags").empty(),n.length>0){for(t='<table class="table table-bordered table-hover"><thead><tr><th>Tag Name<\/th><th>Values<\/th><\/tr><\/thead>',i=0;i<n.length;i++){var f=n[i].type,u=n[i].name,e="ContractEditorNS."+u;f==="Text"?t+="<tr><td draggable='true' ondragstart='ContractEditorNS.dragTags(event)' id="+n[i].contractTagId+"><span class='color-box' style=background-color:"+n[i].color+"><\/span>"+u+"<\/td><td><input id=txt"+n[i].contractTagId+" onmouseleave='ContractEditorNS.tagSave(this)' class='k-textbox' type='text' name="+n[i].contractTagId+" value="+n[i].value+" data-bind=value:"+e+",keyup: ContractEditorNS.handler><\/td><\/tr>":f==="Date"?t+="<tr><td draggable='true' ondragstart='ContractEditorNS.dragTags(event)' id="+n[i].contractTagId+"><span class='color-box' style=background-color:"+n[i].color+"><\/span>"+u+"<\/td><td><input id=dt"+n[i].contractTagId+" onmouseleave='ContractEditorNS.tagSave(this)'  name="+n[i].contractTagId+" value="+n[i].value+" data-bind=html:"+e+",valueUpdate:'afterkeydown'><\/td><\/tr>":f==="Int"?t+="<tr><td draggable='true' ondragstart='ContractEditorNS.dragTags(event)' id="+n[i].contractTagId+"><span class='color-box' style=background-color:"+n[i].color+"><\/span>"+u+"<\/td><td><input id=int"+n[i].contractTagId+" onmouseleave='ContractEditorNS.tagSave(this)'  class='k-textbox' type='text' name="+n[i].contractTagId+"tag_"+n[i].contractTagId+" value="+n[i].value+" data-bind=html:"+e+",valueUpdate:'afterkeydown'><\/td><\/tr>":f==="Decimal"&&(t+="<tr><td draggable='true' ondragstart='ContractEditorNS.dragTags(event)' id="+n[i].contractTagId+"><span class='color-box' style=background-color:"+n[i].color+"><\/span>"+u+"<\/td><td><input id=decimal"+n[i].contractTagId+" onmouseleave='ContractEditorNS.tagSave(this)'  class='k-textbox' type='text' name="+n[i].contractTagId+"tag_"+n[i].contractTagId+" value="+n[i].value+" data-bind=html:"+e+",valueUpdate:'afterkeydown'><\/td><\/tr>")}for(t+="<\/table>",$("#grdTags").append(t),j=0;j<n.length;j++)o=n[j].type,r="#dt"+n[j].contractTagId,o==="Date"?$(r).kendoDateTimePicker({value:new Date,dateInput:!0}):o==="Decimal"?(r="#decimal"+n[j].contractTagId,$(r).kendoNumericTextBox()):o==="Int"&&(r="#int"+n[j].contractTagId,$(r).kendoNumericTextBox({format:"#",decimals:0}));$("#grdTags").toggleClass("no-tag-red");$("#btnToggleTagsValue").prop("disabled",!1)}else $("#grdTags").append("No tags available."),$("#grdTags").toggleClass("no-tag-red"),$("#btnToggleTagsValue").prop("disabled",!0)};ContractEditorNS.tagSave=function(n){var t=ContractEditorNS.TagsData.find(t=>t.contractTagId===n.name),i;t&&t.value!==n.value&&(ContractEditorNS.PreviousTagValue=t.value,i=jQuery.inArray(t,ContractEditorNS.TagsData),ContractEditorNS.TagsData[i].value=n.value,$.ajax({url:"api/contract/updateContractTag/",type:"PUT",data:JSON.stringify(ContractEditorNS.TagsData[i]),contentType:"application/json; charset=utf-8",async:!1,success:function(){ContractEditorNS.IsTagValue==!0&&ContractEditorNS.ToggleEditorContent("tagUpdate");toastr.success("Contract tag successfully updated!")},error:function(){toastr.error("Something went wrong with the saving contract tag request!")}}))};ContractEditorNS.AddBackgroundColorForSection=function(n,t,i){for(var f,u,r=0;r<ContractEditorNS.EditorValue.length;r++)f="ContractEditorNS."+t+"'",u='<span style="color:white;padding:1px 5px;background-color:'+n+';">'+t+"<\/span>",ContractEditorNS.EditorValue[r].content=ContractEditorNS.EditorValue[r].content.replace(new RegExp(t,"g"),u),ContractEditorNS.EditorValue[r].content.indexOf(t)>=0&&(ContractEditorNS.EditorValue[r].tags=i,ContractEditorNS.updateContractSectionTag(ContractEditorNS.EditorValue[r],i))};ContractEditorNS.LoadEditor=function(){var n="";ContractEditorNS.editor.value(n);ContractEditorNS.SelSectionCount=$("#sortableListRight li").length;$("#sortableListRight li").each(function(t){if($(this).attr("id")!=="placeholder"){var i=parseInt($(this).attr("id"));t<$("#sortableListRight li").length&&(n+=ContractEditorNS.EditorValue[i].sectionTemplateId=="a0428daa-f20e-4a57-98f5-b02d96fdefdf"?"<div class='editor' id='productEditor' data-id="+ContractEditorNS.EditorValue[i].sectionTemplateId+" data-contractsectionid="+ContractEditorNS.EditorValue[i].contractSectionId+">":"<div class='editor' id="+i+" data-id="+ContractEditorNS.EditorValue[i].sectionTemplateId+" data-contractsectionid="+ContractEditorNS.EditorValue[i].contractSectionId+">",n+=ContractEditorNS.EditorValue[i].content,n+="<\/div>")}ContractEditorNS.editor.value(n);$(".k-editor-inline #productEditor").attr("contenteditable",!1)})};ContractEditorNS.dragTags=function(n){var e=$("#editorWrapper"),r=ContractEditorNS.TagsData.find(t=>t.contractTagId===n.target.id),f;if(r){ContractEditorNS.ToggleEditorContent("");var t=r.type,u=jQuery.inArray(r,ContractEditorNS.TagsData),i="";t==="Text"?i="#txt"+n.target.id:t==="Date"?i="#dt"+n.target.id:t==="Int"?i="#int"+n.target.id:t==="Decimal"&&(i="#decimal"+n.target.id);console.log("color:"+ContractEditorNS.TagsData[u].color);f="&nbsp;<span style='color: white; padding: 1px 5px; background-color: "+ContractEditorNS.TagsData[u].color+";' >"+ContractEditorNS.TagsData[u].name+"<\/span>&nbsp;";n.dataTransfer.setData("text/html",f)}};ContractEditorNS.onEnd=function(n){var t="",i=n.item[0].id,o=n.action,e=n.item[0].dataset.id,r,u,f;if(ContractEditorNS.SelSectionCount=$("#sortableListRight li").length,r=0,u=!1,$("#sortableListRight li").each(function(){var f,n;$(this).attr("id")==="placeholder"?(r+=1,t+="<div id='editorDiv' id="+i+" data-id="+ContractEditorNS.EditorValue[i].sectionTemplateId+">",t+=ContractEditorNS.EditorValue[i].content,t+="<\/div>",ContractEditorNS.EditorValue[i].orderNo=r,f=ContractEditorNS.EditorValue.find(n=>n.sectionTemplateId===e&&n.selected>0),f===undefined&&(u=!0,ContractEditorNS.CreateContractSection(ContractEditorNS.EditorValue[i],1))):i!==$(this).attr("id")&&(r+=1,n=parseInt($(this).attr("id")),t+="<div class='editor' id="+n+" data-id="+ContractEditorNS.EditorValue[n].sectionTemplateId+">",t+=ContractEditorNS.EditorValue[n].content,t+="<\/div>",ContractEditorNS.EditorValue[n].orderNo=r);ContractEditorNS.editor.value(t)}),ContractEditorNS.Permission.updateContractVersion==!0&&u===!1&&(ContractEditorNS.Permission.status===2||ContractEditorNS.Permission.status===7))ContractEditorNS.PrevVersion==ContractEditorNS.EditorValue[0].version&&(ContractEditorNS.updateContractSectionToDraft(),ContractEditorNS.Permission.updateContractVersion=!1);else if(u===!1)for(f=0;f<ContractEditorNS.EditorValue.length;f++)ContractEditorNS.UpdateContractSection(ContractEditorNS.EditorValue[f])};ContractEditorNS.onEndRemove=function(n){var t="",r=n.action,i=n.item[0].dataset.id;ContractEditorNS.SelSectionCount=$("#sortableListRight li").length;$("#sortableListRight li").each(function(u){var f;if($("#sortableListRight li").length===0&&(t="",ContractEditorNS.editor.value("")),r!=="receive")$(this).attr("id")!=="placeholder"&&u<parseInt($("#sortableListRight li").length)&&(f=parseInt($(this).attr("id")),t+="<div class='editor' id="+f+" data-id="+ContractEditorNS.EditorValue[f].sectionTemplateId+">",t+=ContractEditorNS.EditorValue[f].content,t+="<\/div>"),ContractEditorNS.editor.value(t);else if($(this).attr("id")!=="placeholder"&&u<parseInt($("#sortableListRight li").length))if(f=parseInt($(this).attr("id")),$(this).attr("data-id")===i&&ContractEditorNS.EditorValue[f].sectionTemplateId!=="a0428daa-f20e-4a57-98f5-b02d96fdefdf")ContractEditorNS.SelSectionCount-=1,ContractEditorNS.DeleteContractSection(ContractEditorNS.EditorValue[f]);else if($(this).attr("data-id")===i&&ContractEditorNS.EditorValue[f].sectionTemplateId==="a0428daa-f20e-4a57-98f5-b02d96fdefdf")return n.preventDefault(),toastr.info("Cannot remove Product Section"),!1})};ContractEditorNS.loadContent=function(n){var r=n.id,t=n.textContent,i=$("#editorWrapper iframe").contents();$("#sortableListRight li").each(function(n){return n===0&&t===$(this)[0].textContent?(i.scrollTop(0),!1):t===$(this)[0].textContent?(i.scrollTop(($(this).innerHeight()+$(this).innerWidth())*r),!1):void 0})};ContractEditorNS.initTagEditor=function(){$("#contract-tag-type").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("");t.value()=="Text"?($("#form-tag-text").show(),$("#form-tag-datetime").hide(),$("#form-tag-int").hide(),$("#form-tag-decimal").hide()):t.value()=="Date"?($("#form-tag-text").hide(),$("#form-tag-datetime").show(),$("#form-tag-int").hide(),$("#form-tag-decimal").hide()):t.value()=="Int"?($("#form-tag-text").hide(),$("#form-tag-datetime").hide(),$("#form-tag-int").show(),$("#form-tag-decimal").hide()):t.value()=="Decimal"&&($("#form-tag-text").hide(),$("#form-tag-datetime").hide(),$("#form-tag-int").hide(),$("#form-tag-decimal").show())},dataSource:{transport:{read:{dataType:"json",url:"api/contract/getAllContractTemplateTagType"}}},suggest:!0});$("#contract-tag-value-datetime").kendoDateTimePicker({value:new Date,dateInput:!0});$("#contract-tag-value-int").kendoNumericTextBox({decimals:0,format:"n0",value:0});$("#contract-tag-value-decimal").kendoNumericTextBox({value:0});$("#contract-tag-color").kendoColorPicker({buttons:!1})};ContractEditorNS.addTag=function(n){$("#contract-tag-create-popup").modal("hide");$.ajax({url:"api/contract/createTag",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",async:!1,success:function(t){var i,r;t!=!1&&t!="false"?(i={},i.contractTagId=t.contractTagId,i.name=n.Name,i.value=n.Value,i.color=n.Color,i.type=n.Type,ContractEditorNS.TagsData.push(i),ContractEditorNS.AvailableTags=[],ContractEditorNS.GetContentType(ContractEditorNS.TagsData),r=$("#contract-tag-color").val(),ContractEditorNS.AddBackgroundColorForSection(r,ContractEditorNS.SelectedTag,t.contractTagId)):toastr.error("Tag already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractEditorNS.RemoveBackgroundColorForSection=function(n,t,i){for(var u,r=0;r<ContractEditorNS.EditorValue.length;r++)u='<span style="color:white;padding:1px 5px;background-color:'+n+';">'+t+"<\/span>",ContractEditorNS.EditorValue[r].content=ContractEditorNS.EditorValue[r].content.replace(new RegExp(u,"g"),t),ContractEditorNS.EditorValue[r].content.indexOf(t)>=0&&(ContractEditorNS.EditorValue[r].tags=i,ContractEditorNS.removeContractSectionTag(ContractEditorNS.EditorValue[r],i))};ContractEditorNS.updateContractSectionTag=function(n,t){var i={};i.ContractSectionId=n.contractSectionId;i.Tags=t;i.Content=n.content;$.ajax({url:"api/contract/updateTagContractSection/",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(){ContractEditorNS.LoadEditor();toastr.success("Tag successfully added");ContractEditorNS.SelectedTag="";$("#contract-tag-name span").text("");$("#contract-tag-type").data("kendoComboBox").value("");$("#contract-tag-value-text").val(null);$("#contract-tag-value-datetime").val(null);$("#contract-tag-value-int").val(0);$("#contract-tag-value-decimal").val(0);$("#form-tag-text").hide();$("#form-tag-datetime").hide();$("#form-tag-int").hide();$("#form-tag-decimal").hide()}})};ContractEditorNS.removeContractSectionTag=function(n,t){var i={};i.ContractSectionId=n.contractSectionId;i.Tags=t;i.Content=n.content;$.ajax({url:"api/contract/deleteTagContractSection/",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",async:!1,success:function(){var n,i;ContractEditorNS.LoadEditor();n=ContractEditorNS.TagsData.find(n=>n.contractTagId===t);n!==undefined&&(i=jQuery.inArray(n,ContractEditorNS.TagsData),ContractEditorNS.TagsData.splice(i,1),ContractEditorNS.AvailableTags=[],ContractEditorNS.GetContentType(ContractEditorNS.TagsData));toastr.success("Tag successfully removed")}})};ContractGeneralInformationHistoryNS={};ContractGeneralInformationHistoryNS.VendorId=null;ContractGeneralInformationHistoryNS.InitializeControl=function(n){ContractGeneralInformationHistoryNS.ContractId=n;ContractGeneralInformationHistoryNS.LoadControls(n)};ContractGeneralInformationHistoryNS.DataBound=function(){};ContractGeneralInformationHistoryNS.LoadControls=function(){$("#contract-alert-history-item").click(function(){ContractGeneralInformationHistoryNS.getAlertHistory()});$("#contract-permission-history-item").click(function(){ContractGeneralInformationHistoryNS.getPermissionHistory()});$("#contract-details-history-grid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/"+ContractGeneralInformationHistoryNS.ContractId+"/contractdetialshistory",dataType:"json"}},schema:{model:{fields:{title:{type:"string"},description:{type:"string"},startDate:{type:"date"},endDate:{type:"date"},location:{type:"string"},modifiedOn:{type:"date"},modifiedBy:{type:"string"}}}},pageSize:10},noRecords:!0,pageable:!0,sortable:!0,filterable:!0,scrollable:!1,messages:{noRecords:"History not yet available"},columns:[{field:"title",title:"title",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"description",title:"Description",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"startDate",title:"Start Date",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"endDate",title:"End Date",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"location",title:"Location",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"modifiedOn",title:"Modified On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"modifiedBy",title:"Modified By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"createdBy",title:"Created By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},hidden:!0},]})};ContractGeneralInformationHistoryNS.getPermissionHistory=function(){$("#contract-permission-history-grid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/"+ContractGeneralInformationHistoryNS.ContractId+"/contractpermissionhistory",dataType:"json"}},schema:{model:{fields:{name:{type:"string"},canRead:{type:"number"},canWrite:{type:"number"},canSign:{type:"number"},status:{type:"string"},createdBy:{type:"string"},createdOn:{type:"date"},modifiedOn:{type:"date"},modifiedBy:{type:"string"}}}},pageSize:10},noRecords:!0,pageable:!0,sortable:!0,filterable:!0,scrollable:!1,messages:{noRecords:"History not yet available"},columns:[{field:"name",title:"Name",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"canRead",title:"Can Read?",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},template:'<div><span> #=canRead == 1 ? "Yes" : "No" # <\/span><\/div>'},{field:"canWrite",title:"Can Write?",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},template:'<div><span> #=canWrite == 1 ? "Yes" : "No" # <\/span><\/div>'},{field:"canSign",title:"Can Sign?",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},template:'<div><span> #=canSign == 1 ? "Yes" : "No" # <\/span><\/div>'},{field:"status",title:"Status",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"createdOn",title:"Created On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"createdBy",title:"Created By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"modifiedOn",title:"Modified On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"modifiedBy",title:"Modified By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},]})};ContractGeneralInformationHistoryNS.getAlertHistory=function(){$("#contract-alert-history-grid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/"+ContractGeneralInformationHistoryNS.ContractId+"/contractalertshistory",dataType:"json"}},schema:{model:{fields:{value:{type:"string"},duration:{type:"int"},name:{type:"string"},emails:{type:"string"},createdBy:{type:"string"},createdOn:{type:"date"},modifiedOn:{type:"date"},modifiedBy:{type:"string"}}}},pageSize:10},noRecords:!0,pageable:!0,sortable:!0,filterable:!0,scrollable:!1,messages:{noRecords:"History not yet available"},columns:[{field:"name",title:"Name",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"value",title:"Value",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"duration",title:"Duration",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"createdOn",title:"Created On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"createdBy",title:"Created By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"modifiedOn",title:"Modified On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"modifiedBy",title:"Modified By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},]})};ContractGeneralInformationNS={};ContractGeneralInformationNS.VendorId=null;ContractGeneralInformationNS.ContractId=null;ContractGeneralInformationNS.Mode=0;ContractGeneralInformationNS.DeletedPermissions=[];ContractGeneralInformationNS.EmailPattern="";ContractGeneralInformationNS.OwnerId=null;ContractGeneralInformationNS.IsValid=!1;ContractGeneralInformationNS.InitializeControl=function(n,t){ContractGeneralInformationNS.Mode=0;ContractGeneralInformationNS.ContractId=t;ContractGeneralInformationNS.VendorId=n;ContractGeneralInformationNS.EmailPattern="";ContractGeneralInformationNS.OwnerId=null;ContractGeneralInformationNS.LoadControls(n,t);t?(ContractGeneralInformationNS.Mode=1,ContractGeneralInformationNS.DeletedPermissions=[],ContractGeneralInformationNS.initializeEditMenu(),ContractGeneralInformationNS.getVendorNameByVendorId(n),ContractGeneralInformationNS.getGeneralInformation(n,t)):(ContractGeneralInformationNS.Mode=0,ContractGeneralInformationNS.initializeAddMenu(),ContractGeneralInformationNS.getVendorNameByVendorId(n),ContractGeneralInformationNS.DeletedPermissions=[])};ContractGeneralInformationNS.getGeneralInformation=function(n,t){ContractGeneralInformationNS.getContractByContractId(t);ContractGeneralInformationNS.getUnmappedUsersByContractId(t);ContractGeneralInformationNS.getMappedUsers()};ContractGeneralInformationNS.getUnmappedUsersByContractId=function(n){$.ajax({url:"api/contract/"+n+"/unmapped",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){var t=$("#contract-permission-users").kendoComboBox({dataTextField:"fullName",dataValueField:"userInfoId",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:n,suggest:!0,select:function(n){var i,r;n.item&&(i=this.dataItem(n.item.index()),t.data("kendoComboBox").dataSource.remove(i),r=$("#contact-permission-grid").data().kendoGrid.dataSource,r.add({userInfoId:i.userInfoId,fullName:i.fullName,canRead:1,canWrite:2,canSign:2,contractPermissionId:null}))}})},error:function(){toastr.error("Something went wrong with the request")}})};ContractGeneralInformationNS.getContractByContractId=function(){$.ajax({url:"api/contract/"+ContractGeneralInformationNS.ContractId,type:"GET",contentType:"application/json; charset=utf-8",success:function(n){var i,r,u;if(n){$("#contractPermissionTitle").val(n.details.title);i=kendo.toString(kendo.parseDate(n.details.startDate),"MM/dd/yyyy");$("#contractDetailsStartDate").data("kendoDatePicker").value(i);r=kendo.toString(kendo.parseDate(n.details.endDate),"MM/dd/yyyy");$("#contractDetailsEndDate").data("kendoDatePicker").value(r);$("#contractDetailsDescription").val(n.details.description);u=$("#contractDetailsCountry").data("kendoComboBox");u.value(n.details.country);$("#contractVendorEntity").val(n.details.vendorEntity);var t=(new Date).toJSON().slice(0,10).replace(/-/g,"/"),f=$("#contractDetailsStartDate").kendoDatePicker({}).data("kendoDatePicker"),e=$("#contractDetailsEndDate").kendoDatePicker({}).data("kendoDatePicker");f.min(new Date(t)>new Date(n.details.startDate)?new Date(n.details.startDate):new Date(t));e.min(new Date(t)>new Date(n.details.startDate)?new Date(n.details.startDate):new Date(t));n.isOwned?$("#btnDeleteContract").show():($("#save-vendor-general-info").css({display:"none"}),$("#contractPermissionTitle").attr("disabled",!0),$("#contractDetailsStartDate").attr("disabled",!0),$("#contractDetailsEndDate").attr("disabled",!0),$("#contractDetailsEndDate").data("kendoDatePicker").enable(!1),$("#contractDetailsStartDate").data("kendoDatePicker").enable(!1),$("#contractDetailsDescription").attr("disabled",!0),$("#contractDetailsCountry").attr("disabled",!0),$("#contractDetailsCountry").data("kendoComboBox").enable(!1),$("#contractVendorEntity").attr("disabled",!0),$("#btnDeleteContract").hide(),$("#btnCancelContract").hide());n.alerts&&(document.getElementById("isContractAlertBeforeDaysExpired").checked=n.alerts.isContractAlertBeforeDaysExpired==1?!0:!1,document.getElementById("isContractAlertWhenExpired").checked=n.alerts.isContractAlertWhenExpired==1?!0:!1,document.getElementById("isAlertWhenNewContactAreIncluded").checked=n.alerts.isAlertWhenNewContactAreIncluded==1?!0:!1,$("#contractAlertBeforeDaysExpiredEmails").val(n.alerts.contractAlertBeforeDaysExpiredEmails),$("#contractAlertBeforeDaysExpiredDays").val(n.alerts.contractAlertBeforeDaysExpiredDays),$("#contractAlertWhenExpiredEmails").val(n.alerts.contractAlertWhenExpiredEmails),$("#alertWhenNewContactAreIncludedEmails").val(n.alerts.alertWhenNewContactAreIncludedEmails),n.alerts.contractAlertBeforeDaysExpiredEmails?$("#isContractAlertBeforeDaysExpired").attr("disabled",!1):$("#isContractAlertBeforeDaysExpired").attr("disabled",!0),n.alerts.contractAlertWhenExpiredEmails?$("#isContractAlertWhenExpired").attr("disabled",!1):$("#isContractAlertWhenExpired").attr("disabled",!0),n.alerts.alertWhenNewContactAreIncludedEmails?$("#isAlertWhenNewContactAreIncluded").attr("disabled",!1):$("#isAlertWhenNewContactAreIncluded").attr("disabled",!0));ContractGeneralInformationNS.EmailPattern=n.email.split("@")[1];n.ownerId&&(ContractGeneralInformationNS.OwnerId=n.ownerId.toString().toLowerCase())}else toastr.error("Something went wrong with the request!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.getVendorNameByVendorId=function(n){$.ajax({url:"api/vendor/"+n+"/name",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){$("#contract-details-company").html(n)},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.initializeAddMenu=function(){$("#contract-permission-menu").addClass("disabled");$("#contract-alert-menu").addClass("disabled");$("#contract-history-menu").addClass("disabled");$("#contract-alert-tab").attr("href","");$("#contract-history-tab").attr("href","");$("#contract-permission-tab").attr("href","");$("#contract-details-tab").trigger("click");$("#contract-history-menu").hide()};ContractGeneralInformationNS.initializeEditMenu=function(){$("#contract-permission-menu").removeClass("disabled");$("#contract-alert-menu").removeClass("disabled");$("#contract-history-menu").removeClass("disabled");$("#contract-permission-tab").attr("href","#contract-permission-content");$("#contract-alert-tab").attr("href","#contract-alert-content");$("#contract-history-tab").attr("href","#contract-history-content");$("#contract-details-tab").trigger("click");$("#contract-history-menu").show()};ContractGeneralInformationNS.getMappedUsers=function(){$("#contact-permission-grid").data("kendoGrid").dataSource.data([]);var n=new kendo.data.DataSource({transport:{read:{url:"api/contract/"+ContractGeneralInformationNS.ContractId+"/mapped",dataType:"json"}},schema:{model:{id:"userInfoId",fields:{userInfoId:{editable:!1,type:"guid"},canRead:{type:"number"},canWrite:{type:"number"},canSign:{type:"number"},contractPermissionId:{type:"guid"},fullName:{type:"string"}}}}}),t=$("#contact-permission-grid").data("kendoGrid");t.setDataSource(n)};ContractGeneralInformationNS.LoadControls=function(n,t){var r=[],f=$("#form-contract-details").kendoValidator().data("kendoValidator"),i;r=new kendo.data.DataSource({schema:{model:{id:"userInfoId",fields:{userInfoId:{editable:!1,type:"guid"},canRead:{type:"number"},canWrite:{type:"number"},canSign:{type:"number"},contractPermissionId:{type:"guid"},fullName:{type:"string"}}}}});$("#contact-permission-grid").kendoGrid({dataSource:r,noRecords:!0,sortable:!0,filterable:!0,scrollable:!1,dataBound:function(){$(".can-write").each(function(){$(this).unbind("click")});$(".can-read").each(function(){$(this).unbind("click")});$(".can-write").each(function(){$(this).on("click",function(){for(var i=$(this).attr("item-guid"),t=$("#contact-permission-grid").data().kendoGrid.dataSource.view(),n=0;n<t.length;n++)t[n].uid.toLowerCase()==i.toLowerCase()&&(t[n].canWrite==1?(t[n].set("canWrite",2),$(this).attr("data-value",2)):(t[n].set("canWrite",1),$(this).attr("data-value",1)))})});$(".can-sign").each(function(){$(this).on("click",function(){for(var i=$(this).attr("item-guid"),t=$("#contact-permission-grid").data().kendoGrid.dataSource.view(),n=0;n<t.length;n++)t[n].uid.toLowerCase()==i.toLowerCase()&&(t[n].canSign==1?(t[n].set("canSign",2),$(this).attr("data-value",2)):(t[n].set("canSign",1),$(this).attr("data-value",1)))})})},messages:{noRecords:"No Permission Yet"},editable:"inline",columns:[{field:"contractPermissionId",title:"contractPermissionId",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},hidden:!0},{field:"fullName",title:"Name",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"userInfoId",title:"UserInfoId",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},hidden:!0},{field:"canRead",title:"Can Read?",width:120,template:'<span class="text-center can-read"  style="cursor: pointer" item-guid="#:uid#" data-value="#:canRead#"><i class="#: canRead  == 1 ? "fa fa-check green-ico" : "fa fa-times red-ico" #" ><\/i><\/span>',width:"50px"},{field:"canWrite",title:"Can Write?",width:120,template:'<span class="text-center can-write" style="cursor: pointer" item-guid="#:uid#" data-value="#:canWrite#"><i class="#: canWrite  == 1 ? "fa fa-check green-ico" : "fa fa-times red-ico" #" ><\/i><\/span>'},{field:"canSign",title:"Can Sign?",width:120,template:'<span class="text-center can-sign" style="cursor: pointer" item-guid="#:uid#" data-value="#:canSign#"><i class="#: canSign  == 1 ? "fa fa-check green-ico" : "fa fa-times red-ico" #"><\/i><\/span>'},{field:"destroy",title:" ",width:"60px",template:"<center><span class='fas fa-trash' style='text-align: center; cursor:pointer' onclick=\"ContractGeneralInformationNS.deletePermissionRow('#= uid #')\" > <\/span> <\/center>"},]});var u=(new Date).toJSON().slice(0,10).replace(/-/g,"/"),e=$("#contractDetailsStartDate").kendoDatePicker({}).data("kendoDatePicker"),o=$("#contractDetailsEndDate").kendoDatePicker({}).data("kendoDatePicker");e.min(new Date(u));o.min(new Date(u));$("#contractAlertWhenExpiredEmails").change(function(){$(this).val()?$("#isContractAlertWhenExpired").prop("disabled",!1):($("#isContractAlertWhenExpired").prop("checked",!1),$("#isContractAlertWhenExpired").attr("disabled",!0))});$("#contractAlertBeforeDaysExpiredEmails").change(function(){$(this).val()?$("#isContractAlertBeforeDaysExpired").prop("disabled",!1):($("#isContractAlertBeforeDaysExpired").prop("checked",!1),$("#isContractAlertBeforeDaysExpired").attr("disabled",!0))});$("#alertWhenNewContactAreIncludedEmails").change(function(){$(this).val()?$("#isAlertWhenNewContactAreIncluded").prop("disabled",!1):($("#isAlertWhenNewContactAreIncluded").prop("checked",!1),$("#isAlertWhenNewContactAreIncluded").attr("disabled",!0))});ContractGeneralInformationNS.Mode==1&&ContractGeneralInformationNS.getContractByContractId(ContractGeneralInformationNS.ContractId);$("form#form-contract-details").submit(function(n){n.preventDefault();f.validate()&&($("#contractDetailsStartDate").data("kendoDatePicker").value()>=$("#contractDetailsEndDate").data("kendoDatePicker").value()?toastr.error("Please check the start date and the end date."):ContractGeneralInformationNS.saveVendorDetails())});i=$("#form-contract-details");kendo.init(i);i.kendoValidator({rules:{greaterdate:function(n){if(n.is("[data-greaterdate-msg]")&&n.val()!=""){var i=kendo.parseDate(n.val()),t=kendo.parseDate($("[name='"+n.data("greaterdateField")+"']").val());return t==null||t.getTime()<i.getTime()}return!0}}});$("#update-contract-permissions").click(function(){ContractGeneralInformationNS.saveContractPermissions()});$("#contractDetailsCountry").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:countryList,suggest:!0});$("form#form-contract-alert").submit(function(n){var r,f,e,t,u,i,o;n.preventDefault();r=!0;$("#contractAlertBeforeDaysExpiredEmails").val()&&(t=$("#contractAlertBeforeDaysExpiredEmails").val(),t.length>1&&(u=t.substr(t.length-1),u==";"&&(t=t.slice(0,-1),$("#contractAlertBeforeDaysExpiredEmails").val(t))),i=[],f=[],i=t.split(";"),$("#contractAlertBeforeDaysExpiredEmailsValidator").hide(),i.forEach(function(n){if(validateEmail(n)&&n.split("@")[1].toLowerCase()==ContractGeneralInformationNS.EmailPattern.toLowerCase())if(f.indexOf(n.toLowerCase())<0)f.push(n.toLowerCase());else{$("#primaryContactChangeEmailsValidator").show();r=!1;return}else{r=!1;$("#contractAlertBeforeDaysExpiredEmailsValidator").show();return}}));$("#contractAlertWhenExpiredEmails").val()&&(t=$("#contractAlertWhenExpiredEmails").val(),t.length>1&&(u=t.substr(t.length-1),u==";"&&(t=t.slice(0,-1),$("#contractAlertWhenExpiredEmails").val(t))),i=[],e=[],i=t.split(";"),$("#contractAlertWhenExpiredEmailsValidator").hide(),i.forEach(function(n){if(validateEmail(n)&&n.split("@")[1].toLowerCase()==ContractGeneralInformationNS.EmailPattern.toLowerCase())if(e.indexOf(n.toLowerCase())<0)e.push(n.toLowerCase());else{$("#contractAlertWhenExpiredEmailsValidator").show();r=!1;return}else{r=!1;$("#contractAlertWhenExpiredEmailsValidator").show();return}}));$("#alertWhenNewContactAreIncludedEmails").val()&&(t=$("#alertWhenNewContactAreIncludedEmails").val(),t.length>1&&(u=t.substr(t.length-1),u==";"&&(t=t.slice(0,-1),$("#alertWhenNewContactAreIncludedEmails").val(t))),i=[],o=[],i=t.split(";"),$("#alertWhenNewContactAreIncludedEmailsValidator").hide(),i.forEach(function(n){if(validateEmail(n)&&n.split("@")[1].toLowerCase()==ContractGeneralInformationNS.EmailPattern.toLowerCase())if(o.indexOf(n.toLowerCase())<0)o.push(n.toLowerCase());else{$("#alertWhenNewContactAreIncludedEmailsValidator").show();r=!1;return}else{r=!1;$("#alertWhenNewContactAreIncludedEmailsValidator").show();return}}));r&&ContractGeneralInformationNS.saveContractAlerts()});t||$("#contact-permission-grid").data("kendoGrid").dataSource.data([]);$("#btnDeleteContract").click(function(n){n.preventDefault();ContractGeneralInformationNS.deleteContract(ContractGeneralInformationNS.ContractId)});$("#btnCancelContract").click(function(n){n.preventDefault();ContractGeneralInformationNS.cancelContract(ContractGeneralInformationNS.ContractId)});$("#contract-history-menu").click(function(){$("#contract-history-menu").hasClass("disabled")||ContractGeneralInformationNS.getHistory()})};ContractGeneralInformationNS.saveContractAlerts=function(){var n={};n.Alert={};n.Alert.IsContractAlertWhenExpired=$("#isContractAlertWhenExpired").is(":checked")?1:0;n.Alert.ContractAlertWhenExpiredEmails=$("#contractAlertWhenExpiredEmails").val();n.Alert.IsContractAlertBeforeDaysExpired=$("#isContractAlertBeforeDaysExpired").is(":checked")?1:0;n.Alert.ContractAlertBeforeDaysExpiredDays=parseInt($("#contractAlertBeforeDaysExpiredDays").val());n.Alert.ContractAlertBeforeDaysExpiredEmails=$("#contractAlertBeforeDaysExpiredEmails").val();n.Alert.IsAlertWhenNewContactAreIncluded=$("#isAlertWhenNewContactAreIncluded").is(":checked")?1:0;n.Alert.AlertWhenNewContactAreIncludedEmails=$("#alertWhenNewContactAreIncludedEmails").val();n.ContractId=ContractGeneralInformationNS.ContractId;ContractGeneralInformationNS.updateContractAlerts(n)};ContractGeneralInformationNS.updateContractAlerts=function(n){$.ajax({url:"api/contract/"+ContractGeneralInformationNS.ContractId+"/alerts",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n.error?toastr.error(n.error):toastr.success("Contract alerts successfully updated")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.saveVendorDetails=function(){var n={};n.DetailInformation={};n.DetailInformation.Title=$("#contractPermissionTitle").val();n.DetailInformation.StartDate=$("#contractDetailsStartDate").val();n.DetailInformation.EndDate=$("#contractDetailsEndDate").val();n.DetailInformation.Description=$("#contractDetailsDescription").val();n.DetailInformation.Country=$("#contractDetailsCountry").val();n.DetailInformation.VendorEntity=$("#contractVendorEntity").val();n.VendorId=ContractGeneralInformationNS.VendorId;ContractGeneralInformationNS.Mode==0?(n.ContractId="00000000-0000-0000-0000-000000000000",n.DetailInformation.ContractId="00000000-0000-0000-0000-000000000000",ContractGeneralInformationNS.createContractDetails(n)):(n.ContractId=ContractGeneralInformationNS.ContractId,n.DetailInformation.ContractId=ContractGeneralInformationNS.ContractId,ContractGeneralInformationNS.updateContractDetails(n))};ContractGeneralInformationNS.createContractDetails=function(n){$.ajax({url:"api/contract/",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(t){t.error?toastr.error(t.error):($("#lblContractNameValue").text(n.DetailInformation.Title),$("#contractGrid").data("kendoGrid").dataSource.read(),toastr.success("Contract successfully added"),$("#btnDeleteContract").show(),ContractGeneralInformationNS.Mode=1,ContractGeneralInformationNS.ContractId=t,ContractGeneralInformationNS.initializeEditMenu(),ContractWizardNS.ContractId=t,ContractGeneralInformationNS.getGeneralInformation(ContractGeneralInformationNS.VendorId,ContractGeneralInformationNS.ContractId))},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.updateContractDetails=function(n){$.ajax({url:"api/contract/"+ContractGeneralInformationNS.ContractId,type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(t){t.error?toastr.error(t.error):($("#lblContractNameValue").text(n.DetailInformation.Title),$("#contractGrid").data("kendoGrid").dataSource.read(),toastr.success("Contract successfully updated"))},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.saveContractPermissions=function(){for(var i,r,t=$("#contact-permission-grid").data().kendoGrid.dataSource.view(),u=[],f=0,n=0;n<t.length;n++)i={},i.UserInfoId=t[n].userInfoId==null?"00000000-0000-0000-0000-000000000000":t[n].userInfoId,i.CanRead=t[n].canRead,i.CanWrite=t[n].canWrite,i.CanSign=t[n].canSign,i.ContractPermissionId=t[n].contractPermissionId==null?"00000000-0000-0000-0000-000000000000":t[n].contractPermissionId,u.push(i),f++;if(f==0){toastr.error("Permission is required");return}r={};r.DeletedPermissions=ContractGeneralInformationNS.DeletedPermissions;r.Permissions=u;r.ContractId=ContractGeneralInformationNS.ContractId;ContractGeneralInformationNS.updatePermissions(r)};ContractGeneralInformationNS.updatePermissions=function(n){$.ajax({url:"api/contract/"+ContractGeneralInformationNS.ContractId+"/permissions",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n.error?toastr.error(n.error):($("#contractGrid").data("kendoGrid").dataSource.read(),ContractGeneralInformationNS.DeletedPermissions=[],$("#contact-permission-grid").data("kendoGrid").dataSource.read(),toastr.success("Contract permissions successfully updated"))},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.deletePermissionRow=function(n){var i,t,u;if(confirm("Are you sure you want to delete this item?"))for(i=$("#contact-permission-grid").data().kendoGrid.dataSource.view(),t=0;t<i.length;t++)if(i[t].uid.toLowerCase()==n.toLowerCase()){var r=$("#contact-permission-grid").data("kendoGrid"),f=$("#contract-permission-users").getKendoComboBox(),e=f.dataSource;i[t].userInfoId!=ContractGeneralInformationNS.OwnerId?(e.add({userInfoId:i[t].userInfoId,fullName:i[t].fullName}),u=r.dataSource.getByUid(n.toLowerCase()),r.dataSource.remove(u),i[t].contractPermissionId!=null&&ContractGeneralInformationNS.DeletedPermissions.push({UserInfoId:i[t].userInfoId})):toastr.error("Cannot delete the contract creator in the permission")}};ContractGeneralInformationNS.deleteContract=function(n){confirm("Are you sure you want to delete this contract?")&&$.ajax({url:"api/contract/"+n,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n.error?toastr.error(n.error):(toastr.success("Contract deleted"),$(".buttonExit").trigger("click"),$("#contractGrid").data("kendoGrid").dataSource.read())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.cancelContract=function(n){confirm("Are you sure you want to cancel this contract?")&&$.ajax({url:"api/contract/"+n+"/updateContractToCanceled",type:"PUT",contentType:"application/json; charset=utf-8",success:function(n){n.error?toastr.error(n.error):(toastr.success("Contract canceled"),$(".buttonExit").trigger("click"),$("#contractGrid").data("kendoGrid").dataSource.read())},error:function(){toastr.error("Something went wrong with the request!")}})};ContractGeneralInformationNS.getHistory=function(){$.ajax({url:"/history/ContractGeneralInformation?contractId="+ContractGeneralInformationNS.ContractId}).done(function(n){$("#contract-history-content-pane").empty();$("#contract-history-content-pane").html(n)})};ContractManagementVendorNS={};ContractManagementVendorNS.Mode=0;ContractManagementVendorNS.ContractId=null;ContractManagementVendorNS.ContractPaymentId="";ContractManagementVendorNS.PaymentApprovedAction=!1;ContractManagementVendorNS.init=function(){ContractManagementVendorNS.initializeControls();ContractManagementVendorNS.showVendors()};ContractManagementVendorNS.initializeControls=function(){$("h3#page-title").text("My Contracts")};ContractManagementVendorNS.showVendors=function(){var n=$("#contractGrid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/clientlist",dataType:"json"}},pageSize:20},sortable:!0,pageable:!0,filterable:!0,detailTemplate:kendo.template($("#contract-template").html()),dataBound:function(){$('[data-toggle="tooltip"]').tooltip()},detailInit:detailInitVendor,columns:[{field:"vendorName",title:"Client Name",template:'<div><span style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-html="true" title="<img src=\'#=imageURL#\'/ height=\'20\' width=\'20\'> #=vendorEmail#" > #= vendorName #<\/span><\/div>',filterable:{extra:!1,operators:{string:{contains:"Contains"}}}},{field:"vendorContact",title:"Primary Contact",template:'<div><span style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-html="true" title=" #=email # <br/> #=contactNo#"> #=vendorContact ? vendorContact : "" # <\/span><\/div>',filterable:{extra:!1,operators:{string:{contains:"Contains"}}}},{field:"noOfActiveContracts",title:"Active Contracts",width:"140px",template:'<div style="text-align:right; color: #: noOfActiveContracts  > 0 ? "green" : "red" #">#: noOfActiveContracts #<\/div>',filterable:{mode:"row",extra:!1,operators:{string:{eq:"Is equal to",neq:"Is not equal to"}}}},{field:"totalContractValue",title:"Total Contract Value",template:'<center><div style="text-align:right; color: #: totalContractValue  > 0 ? "green" : "red" #">$#=totalContractValue != null ? totalContractValue: 0 #<\/div><\/center>',width:"160px",filterable:{extra:!1,operators:{string:{eq:"Is equal to",neq:"Is not equal to"}}}},{field:"noOfAlerts",title:"Alerts",template:'<center><div data-toggle="tooltip" data-placement="top" title="#= noOfAlerts  > 0 ? \'View alerts\' : \'No alerts\' #" onclick=\'ContractManagementVendorNS.showVendorAlerts("#= vendorId #","#= noOfAlerts #" )\' class="#: noOfAlerts  > 0 ? "badge badge-red" : "badge badge-gray" #"> #= noOfAlerts #  <\/div><\/center>',headerAttributes:{style:"text-align: center"},width:"120px",filterable:{extra:!1,operators:{string:{eq:"Is equal to",neq:"Is not equal to"}}}},]})};ContractManagementVendorNS.showAddContract=function(n,t){$("#lblContractNameValue").text("TBD");$("#lblContractStatus").text("Draft");ContractManagementNS.Mode=0;ContractManagementVendorNS.Mode=0;ContractWizardNS.initializeWizard(n,t,1);$("#contractModal").modal("show")};ContractManagementVendorNS.showVendorAlerts=function(n,t){parseInt(t)>0&&$("#my-vendor-alerts-grid").modal("show")};ContractManagementVendorNS.showEditContract=function(n,t,i,r){ContractManagementVendorNS.ContractId=t;ContractManagementVendorNS.Mode=1;ContractWizardNS.initializeWizard(n,t,1);$("#lblContractStatus").text(i);$("#lblContractNameValue").text(r);$("#contractModal").modal("show")};ContractManagementVendorNS.addProduct=function(n,t,i,r){ContractWizardNS.initializeWizard(n,t,3);$("#lblContractStatus").text(i);$("#lblContractNameValue").text(r)};ContractManagementVendorNS.showAmmendments=function(n,t){parseInt(t)>0&&$("#my-contract-ammendments-grid").modal("show")};ContractManagementVendorNS.showPayment=function(n){ContractManagementVendorNS.ContractId=n;ContractManagementVendorNS.initEditor();ContractManagementVendorNS.populateContractPayment();$("#my-contract-payment").modal("show");$("#vendor-approval-form").hide();$("#vendor-payment-button").hide()};ContractManagementVendorNS.initEditor=function(){$("#my-contract-payment").on("hidden.bs.modal",function(){ContractManagementVendorNS.PaymentApprovedAction!=!1&&($("#contractGrid").data("kendoGrid").dataSource.read(),ContractManagementVendorNS.PaymentApprovedAction=!1)})};ContractManagementVendorNS.populateContractPayment=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/contract/getContractPaymentByContractId/"+ContractManagementVendorNS.ContractId,dataType:"json"}},batch:!1,pageSize:10,schema:{model:{id:"contractPaymentId",fields:{contractPaymentId:{editable:!1,type:"guid"},purchaseOrderNo:{editable:!1,validation:{required:!0}},datePurchase:{editable:!1,validation:{required:!0}},status:{editable:!1,validation:{required:!0}},dateReceive:{editable:!1,validation:{required:!0}},attachmentURL:{editable:!1,validation:{required:!0}},attachmentName:{editable:!1,validation:{required:!0}},remark:{editable:!1,validation:{required:!0}}}}}});$("#my-contract-payment-grid").kendoGrid({dataSource:n,pageable:!0,columns:[{field:"contractPaymentId",title:"ContractProductId",hidden:!0},{field:"purchaseOrderNo",title:"Purchase Order No"},{field:"datePurchase",title:"Date Purchase",template:'#if(datePurchase != null) {# #= kendo.toString(kendo.parseDate(datePurchase), "MM/dd/yyyy")# #} else {#<span> <\/span>#}#'},{field:"status",title:"Status",template:"<div style='text-align: left;color:#: status == 'Approved' ? 'green' : status == 'Waiting for Approval' ? 'blue' : 'red'  # '> #=status# <\/div>"},{field:"dateReceive",title:"Date Receive",template:'#if(dateReceive != null) {# #= kendo.toString(kendo.parseDate(dateReceive), "MM/dd/yyyy")# #} else {#<span> <\/span>#}#'},{field:"attachmentName",title:"Attachment",template:'<a href="#=attachmentURL#"> #=attachmentName# <\/a>'},{field:"remark",title:"Remark"},{field:" ",title:"Action",width:"50px",filterable:!1,template:"#if(status != 'Approved') {#<center><span class='fas fa-pencil-alt' style='text-align: center; cursor:pointer' onclick=\"ContractManagementVendorNS.editPurchaseOrder('#= purchaseOrderNo #' ,'#= contractPaymentId #')\" > <\/span><\/center># } else {#<center><span class='fas fa-pencil-alt' style='cursor: not-allowed;'> <\/span><\/center>#}#"},{field:" ",title:"Delete",width:"50px",filterable:!1,template:"#if(status == 'Waiting for Approval') {#<center><span class='fas fa-trash' style='text-align: center; cursor:pointer' onclick=\"ContractManagementNS.deletePurchaseOrder('#= contractPaymentId #')\" > <\/span><\/center># } else {#<center><span class='fas fa-trash' style='cursor: not-allowed;'> <\/span><\/center>#}#"}],scrollable:!1,sortable:!0,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};ContractManagementVendorNS.editPurchaseOrder=function(n,t){ContractManagementVendorNS.ContractPaymentId=t;$("#purchaseOrderLabel span").text(n);$("#vendor-approval-form").show();$("#vendor-payment-button").show()};ContractManagementVendorNS.purcharseOrderApproval=function(n){var t={};t.ContractPaymentId=ContractManagementVendorNS.ContractPaymentId;t.Remark=$("#payment-remark").val();n=="approved"?t.Status=2:n=="reject"&&(t.Status=3);$.ajax({url:"api/contract/purchaseOrderApproval",type:"POST",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#my-contract-payment-grid").data("kendoGrid").dataSource.read(),$("#vendor-approval-form").hide(),$("#vendor-payment-button").hide(),ContractManagementVendorNS.PaymentApprovedAction=!0,ContractManagementVendorNS.ContractPaymentId="",$("#purchaseOrderLabel span").text(""),$("#payment-remark").val(null)):toastr.error("Error deleting product!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractManagementNS={};ContractManagementNS.Mode=0;ContractManagementNS.ContractId=null;ContractManagementNS.AttachmentPaymentName="";ContractManagementNS.PaymentApprovedAction=!1;ContractManagementNS.init=function(){ContractManagementNS.initializeControls();ContractManagementNS.showVendors()};ContractManagementNS.initializeControls=function(){$("h3#page-title").text("My Contracts")};ContractManagementNS.showVendors=function(){var n=$("#contractGrid").kendoGrid({dataSource:{transport:{read:{url:"api/contract/vendorList",dataType:"json"}},pageSize:20},sortable:!0,pageable:!0,filterable:!0,detailTemplate:kendo.template($("#contract-template").html()),dataBound:function(){$('[data-toggle="tooltip"]').tooltip()},detailInit:detailInit,columns:[{field:"vendorName",title:"Vendor Name",template:'<div><span style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-html="true" title="<img src=\'#=imageURL#\'/ height=\'20\' width=\'20\'> #=vendorEmail#" > #= vendorName #<\/span><\/div>',filterable:{extra:!1,operators:{string:{contains:"Contains"}}}},{field:"vendorContact",title:"Primary Contact",template:'<div><span style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-html="true" title=" #=email # <br/> #=contactNo#"> #=vendorContact ? vendorContact : "" # <\/span><\/div>',filterable:{extra:!1,operators:{string:{contains:"Contains"}}}},{field:"noOfActiveContracts",title:"Active Contracts",width:"140px",template:'<div style="text-align:right; color: #: noOfActiveContracts  > 0 ? "green" : "red" #">#: noOfActiveContracts #<\/div>',filterable:{mode:"row",extra:!1,operators:{string:{eq:"Is equal to",neq:"Is not equal to"}}}},{field:"totalContractValue",title:"Total Contract Value",template:'<center><div style="text-align:right; color: #: totalContractValue  > 0 ? "green" : "red" #">$#=totalContractValue != null ? totalContractValue: 0 #<\/div><\/center>',width:"160px",filterable:{extra:!1,operators:{string:{eq:"Is equal to",neq:"Is not equal to"}}}},{field:"noOfAlerts",title:"Alerts",template:'<center><div data-toggle="tooltip" data-placement="top" title="#= noOfAlerts  > 0 ? \'View alerts\' : \'No alerts\' #" onclick=\'ContractManagementNS.showVendorAlerts("#= vendorId #","#= noOfAlerts #" )\' class="#: noOfAlerts  > 0 ? "badge badge-red" : "badge badge-gray" #"> #= noOfAlerts #  <\/div><\/center>',headerAttributes:{style:"text-align: center"},width:"120px",filterable:{extra:!1,operators:{string:{eq:"Is equal to",neq:"Is not equal to"}}}},{field:"actions",title:"Edit Vendor",template:"<div style='text-align: center; cursor:pointer'><i onclick=\"VendorManagementNS.showEditVendor('#= vendorId #')\" class='fas fa-pencil-alt'><\/i><\/div>",headerAttributes:{style:"text-align: center"},width:"120px"}]})};ContractManagementNS.showAddContract=function(n,t){$("#lblContractNameValue").text("TBD");$("#lblContractStatus").text("Draft");ContractManagementNS.Mode=0;ContractWizardNS.initializeWizard(n,t,1);$("#contractModal").modal("show")};ContractManagementNS.showVendorAlerts=function(n,t){parseInt(t)>0&&$("#my-vendor-alerts-grid").modal("show")};ContractManagementNS.showEditContract=function(n,t,i,r){ContractManagementNS.ContractID=t;ContractManagementNS.Mode=1;ContractWizardNS.initializeWizard(n,t,1);$("#contractModal").modal("show");$("#lblContractStatus").text(i);$("#lblContractNameValue").text(r)};ContractManagementNS.addProduct=function(n,t,i,r){ContractWizardNS.initializeWizard(n,t,3);$("#lblContractStatus").text(i);$("#lblContractNameValue").text(r)};ContractManagementNS.showAmmendments=function(n,t){parseInt(t)>0&&$("#my-contract-ammendments-grid").modal("show")};ContractManagementNS.showPayment=function(n){ContractManagementNS.ContractId=n;ContractManagementNS.initEditor();ContractManagementNS.populateContractPayment();$("#my-contract-payment").modal("show")};ContractManagementNS.populateContractPayment=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/contract/getContractPaymentByContractId/"+ContractManagementNS.ContractId,dataType:"json"}},batch:!1,pageSize:10,schema:{model:{id:"contractPaymentId",fields:{contractPaymentId:{editable:!1,type:"guid"},purchaseOrderNo:{editable:!1,validation:{required:!0}},datePurchase:{editable:!1,validation:{required:!0}},status:{editable:!1,validation:{required:!0}},dateReceive:{editable:!1,validation:{required:!0}},attachmentURL:{editable:!1,validation:{required:!0}},attachmentName:{editable:!1,validation:{required:!0}},remark:{editable:!1,validation:{required:!0}}}}}});$("#my-contract-payment-grid").kendoGrid({dataSource:n,pageable:!0,columns:[{field:"contractPaymentId",title:"ContractProductId",hidden:!0},{field:"purchaseOrderNo",title:"Purchase Order No"},{field:"datePurchase",title:"Date Purchase",template:'#if(datePurchase != null) {# #= kendo.toString(kendo.parseDate(datePurchase), "MM/dd/yyyy")# #} else {#<span> <\/span>#}#'},{field:"status",title:"Status",template:"<div style='text-align: left;color:#: status == 'Approved' ? 'green' : status == 'Waiting for Approval' ? 'blue' : 'red'  # '> #=status# <\/div>"},{field:"dateReceive",title:"Date Receive",template:'#if(dateReceive != null) {# #= kendo.toString(kendo.parseDate(dateReceive), "MM/dd/yyyy")# #} else {#<span> <\/span>#}#'},{field:"attachmentName",title:"Attachment",template:'<a href="#=attachmentURL#"> #=attachmentName# <\/a>'},{field:"remark",title:"Remark"},{field:" ",title:"Delete",width:"50px",filterable:!1,template:"#if(status == 'Waiting for Approval') {#<center><span class='fas fa-trash' style='text-align: center; cursor:pointer' onclick=\"ContractManagementNS.deletePurchaseOrder('#= contractPaymentId #')\" > <\/span><\/center># } else {#<center><span class='fas fa-trash' style='cursor: not-allowed;'> <\/span><\/center>#}#"}],scrollable:!1,sortable:!0,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};ContractManagementNS.initEditor=function(){$("#payment-attachment").change(function(){ContractManagementNS.ReadFile(this)});$("#my-contract-payment").on("hidden.bs.modal",function(){ContractManagementNS.PaymentApprovedAction!=!1&&($("#contractGrid").data("kendoGrid").dataSource.read(),ContractManagementNS.PaymentApprovedAction=!1)})};ContractManagementNS.addPurchaseOrder=function(){var n={};n.ContractId=ContractManagementNS.ContractId;n.PurchaseOrderNo=$("#payment-po").val();n.AttachmentURL=$("#payment-attachment").attr("src");n.AttachmentName=ContractManagementNS.AttachmentPaymentName;$.ajax({url:"api/contract/contractPayment",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#my-contract-payment-grid").data("kendoGrid").dataSource.read(),$("#payment-po").val(null),$("#payment-attachment").val(""),ContractManagementNS.AttachmentPaymentName="",ContractManagementNS.PaymentApprovedAction=!0,toastr.success("Purchase Order successfully added")):toastr.error("Purchase Order already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractManagementNS.deletePurchaseOrder=function(n){confirm("Are you sure you want to delete this item?")&&$.ajax({url:"api/contract/contractPayment/"+n,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#my-contract-payment-grid").data("kendoGrid").dataSource.read(),ContractManagementNS.PaymentApprovedAction=!0):toastr.error("Error deleting product!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractManagementNS.ReadFile=function(n){if(n.files&&n.files[0]){var t=new FileReader;t.onload=function(n){$("#payment-attachment").attr("src",n.target.result);var t=n.target.result;attachementURL=t.replace(" ","+")};t.readAsDataURL(n.files[0]);ContractManagementNS.AttachmentPaymentName=n.files[0].name}};ContractProductNS={};ContractProductNS.ContractID=null;ContractProductNS.IsClient=null;ContractProductNS.init=function(n,t){ContractProductNS.ContractID=n;ContractProductNS.IsClient=parseBoolean(t);ContractProductNS.hookup()};ContractProductNS.hookup=function(){ContractProductNS.initComboBox();ContractProductNS.populateContractProduct();ContractProductNS.IsClient||$("#add-contractProduct").hide()};ContractProductNS.initComboBox=function(){$("#contractProduct-productMatrix").kendoComboBox({dataTextField:"name",dataValueField:"productMatrixId",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:{transport:{read:{dataType:"json",url:"api/contract/productMatrixList"}}},suggest:!0})};ContractProductNS.populateContractProduct=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/contract/contractProduct/"+ContractProductNS.ContractID,dataType:"json"}},batch:!1,pageSize:10,schema:{model:{id:"contractProductId",fields:{contractProductId:{editable:!1,type:"guid"},contractId:{editable:!1,type:"guid"},productMatrixId:{editable:!1,type:"guid"},code:{editable:!1,validation:{required:!0}},name:{editable:!1,validation:{required:!0}},productTypeId:{editable:!0,type:"guid"},productTypeName:{editable:!1,validation:{required:!0}},productLicenseMetricId:{editable:!0,type:"guid"},productLicenseMetricName:{validation:{required:!0}},productLicenseTermId:{editable:!0,type:"guid"},productLicenseTermName:{validation:{required:!0}},quantity:{editable:ContractProductNS.IsClient,validation:{required:!0}},unitPrice:{editable:!0,validation:{required:!0}},discount:{editable:!0,validation:{required:!0}},price:{editable:!1,validation:{required:!0}},edit:{editable:!1},destroy:{editable:!1}}}}});$("#contractProduct-grid").kendoGrid({dataSource:n,pageable:!0,columns:[{field:"contractProductId",title:"ContractProductId",hidden:!0},{field:"code",title:"Product Code"},{field:"name",title:"Name"},{field:"productTypeId",title:"Type",editor:ContractProductNS.licenseTypeComboBoxEditor,template:"#=productTypeName#"},{field:"productLicenseMetricId",title:"License Metric",editor:ContractProductNS.licenseMetricComboBoxEditor,template:"#=productLicenseMetricName#"},{field:"productLicenseTermId",title:"License Term",editor:ContractProductNS.licenseTermComboBoxEditor,template:"#=productLicenseTermName#"},{field:"quantity",title:"Quantity",editor:ContractProductNS.numericTextBoxEditor},{field:"unitPrice",title:"Unit Price",width:"110px",editor:ContractProductNS.numericTextBoxEditor,hidden:ContractProductNS.IsClient},{field:"discount",title:"Discount %",width:"110px",editor:ContractProductNS.discountNumericTextBoxEditor,hidden:ContractProductNS.IsClient},{field:"price",title:"Price",width:"100px"},{field:"edit",title:"Edit",width:"50px",filterable:!1,command:[{name:"edit",text:{edit:" ",update:" ",cancel:" "}}]},{field:"destroy",title:"Delete",width:"50px",filterable:!1,template:"<center>  <span class='fas fa-trash' style='text-align: center; cursor:pointer' onclick=\"ContractProductNS.deleteContractProduct('#= contractProductId #')\" > <\/span> <\/center>"}],editable:"inline",scrollable:!1,sortable:!0,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0,save:function(n){$.ajax({url:"api/contract/contractProduct",type:"PUT",data:JSON.stringify(n.model),contentType:"application/json; charset=utf-8",success:function(){$("#contractProduct-grid").data("kendoGrid").dataSource.read()},error:function(){toastr.error("Something went wrong with the request!")}})}})};ContractProductNS.licenseTypeComboBoxEditor=function(n,t){$('<input data-bind="value:'+t.field+'"/>').appendTo(n).kendoComboBox({dataTextField:"name",dataValueField:"productTypeId",dataSource:{transport:{read:{dataType:"json",url:"api/product/productTypeList"}}}})};ContractProductNS.licenseTermComboBoxEditor=function(n,t){$('<input data-bind="value:'+t.field+'"/>').appendTo(n).kendoComboBox({dataTextField:"name",dataValueField:"productLicenseTermId",dataSource:{transport:{read:{dataType:"json",url:"api/product/productLicenseTerm"}}}})};ContractProductNS.licenseMetricComboBoxEditor=function(n,t){$('<input data-bind="value:'+t.field+'"/>').appendTo(n).kendoComboBox({dataTextField:"name",dataValueField:"productLicenseMetricId",dataSource:{transport:{read:{dataType:"json",url:"api/product/productLicenseMetric"}}}})};ContractProductNS.numericTextBoxEditor=function(n,t){$('<input data-bind="value:'+t.field+'" min="0"/>').appendTo(n).kendoNumericTextBox()};ContractProductNS.discountNumericTextBoxEditor=function(n,t){$('<input data-bind="value:'+t.field+'" min="0" max="100"/>').appendTo(n).kendoNumericTextBox()};ContractProductNS.addContractProduct=function(){var t=$("#contractProduct-productMatrix").data("kendoComboBox").dataItem().productMatrixId,n={};n.ProductMatrixId=t;n.ContractId=ContractProductNS.ContractID;$.ajax({url:"api/contract/contractProduct",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?$("#contractProduct-grid").data("kendoGrid").dataSource.read():toastr.error("Error adding product!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractProductNS.deleteContractProduct=function(n){confirm("Are you sure you want to delete this item?")&&$.ajax({url:"api/contract/contractProduct/"+n,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?$("#contractProduct-grid").data("kendoGrid").dataSource.read():toastr.error("Error deleting product!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractTemplateManagementNS={};ContractTemplateManagementNS.ContractTemplateId="";ContractTemplateManagementNS.init=function(){ContractTemplateManagementNS.populateTemplateList()};ContractTemplateManagementNS.populateTemplateList=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/contract/getAllContractTypeByEntityId",dataType:"json"}},batch:!1,pageSize:10,schema:{model:{id:"contractTemplateId",fields:{contractTemplateId:{editable:!1,type:"guid"},title:{editable:!1,validation:{required:!0}}}}}});$("#contract-template-grid").kendoGrid({dataSource:n,selectable:!0,pageable:!0,columns:[{field:"contractTemplateId",title:"ContractTemplateId",hidden:!0},{field:"title",title:"Title"},{field:"modifiedBy",title:"Modified By"},{field:"modifiedBy",title:"Modified Date",filterable:!1,template:'#= kendo.toString(kendo.parseDate(modifiedDate), "MM/dd/yyyy")#'}],scrollable:!1,sortable:!0,change:ContractTemplateManagementNS.onChange,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};ContractTemplateManagementNS.onChange=function(){var n=this;n.select().length>=1?n.select().each(function(){var t=n.dataItem($(this));ContractTemplateManagementNS.ContractTemplateId=t.contractTemplateId;ContractEditorManagementNS.TemplateName=t.title;$("#edit-template").prop("disabled",!1);$("#delete-template").prop("disabled",!1)}):(ContractTemplateManagementNS.ContractTemplateId="",ContractEditorManagementNS.TemplateName="",$("#edit-template").prop("disabled",!0),$("#delete-template").prop("disabled",!0))};ContractTemplateManagementNS.addTemplate=function(){ContractTemplateManagementNS.ContractTemplateId="";ContractEditorManagementNS.ContractTemplateId="";ContractEditorManagementNS.ControlValue="new";$('#templateTabs a[href="#contract-editor"]').tab("show");ContractEditorManagementNS.tabShow();$("#edit-template").prop("disabled",!0);$("#delete-template").prop("disabled",!0)};ContractTemplateManagementNS.editTemplate=function(){ContractEditorManagementNS.ControlValue="existing";$('#templateTabs a[href="#contract-editor"]').tab("show");ContractEditorManagementNS.tabShow();$("#edit-template").prop("disabled",!0);$("#delete-template").prop("disabled",!0)};ContractTemplateManagementNS.deleteTemplate=function(){confirm("Are you sure you want to delete this item?")&&$.ajax({url:"api/contract/deleteContractTemplate/"+ContractTemplateManagementNS.ContractTemplateId,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#contract-template-grid").data("kendoGrid").dataSource.read(),$("#edit-template").prop("disabled",!0),$("#delete-template").prop("disabled",!0),toastr.success("Template successfully deleted!")):toastr.error("Error deleting template!")},error:function(){toastr.error("Something went wrong with the request!")}})};ContractWizardNS={};ContractWizardNS.ContractId=null;ContractWizardNS.VendorId=null;ContractWizardNS.initializeWizard=function(n,t,r){ContractWizardNS.ContractId=t;ContractWizardNS.VendorId=n;$.ajax({url:"contract/ContractWizard",success:function(n){var t=$("#contract-wizard");if(t.empty(),t.html(n).css("display","block"),$("#main-content").css("display","none"),ContractWizardNS.showPartialPage(r),$("#wizard").smartWizard({onLeaveStep:leaveAStepCallback,onFinish:onFinishCallback}),$("#wizard").smartWizard("goToStep",r),r!=1)for(i=1;i<r;i++)$("#wizard").smartWizard("enableStep",i)}});ContractWizardNS.initializeControl()};ContractWizardNS.initializeControl=function(){$("#divExit").css("display","block");$(".buttonExit").click(function(n){n.preventDefault();$("#contract-wizard").css("display","none");$("#main-content").css("display","block");$("#divExit").css("display","none")})};ContractWizardNS.showPartialPage=function(n){var t="",i="",r="";n==1?(t="contract/ContractGeneralInfo",i="#step-1",r="?vendorId="+ContractWizardNS.VendorId+"&contractId="+ContractWizardNS.ContractId):n==2?(t="contract/ContractEditor",i="#step-2",r="?contractId="+ContractWizardNS.ContractId):n==3?(t="contract/ContractProduct",i="#step-3",r="?contractId="+ContractWizardNS.ContractId):n==4&&(t="contract/ContractApproval",i="#step-4",r="?contractId="+ContractWizardNS.ContractId);$.ajax({url:t+r,success:function(n){$(i).html(n)}})};EmailManagementNS={};EmailManagementNS.EmailTemplateId=null;EmailManagementNS.init=function(){$("h3#page-title").text("Email Management");EmailManagementNS.populateEmailTemplates()};EmailManagementNS.populateEmailTemplates=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/emailtemplate/emailTemplates",dataType:"json"}},batch:!0,pageSize:10,schema:{model:{id:"emailTemplateId",fields:{emailTemplateId:{editable:!1,type:"guid"},title:{validation:{required:!0}},subject:{validation:{required:!0}},content:{validation:{required:!0}}}}}});$("#emailTemplate-grid").kendoGrid({dataSource:n,selectable:!0,pageable:!0,columns:[{field:"emailTemplateId",title:"Email Template Id",hidden:!0},{field:"title",title:"Title"},{field:"subject",title:"Subject"},{field:"content",title:"Content"},],scrollable:!1,sortable:!0,change:EmailManagementNS.onChange,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};EmailManagementNS.onChange=function(){var n=this;n.select().length>=1?n.select().each(function(){var t=n.dataItem($(this));EmailManagementNS.EmailTemplateId=t.emailTemplateId;$("#emailTemplate-edit-title").val(t.title);$("#emailTemplate-edit-subject").val(t.subject);$("#emailTemplate-edit-content").val(t.content);$("#edit-emailTemplate-popup").prop("disabled",!1);$("#delete-emailTemplate-popup").prop("disabled",!1)}):(EmailManagementNS.EmailTemplateId=null,$("#emailTemplate-edit-title").val(null),$("#emailTemplate-edit-subject").val(null),$("#emailTemplate-edit-content").val(null),$("#edit-emailTemplate-popup").prop("disabled",!0),$("#delete-emailTemplate-popup").prop("disabled",!0))};countryList=[{text:"Afghanistan",value:"Afghanistan"},{text:"Albania",value:"Albania"},{text:"Algeria",value:"Algeria"},{text:"Andorra",value:"Andorra"},{text:"Angola",value:"Angola"},{text:"Anguilla",value:"Anguilla"},{text:"Antigua & Barbuda",value:"Antigua & Barbuda"},{text:"Argentina",value:"Argentina"},{text:"Armenia",value:"Armenia"},{text:"Australia",value:"Australia"},{text:"Austria",value:"Austria"},{text:"Azerbaijan",value:"Azerbaijan"},{text:"Bahamas",value:"Bahamas"},{text:"Bahrain",value:"Bahrain"},{text:"Bangladesh",value:"Bangladesh"},{text:"Barbados",value:"Barbados"},{text:"Belarus",value:"Belarus"},{text:"Belgium",value:"Belgium"},{text:"Belize",value:"Belize"},{text:"Benin",value:"Benin"},{text:"Bermuda",value:"Bermuda"},{text:"Bhutan",value:"Bhutan"},{text:"Bolivia",value:"Bolivia"},{text:"Bosnia & Herzegovina",value:"Bosnia & Herzegovina"},{text:"Botswana",value:"Botswana"},{text:"Brazil",value:"Brazil"},{text:"Brunei Darussalam",value:"Brunei Darussalam"},{text:"Bulgaria",value:"Bulgaria"},{text:"Burkina Faso",value:"Burkina Faso"},{text:"Myanmar/Burma",value:"Myanmar/Burma"},{text:"Burundi",value:"Burundi"},{text:"Cambodia",value:"Cambodia"},{text:"Cameroon",value:"Cameroon"},{text:"Canada",value:"Canada"},{text:"Cape Verde",value:"Cape Verde"},{text:"Cayman Islands",value:"Cayman Islands"},{text:"Central African Republic",value:"Central African Republic"},{text:"Chad",value:"Chad"},{text:"Chile",value:"Chile"},{text:"China",value:"China"},{text:"Colombia",value:"Colombia"},{text:"Comoros",value:"Comoros"},{text:"Congo",value:"Congo"},{text:"Costa Rica",value:"Costa Rica"},{text:"Croatia",value:"Croatia"},{text:"Cuba",value:"Cuba"},{text:"Cyprus",value:"Cyprus"},{text:"Czech Republic",value:"Czech Republic"},{text:"Democratic Republic of the Congo",value:"Democratic Republic of the Congo"},{text:"Denmark",value:"Denmark"},{text:"Djibouti",value:"Djibouti"},{text:"Dominica",value:"Dominica"},{text:"Dominican Republic",value:"Dominican Republic"},{text:"Ecuador",value:"Ecuador"},{text:"Egypt",value:"Egypt"},{text:"El Salvador",value:"El Salvador"},{text:"Equatorial Guinea",value:"Equatorial Guinea"},{text:"Eritrea",value:"Eritrea"},{text:"Estonia",value:"Estonia"},{text:"Ethiopia",value:"Ethiopia"},{text:"Fiji",value:"Fiji"},{text:"Finland",value:"Finland"},{text:"France",value:"France"},{text:"French Guiana",value:"French Guiana"},{text:"Gabon",value:"Gabon"},{text:"Gambia",value:"Gambia"},{text:"Georgia",value:"Georgia"},{text:"Germany",value:"Germany"},{text:"Ghana",value:"Ghana"},{text:"Great Britain",value:"Great Britain"},{text:"Greece",value:"Greece"},{text:"Grenada",value:"Grenada"},{text:"Guadeloupe",value:"Guadeloupe"},{text:"Guatemala",value:"Guatemala"},{text:"Guinea",value:"Guinea"},{text:"Guinea-Bissau",value:"Guinea-Bissau"},{text:"Guyana",value:"Guyana"},{text:"Haiti",value:"Haiti"},{text:"Honduras",value:"Honduras"},{text:"Hungary",value:"Hungary"},{text:"Iceland",value:"Iceland"},{text:"India",value:"India"},{text:"Indonesia",value:"Indonesia"},{text:"Iran",value:"Iran"},{text:"Iraq",value:"Iraq"},{text:"Israel and the Occupied Territories",value:"Israel and the Occupied Territories"},{text:"Italy",value:"Italy"},{text:"Ivory Coast (Cote d'Ivoire)",value:"Ivory Coast (Cote d'Ivoire)"},{text:"Jamaica",value:"Jamaica"},{text:"Japan",value:"Japan"},{text:"Jordan",value:"Jordan"},{text:"Kazakhstan",value:"Kazakhstan"},{text:"Kenya",value:"Kenya"},{text:"Kosovo",value:"Kosovo"},{text:"Kuwait",value:"Kuwait"},{text:"Kyrgyz Republic (Kyrgyzstan)",value:"Kyrgyz Republic (Kyrgyzstan)"},{text:"Laos",value:"Laos"},{text:"Latvia",value:"Latvia"},{text:"Lebanon",value:"Lebanon"},{text:"Lesotho",value:"Lesotho"},{text:"Liberia",value:"Liberia"},{text:"Libya",value:"Libya"},{text:"Liechtenstein",value:"Liechtenstein"},{text:"Lithuania",value:"Lithuania"},{text:"Luxembourg",value:"Luxembourg"},{text:"Republic of Macedonia",value:"Republic of Macedonia"},{text:"Madagascar",value:"Madagascar"},{text:"Malawi",value:"Malawi"},{text:"Malaysia",value:"Malaysia"},{text:"Maldives",value:"Maldives"},{text:"Mali",value:"Mali"},{text:"Malta",value:"Malta"},{text:"Martinique",value:"Martinique"},{text:"Mauritania",value:"Mauritania"},{text:"Mauritius",value:"Mauritius"},{text:"Mayotte",value:"Mayotte"},{text:"Mexico",value:"Mexico"},{text:"Moldova, Republic of Monaco",value:"Moldova, Republic of Monaco"},{text:"Mongolia",value:"Mongolia"},{text:"Montenegro",value:"Montenegro"},{text:"Montserrat",value:"Montserrat"},{text:"Morocco",value:"Morocco"},{text:"Mozambique",value:"Mozambique"},{text:"Namibia",value:"Namibia"},{text:"Nepal",value:"Nepal"},{text:"Netherlands",value:"Netherlands"},{text:"New Zealand",value:"New Zealand"},{text:"Nicaragua",value:"Nicaragua"},{text:"Niger",value:"Niger"},{text:"Nigeria",value:"Nigeria"},{text:"Korea, Democratic Republic of (North Korea)",value:"Korea, Democratic Republic of (North Korea)"},{text:"Norway",value:"Norway"},{text:"Oman",value:"Oman"},{text:"Pacific Islands",value:"Pacific Islands"},{text:"Pakistan",value:"Pakistan"},{text:"Panama",value:"Panama"},{text:"Papua New Guinea",value:"Papua New Guinea"},{text:"Paraguay",value:"Paraguay"},{text:"Peru",value:"Peru"},{text:"Portugal",value:"Portugal"},{text:"Philippines",value:"Philippines"},{text:"Poland",value:"Poland"},{text:"Puerto Rico",value:"Puerto Rico"},{text:"Qatar",value:"Qatar"},{text:"Reunion",value:"Reunion"},{text:"Romania",value:"Romania"},{text:"Russian Federation",value:"Russian Federation"},{text:"Rwanda",value:"Rwanda"},{text:"Saint Kitts and Nevis",value:"Saint Kitts and Nevis"},{text:"Saint Lucia",value:"Saint Lucia"},{text:"Saint Vincent's & Grenadines",value:"Saint Vincent's & Grenadines"},{text:"Samoa",value:"Samoa"},{text:"Sao Tome and Principe",value:"Sao Tome and Principe"},{text:"Saudi Arabia",value:"Saudi Arabia"},{text:"Senegal",value:"Senegal"},{text:"Serbia",value:"Serbia"},{text:"Seychelles",value:"Seychelles"},{text:"Sierra Leone",value:"Sierra Leone"},{text:"Singapore",value:"Singapore"},{text:"Slovak Republic (Slovakia)",value:"Slovak Republic (Slovakia)"},{text:"Slovenia",value:"Slovenia"},{text:"Solomon Islands",value:"Solomon Islands"},{text:"Somalia",value:"Somalia"},{text:"South Africa",value:"South Africa"},{text:"Korea, Republic of (South Korea)",value:"Korea, Republic of (South Korea)"},{text:"South Sudan",value:"South Sudan"},{text:"Spain",value:"Spain"},{text:"Sri Lanka",value:"Sri Lanka"},{text:"Sudan",value:"Sudan"},{text:"Suriname",value:"Suriname"},{text:"Swaziland",value:"Swaziland"},{text:"Sweden",value:"Sweden"},{text:"Switzerland",value:"Switzerland"},{text:"Syria",value:"Syria"},{text:"Tajikistan",value:"Tajikistan"},{text:"Tanzania",value:"Tanzania"},{text:"Thailand",value:"Thailand"},{text:"Timor Leste",value:"Timor Leste"},{text:"Togo",value:"Togo"},{text:"Trinidad & Tobago",value:"Trinidad & Tobago"},{text:"Tunisia",value:"Tunisia"},{text:"Turkey",value:"Turkey"},{text:"Turkmenistan",value:"Turkmenistan"},{text:"Turks & Caicos Islands",value:"Turks & Caicos Islands"},{text:"Uganda",value:"Uganda"},{text:"Ukraine",value:"Ukraine"},{text:"United Arab Emirates",value:"United Arab Emirates"},{text:"United States of America (USA)",value:"United States of America (USA)"},{text:"Uruguay",value:"Uruguay"},{text:"Uzbekistan",value:"Uzbekistan"},{text:"Venezuela",value:"Venezuela"},{text:"Vietnam",value:"Vietnam"},{text:"Virgin Islands (UK)",value:"Virgin Islands (UK)"},{text:"Virgin Islands (US)",value:"Virgin Islands (US)"},{text:"Yemen",value:"Yemen"},{text:"Zambia",value:"Zambia"},{text:"Zimbabwe",value:"Zimbabwe"}];ProductManagementNS={};ProductManagementNS.ExcelURL=null;ProductManagementNS.ProductMatrixId=null;ProductManagementNS.init=function(){ProductManagementNS.hookup();$("h3#page-title").text("Product Management")};ProductManagementNS.onChange=function(){var n=this;n.select().length>=1?n.select().each(function(){var t=n.dataItem($(this));ProductManagementNS.ProductMatrixId=t.productMatrixId;$("#product-edit-code").val(t.code);$("#product-edit-name").val(t.name);$("#product-edit-productType").data("kendoComboBox").value(t.productTypeId);$("#product-edit-productLicenseMetric").data("kendoComboBox").value(t.productLicenseMetricId);$("#product-edit-productLicenseTerm").data("kendoComboBox").value(t.productLicenseTermId);$("#product-edit-productUnitPrice").data("kendoNumericTextBox").value(t.unitPrice);$("#product-edit-productDiscount").data("kendoNumericTextBox").value(t.discount);$("#edit-product-popup").prop("disabled",!1);$("#delete-product-popup").prop("disabled",!1)}):(ProductManagementNS.ProductMatrixId=null,$("#product-edit-code").val(null),$("#product-edit-name").val(null),$("#product-edit-productType").val(null),$("#product-edit-productLicenseMetric").val(null),$("#product-edit-productLicenseTerm").val(null),$("#product-edit-productUnitPrice").val(null),$("#product-edit-productDiscount").val(null),$("#edit-product-popup").prop("disabled",!0),$("#delete-product-popup").prop("disabled",!0))};ProductManagementNS.populateProduct=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/product/productMatrixList",dataType:"json"}},batch:!0,pageSize:10,schema:{model:{id:"productMatrixId",fields:{productMatrixId:{editable:!1,type:"guid"},code:{validation:{required:!0}},name:{validation:{required:!0}},productTypeName:{validation:{required:!0}}}}}});$("#product-grid").kendoGrid({dataSource:n,selectable:!0,pageable:!0,columns:[{field:"productMatrixId",title:"ProductMatrixId",hidden:!0},{field:"code",title:"Product Code"},{field:"name",title:"Name"},{field:"productTypeName",title:"Type"},{field:"productLicenseMetricName",title:"License Metric"},{field:"productLicenseTermName",title:"License Term"},{field:"unitPrice",title:"Unit Price"},{field:"discount",title:"Discount %"},{field:"modifiedBy",title:"Modified By"},{field:"modifiedDate",title:"Modified Date",filterable:!1,template:'#= kendo.toString(kendo.parseDate(modifiedDate), "MM/dd/yyyy")#'},],scrollable:!1,sortable:!0,change:ProductManagementNS.onChange,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};ProductManagementNS.initEditor=function(){$(".productTypeComboBox").kendoComboBox({dataTextField:"name",dataValueField:"productTypeId",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:{transport:{read:{dataType:"json",url:"api/product/productTypeList"}}},suggest:!0});$(".productLicenseMetricComboBox").kendoComboBox({dataTextField:"name",dataValueField:"productLicenseMetricId",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:{transport:{read:{dataType:"json",url:"api/product/productLicenseMetric"}}},suggest:!0});$(".productLicenseTermComboBox").kendoComboBox({dataTextField:"name",dataValueField:"productLicenseTermId",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:{transport:{read:{dataType:"json",url:"api/product/productLicenseTerm"}}},suggest:!0});$(".productUnitPriceNumericTextBox").kendoNumericTextBox();$(".productDiscountNumericTextBox").kendoNumericTextBox()};ProductManagementNS.hookup=function(){var n=$("#form-product-create").kendoValidator().data("kendoValidator"),t=$("#form-product-edit").kendoValidator().data("kendoValidator");ProductManagementNS.initEditor();$("#add-product-popup").click(function(){$("#product-add-code").val(null);$("#product-add-name").val(null);$("#product-add-productType").data("kendoComboBox").value("");$("#product-add-productLicenseMetric").data("kendoComboBox").value("");$("#product-add-productLicenseTerm").data("kendoComboBox").value("");$("#product-add-productUnitPrice").data("kendoNumericTextBox").value("");$("#product-add-productDiscount").data("kendoNumericTextBox").value("");n.hideMessages()});$("#edit-product-popup").on("hidden.bs.modal",function(){t.hideMessages();n.hideMessages()});$("#edit-product-dismiss").click(function(){var i=$("#product-grid").data("kendoGrid");i.clearSelection();t.hideMessages();n.hideMessages()});$("form#form-product-create").submit(function(t){if(t.preventDefault(),n.validate()){var i={};i.ProductMatrixId=null;i.Name=$("#product-add-name").val();i.Code=$("#product-add-code").val();i.ProductTypeId=$("#product-add-productType").val().toLowerCase();i.ProductLicenseMetricId=$("#product-add-productLicenseMetric").val().toLowerCase();i.ProductLicenseTermId=$("#product-add-productLicenseTerm").val().toLowerCase();i.UnitPrice=$("#product-add-productUnitPrice").data("kendoNumericTextBox").value();i.Discount=$("#product-add-productDiscount").data("kendoNumericTextBox").value();ProductManagementNS.createProduct(i)}});$("form#form-product-edit").submit(function(n){if(n.preventDefault(),t.validate()){var i={};i.ProductMatrixId=ProductManagementNS.ProductMatrixId;i.Code=$("#product-edit-code").val();i.Name=$("#product-edit-name").val();i.ProductTypeId=$("#product-edit-productType").val().toLowerCase();i.ProductLicenseMetricId=$("#product-edit-productLicenseMetric").val().toLowerCase();i.ProductLicenseTermId=$("#product-edit-productLicenseTerm").val().toLowerCase();i.UnitPrice=$("#product-edit-productUnitPrice").data("kendoNumericTextBox").value();i.Discount=$("#product-edit-productDiscount").data("kendoNumericTextBox").value();ProductManagementNS.updateProduct(i)}});$("#delete-product").click(function(){ProductManagementNS.deleteProduct()});ProductManagementNS.populateProduct()};ProductManagementNS.createProduct=function(n){$.ajax({url:"api/product/productMatrix",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#save-product-dismiss").trigger("click"),$("#product-grid").data("kendoGrid").dataSource.read(),$("#product-add-code").val(null),$("#product-add-name").val(null),$("#product-add-productType").data("kendoComboBox").value(""),$("#product-add-productLicenseMetric").data("kendoComboBox").value(""),$("#product-add-productLicenseTerm").data("kendoComboBox").value(""),$("#product-add-productUnitPrice").data("kendoNumericTextBox").value(""),$("#product-add-productDiscount").data("kendoNumericTextBox").value(""),$("#edit-product-popup").prop("disabled",!0),$("#delete-product-popup").prop("disabled",!0),toastr.success("Product successfully added")):toastr.error("Product already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};ProductManagementNS.updateProduct=function(n){$.ajax({url:"api/product/productMatrix/"+ProductManagementNS.ProductMatrixId,type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#edit-product-dismiss").trigger("click"),$("#product-grid").data("kendoGrid").dataSource.read(),$("#product-add-code").val(null),$("#product-add-name").val(null),$("#product-add-productType").data("kendoComboBox").value(""),$("#product-add-productLicenseMetric").data("kendoComboBox").value(""),$("#product-add-productLicenseTerm").data("kendoComboBox").value(""),$("#product-add-productUnitPrice").data("kendoNumericTextBox").value(""),$("#product-add-productDiscount").data("kendoNumericTextBox").value(""),$("#edit-product-popup").prop("disabled",!0),$("#delete-product-popup").prop("disabled",!0),toastr.success("Product successfully updated!")):toastr.error("Product already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};ProductManagementNS.deleteProduct=function(){$.ajax({url:"api/product/productMatrix/"+ProductManagementNS.ProductMatrixId,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#delete-product-dismiss").trigger("click"),$("#product-grid").data("kendoGrid").dataSource.read(),$("#edit-product-popup").prop("disabled",!0),$("#delete-product-popup").prop("disabled",!0),toastr.success("Product successfully deleted!")):toastr.error("Error deleting product!")},error:function(){toastr.error("Something went wrong with the request!")}})};ProductManagementNS.uploadProduct=function(){var n=new FormData,i=$("#upload-product-file").get(0),t=i.files,r;n.append(t[0].name,t[0]);r=$("#upload-product-file");$.ajax({type:"POST",url:"api/product/productUpload",beforeSend:function(n){n.setRequestHeader("XSRF-TOKEN",$('input:hidden[name="__RequestVerificationToken"]').val())},data:n,contentType:!1,processData:!1,success:function(n){n.result!=!1||n!="False"||n!="false"?n.isUploaded===!0||n.isUploaded==="True"||n.isUploaded==="true"?(toastr.success(n.result),$("#product-grid").data("kendoGrid").dataSource.read()):toastr.error(n.result):toastr.error("Something's wrong with the excel sheet you upload.");$("#upload-product-file").val("");$("#product-upload-popup").modal("toggle")},error:function(){toastr.error("Something's wrong with the excel sheet you upload.")}})};AccessManagementNS={};AccessManagementNS.ExcelURL=null;AccessManagementNS.AccessId=null;AccessManagementNS.init=function(){AccessManagementNS.hookup()};AccessManagementNS.onChange=function(){var n=this;n.select().length>=1?n.select().each(function(){var t=n.dataItem($(this));AccessManagementNS.AccessId=t.accessId;$("#access-edit-name").val(t.name);$("#access-edit-description").val(t.description);$("#access-edit-category").val(t.category);$("#edit-access-popup").prop("disabled",!1);$("#delete-access-popup").prop("disabled",!1)}):(AccessManagementNS.AccessId=null,$("#access-edit-name").val(null),$("#access-edit-description").val(null),$("#access-edit-category").val(null),$("#edit-access-popup").prop("disabled",!0),$("#delete-access-popup").prop("disabled",!0))};AccessManagementNS.populateAccess=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/access/list",dataType:"json"}},batch:!0,pageSize:10,schema:{model:{id:"accessId",fields:{accessId:{editable:!1,type:"guid"},name:{validation:{required:!0}},description:{validation:{required:!0}},category:{validation:{required:!0}},createdOn:{validation:{required:!0},hidden:!0}}}}});$("#access-grid").kendoGrid({dataSource:n,selectable:!0,pageable:!0,columns:[{field:"accessId",title:"AccessId",hidden:!0},{field:"name",title:"Name",width:500},{field:"description",title:"Description",width:400},{field:"category",title:"Category"},{field:"createdOn",title:"Created On",hidden:!0},],scrollable:!1,sortable:!0,change:AccessManagementNS.onChange,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};AccessManagementNS.hookup=function(){var n=$("#form-access-create").kendoValidator().data("kendoValidator"),i=$(".status"),t=$("#form-access-edit").kendoValidator().data("kendoValidator"),i=$(".status");$("#add-access-popup").click(function(){$("#access-add-name").val(null);$("#access-add-description").val(null);$("#access-add-category").val(null);n.hideMessages()});$("#edit-access-popup").on("hidden.bs.modal",function(){t.hideMessages();n.hideMessages()});$("#access-edit-popup").on("hidden.bs.modal",function(){t.hideMessages();n.hideMessages()});$("#edit-access-dismiss").click(function(){var i=$("#access-grid").data("kendoGrid");i.clearSelection();t.hideMessages();n.hideMessages()});$("#access-edit-popup").on("hidden.bs.modal",function(){var i=$("#access-grid").data("kendoGrid");i.clearSelection();t.hideMessages();n.hideMessages()});$("form#form-access-create").submit(function(t){if(t.preventDefault(),n.validate()){var i={};i.Description=$("#access-add-description").val();i.Category=$("#access-add-category").val();i.AccessId=null;i.Name=$("#access-add-name").val();i.Name!=null&&i.Name.length>0?AccessManagementNS.createAccess(i):i.OrderNo==null?toastr.error("Order Number is required"):toastr.error("Name is required")}});$("form#form-access-edit").submit(function(n){if(n.preventDefault(),t.validate()){var i={};i.Description=$("#access-edit-description").val();i.Category=$("#access-edit-category").val();i.AccessId=AccessManagementNS.AccessId;i.Name=$("#access-edit-name").val();i.Name!=null&&i.Name.length>0?AccessManagementNS.updateAccess(i):toastr.error("Name is required")}});$("#delete-access").click(function(){AccessManagementNS.deleteAccess()});AccessManagementNS.populateAccess()};AccessManagementNS.createAccess=function(n){$.ajax({url:"api/access/",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#save-access-dismiss").trigger("click"),$("#access-grid").data("kendoGrid").dataSource.read(),AccessManagementNS.selectFirstItem(),$("#access-add-name").val(null),$("#access-add-description").val(null),$("#access-add-category").val(null),toastr.success("Access successfully added")):toastr.error("Access already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};AccessManagementNS.updateAccess=function(n){$.ajax({url:"api/access/"+AccessManagementNS.AccessId,type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#edit-access-dismiss").trigger("click"),$("#access-grid").data("kendoGrid").dataSource.read(),$("#access-add-name").val(null),$("#access-add-description").val(null),$("#access-add-category").val(null),$("#edit-access-popup").prop("disabled",!0),$("#delete-access-popup").prop("disabled",!0),toastr.success("Access successfully updated!")):toastr.error("Access already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};AccessManagementNS.deleteAccess=function(){$.ajax({url:"api/access/"+AccessManagementNS.AccessId,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#delete-access-dismiss").trigger("click"),$("#access-grid").data("kendoGrid").dataSource.read(),$("#access-edit-name").val(null),$("#access-edit-orderNo").val(null),$("#edit-access-popup").prop("disabled",!0),$("#delete-access-popup").prop("disabled",!0),toastr.success("Access successfully deleted!")):toastr.error("Error deleting access!")},error:function(){toastr.error("Something went wrong with the request!")}})};AccessManagementNS.selectFirstItem=function(){var n=$("#access-grid").data("kendoGrid");n.one("dataBound",function(t){setTimeout(function(){var i=t.sender.tbody.find("tr:first");n.select(i);i.trigger("click")},2e3)});n.dataSource.page(1)};RoleManagementNS={};RoleManagementNS.ExcelURL=null;RoleManagementNS.RoleId=null;RoleManagementNS.init=function(){RoleManagementNS.hookup()};RoleManagementNS.onChange=function(){var n=this;n.select().length>=1?n.select().each(function(){var t=n.dataItem($(this));RoleManagementNS.RoleId=t.roleId;$("#role-edit-name").val(t.name);$("#role-edit-description").val(t.description);document.getElementById("role-edit-isactive").checked=t.status==1?!0:!1;$("#edit-role-popup").prop("disabled",!1);$("#delete-role-popup").prop("disabled",!1)}):(RoleManagementNS.RoleId=null,$("#role-edit-name").val(null),$("#role-edit-description").val(null),$("#edit-role-popup").prop("disabled",!0),$("#delete-role-popup").prop("disabled",!0))};RoleManagementNS.populateRole=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/role/list",dataType:"json"}},batch:!0,pageSize:10,schema:{model:{id:"RoleId",fields:{roleId:{editable:!1,type:"guid"},name:{validation:{required:!0}},description:{validation:{required:!0},hidden:!0},createdOn:{validation:{required:!0}}}}}});$("#role-grid").kendoGrid({dataSource:n,selectable:!0,pageable:!0,columns:[{field:"roleId",title:"RoleId",hidden:!0},{field:"name",title:"Name",width:500},{field:"description",title:"Description",width:400},{field:"createdOn",title:"Created On",hidden:!0},],scrollable:!1,sortable:!0,change:RoleManagementNS.onChange,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};RoleManagementNS.hookup=function(){var n=$("#form-role-create").kendoValidator().data("kendoValidator"),i=$(".status"),t=$("#form-role-edit").kendoValidator().data("kendoValidator"),i=$(".status");document.getElementById("role-add-isactive").checked=!0;$("#edit-role-dismiss").click(function(){var n=$("#role-grid").data("kendoGrid");n.clearSelection()});$("#role-edit-popup").on("hidden.bs.modal",function(){var n=$("#role-grid").data("kendoGrid");n.clearSelection()});$("#add-role-popup").click(function(){n.hideMessages();RoleManagementNS.RoleId=null;document.getElementById("role-add-isactive").checked=!0;$("#role-add-description").val(null);$("#role-add-name").val(null);RoleManagementNS.populateAddAccessMappings()});$("#edit-role-popup").click(function(){t.hideMessages();RoleManagementNS.populateEditAccessMappings()});$("form#form-role-create").submit(function(t){var i,f,u,r;if(t.preventDefault(),n.validate()){for(i={},i.RoleId=RoleManagementNS.RoleId,i.Status=$("#role-add-isactive").is(":checked")?1:0,i.Description=$("#role-add-description").val(),i.Name=$("#role-add-name").val(),f=[],u=$("#add-selected-access-mapping-grid").data().kendoGrid.dataSource,r=0;r<u._data.length;r++)f.push({AccessId:u._data[r].accessId,Name:u._data[r].name,Category:u._data[r].category});i.AccessMappingItems=f;i.Name!=null&&i.Name.length>0?RoleManagementNS.createRole(i):toastr.error("Name is required")}});$("form#form-role-edit").submit(function(n){var i,f,u,r;if(n.preventDefault(),t.validate()){for(i={},i.RoleId=RoleManagementNS.RoleId,i.Status=$("#role-edit-isactive").is(":checked")?1:0,i.Description=$("#role-edit-description").val(),i.Name=$("#role-edit-name").val(),f=[],u=$("#edit-selected-access-mapping-grid").data().kendoGrid.dataSource,r=0;r<u._data.length;r++)f.push({AccessId:u._data[r].accessId,Name:u._data[r].name,Category:u._data[r].category});i.AccessMappingItems=f;i.Name!=null&&i.Name.length>0?RoleManagementNS.updateRole(i):toastr.error("Name is required")}});$("#delete-role").click(function(){RoleManagementNS.deleteRole()});RoleManagementNS.populateRole()};RoleManagementNS.createRole=function(n){$.ajax({url:"api/role/",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#save-role-dismiss").trigger("click"),$("#role-grid").data("kendoGrid").dataSource.read(),RoleManagementNS.selectFirstItem(),$("#role-add-description").val(null),$("#role-add-name").val(null),toastr.success("Role successfully added")):toastr.error("Role already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};RoleManagementNS.updateRole=function(n){$.ajax({url:"api/role/"+RoleManagementNS.RoleId,type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#edit-role-dismiss").trigger("click"),$("#role-grid").data("kendoGrid").dataSource.read(),$("#edit-role-popup").prop("disabled",!0),$("#delete-role-popup").prop("disabled",!0),toastr.success("Role successfully updated!")):toastr.error("Role already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};RoleManagementNS.deleteRole=function(){$.ajax({url:"api/role/"+RoleManagementNS.RoleId,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){$("#delete-role-dismiss").trigger("click");$("#role-grid").data("kendoGrid").dataSource.read();n!=!1&&n!="false"?($("#role-edit-description").val(null),$("#role-edit-name").val(null),$("#edit-role-popup").prop("disabled",!0),$("#delete-role-popup").prop("disabled",!0),toastr.success("Role successfully deleted!")):toastr.error("Error in deleting role!")},error:function(){toastr.error("Something went wrong with the request!")}})};RoleManagementNS.selectFirstItem=function(){var n=$("#role-grid").data("kendoGrid");n.one("dataBound",function(t){setTimeout(function(){var i=t.sender.tbody.find("tr:first");n.select(i);i.trigger("click")},2e3)});n.dataSource.page(1)};RoleManagementNS.populateAddAccessMappings=function(){$.ajax({url:"api/access/availableMappingList",type:"GET"}).done(function(n){RoleManagementNS.initializeAddAccessMappingGrid(n)}).fail(function(){toastr.error("Something went wrong with the request!")})};RoleManagementNS.populateEditAccessMappings=function(){RoleManagementNS.initializeEditAccessMappingGrid()};RoleManagementNS.initializeAddAccessMappingGrid=function(n){var i=$("#add-available-access-mapping-grid").kendoGrid({dataSource:n,columns:[{field:"accessId",title:"AccessId",hidden:!0},{field:"name",title:"Name",width:"50px"},{field:"category",title:"Category",width:"50px"},],selectable:"row",filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},scrollable:!0,sortable:!0}).data("kendoGrid"),t;i.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 100px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(n){var t=i.dataSource.skip(),f=n.oldIndex+t,u=n.newIndex+t,e=i.dataSource.data(),r=i.dataSource.getByUid(n.item.data("uid"));i.dataSource.remove(r);i.dataSource.insert(u,r)}});t=$("#add-selected-access-mapping-grid").kendoGrid({dataSource:[],columns:[{field:"accessId",title:"AccessId",hidden:!0},{field:"name",title:"Name",width:"50px"},{field:"category",title:"Category",width:"50px"},],selectable:"row",filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},scrollable:!0,sortable:!0}).data("kendoGrid");t.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 200px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(n){var i=t.dataSource.skip(),f=n.oldIndex+i,u=n.newIndex+i,e=t.dataSource.data(),r=t.dataSource.getByUid(n.item.data("uid"));t.dataSource.remove(r);t.dataSource.insert(u,r)}});$("#add-mapped-access-to-available").click(function(n){var t=$("#add-selected-access-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&currentSelection.each(function(n,i){var r=t.dataItem(i),u=$("#add-available-access-mapping-grid").data().kendoGrid.dataSource;u.add({accessId:r.accessId?r.accessId:null,name:r.name?r.name:null,category:r.category?r.category:null});t.dataSource.remove(r)});n.preventDefault()});$("#add-available-access-to-selected").click(function(n){var t=$("#add-available-access-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&t.select().each(function(){var n=t.dataItem($(this)),i=$("#add-selected-access-mapping-grid").data().kendoGrid.dataSource;i.add({accessId:n.accessId?n.accessId:null,name:n.name?n.name:null,category:n.category?n.category:null});t.dataSource.remove(n)});n.preventDefault()})};RoleManagementNS.initializeEditAccessMappingGrid=function(){var t=$("#edit-available-access-mapping-grid").kendoGrid({dataSource:{transport:{read:{url:"api/role/unmapped/"+RoleManagementNS.RoleId,dataType:"json"}}},columns:[{field:"accessId",title:"AccessId",hidden:!0},{field:"name",title:"Name",width:"50px"},{field:"category",title:"Category",width:"50px"},],filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},selectable:"row",sortable:!0}).data("kendoGrid"),n;t.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 100px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(n){var i=t.dataSource.skip(),f=n.oldIndex+i,u=n.newIndex+i,e=t.dataSource.data(),r=t.dataSource.getByUid(n.item.data("uid"));t.dataSource.remove(r);t.dataSource.insert(u,r)}});n=$("#edit-selected-access-mapping-grid").kendoGrid({dataSource:{transport:{read:{url:"api/role/mapped/"+RoleManagementNS.RoleId,dataType:"json"}}},columns:[{field:"accessId",title:"AccessId",hidden:!0},{field:"name",title:"Name",width:"50px"},{field:"category",title:"Category",width:"50px"},],selectable:"row",selectable:"row",filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},scrollable:!0,sortable:!0}).data("kendoGrid");n.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 200px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(t){var i=n.dataSource.skip(),f=t.oldIndex+i,u=t.newIndex+i,e=n.dataSource.data(),r=n.dataSource.getByUid(t.item.data("uid"));n.dataSource.remove(r);n.dataSource.insert(u,r)}});$("#edit-mapped-access-to-available").click(function(n){var t=$("#edit-selected-access-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&currentSelection.each(function(n,i){var r=t.dataItem(i),u=$("#edit-available-access-mapping-grid").data().kendoGrid.dataSource;u.add({accessId:r.accessId,name:r.name,category:r.category});t.dataSource.remove(r)});n.preventDefault()});$("#edit-available-access-to-selected").click(function(n){var t=$("#edit-available-access-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&t.select().each(function(){var n=t.dataItem($(this)),i=$("#edit-selected-access-mapping-grid").data().kendoGrid.dataSource;i.add({accessId:n.accessId?n.accessId:null,name:n.name?n.name:null,category:n.category});t.dataSource.remove(n)});n.preventDefault()})};UserManagementNS={};UserManagementNS.ExcelURL=null;UserManagementNS.UserInfoId=null;UserManagementNS.init=function(){UserManagementNS.hookup();$("h3#page-title").text("User Management");$("#user-edit-country").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:countryList,suggest:!0});$("#user-add-country").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:countryList,suggest:!0})};UserManagementNS.onChange=function(){var n=this;n.select().length>=1?n.select().each(function(){var t=n.dataItem($(this)),i;UserManagementNS.UserInfoId=t.userInfoId;$("#user-edit-firstname").val(t.firstName);$("#user-edit-lastname").val(t.lastName);$("#user-edit-email").val(t.email);$("#user-edit-address").val(t.address);$("#user-edit-companyid").val(t.companyId);$("#user-edit-position").val(t.position);$("#user-edit-contactno").val(t.contactNo);i=$("#user-edit-country").data("kendoComboBox");i.value(t.country);$("#user-edit-timezone").val(t.timezone);document.getElementById("user-edit-isactive").checked=t.status===1?!0:!1;$("#edit-user-popup").prop("disabled",!1);$("#delete-user-popup").prop("disabled",!1)}):(UserManagementNS.UserInfoId=null,$("#user-edit-firstname").val(null),$("#user-edit-lastname").val(null),$("#user-edit-email").val(null),$("#user-edit-address").val(null),$("#user-edit-company").val(null),$("#user-edit-position").val(null),$("#user-edit-contactno").val(null),$("#user-edit-country").val(null),$("#user-edit-timezone").val(null),$("#edit-user-popup").prop("disabled",!0),$("#delete-user-popup").prop("disabled",!0))};UserManagementNS.populateUser=function(){var n=new kendo.data.DataSource({transport:{read:{url:"api/userinfo/list",dataType:"json"}},batch:!0,pageSize:10,schema:{model:{id:"UserInfoId",fields:{userInfoId:{editable:!1,type:"guid"},lastName:{type:"string"},firstName:{type:"string"},email:{type:"string"},position:{type:"string"},contactNo:{type:"string"},country:{type:"string"},status:{type:"int"},address:{type:"string"},position:{type:"string"},companyId:{type:"guid"},timezone:{type:"string"}}}}});$("#user-grid").kendoGrid({dataSource:n,selectable:!0,pageable:!0,columns:[{field:"userInfoId",title:"UserInfoId",hidden:!0},{field:"firstName",title:"First Name"},{field:"lastName",title:"Last Name"},{field:"email",title:"Email"},{field:"position",title:"Position"},{field:"contactNo",title:"Contact Number"}],scrollable:!1,sortable:!0,change:UserManagementNS.onChange,filterable:{extra:!1,operators:{string:{contains:"Contains",eq:"Is equal to"}}},pageable:!0})};UserManagementNS.hookup=function(){var n=$("#form-user-create").kendoValidator().data("kendoValidator"),i=$(".status"),t=$("#form-user-edit").kendoValidator().data("kendoValidator"),i=$(".status");document.getElementById("user-add-isactive").checked=!0;$("#add-user-popup").click(function(){UserManagementNS.populateAddRoleMappings();n.hideMessages();$("#user-add-firstname").val(null);$("#user-add-lastname").val(null);$("#user-add-email").val(null);$("#user-add-address").val(null);$("#user-add-companyid").val($("#user-add-companyid option:first").val());$("#user-add-position").val(null);$("#user-add-contactno").val(null);$("#user-add-country").val(null);$("#user-add-timezone").val(null);document.getElementById("user-add-isactive").checked=!0});$("#edit-user-popup").click(function(){t.hideMessages();UserManagementNS.populateEditRoleMappings()});$("#edit-user-dismiss").click(function(){var n=$("#user-grid").data("kendoGrid");n.clearSelection()});$("#user-edit-popup").on("hidden.bs.modal",function(){var n=$("#user-grid").data("kendoGrid");n.clearSelection()});$("form#form-user-create").submit(function(t){var i,u,f,r;if(t.preventDefault(),n.validate()){for(i={},i.FirstName=$("#user-add-firstname").val(),i.LastName=$("#user-add-lastname").val(),i.Email=$("#user-add-email").val(),i.Address=$("#user-add-address").val(),i.Position=$("#user-add-position").val(),i.CompanyId=$("#user-add-companyid").val(),i.ContactNo=$("#user-add-contactno").val(),i.Country=$("#user-add-country").val(),i.Status=$("#user-add-isactive").is(":checked")?1:0,i.Timezone=null,u=[],f=$("#add-selected-role-mapping-grid").data().kendoGrid.dataSource,r=0;r<f._data.length;r++)u.push({RoleId:f._data[r].roleId,Name:f._data[r].name});i.RoleMappingItems=u;i.FirstName!=null&&i.FirstName.length>0&&u.length>=1&&validateEmail(i.Email)?UserManagementNS.createUser(i):i.LastName==null?toastr.error("Lastname is required"):validateEmail(i.Email)?i.RoleMappingItems.length<1?toastr.error("Role is required"):toastr.error("Firstname is required"):toastr.error("Not a valid email")}});$("form#form-user-edit").submit(function(n){var i,u,f,r;if(n.preventDefault(),t.validate()){for(i={},i.FirstName=$("#user-edit-firstname").val(),i.LastName=$("#user-edit-lastname").val(),i.Email=$("#user-edit-email").val(),i.Address=$("#user-edit-address").val(),i.Position=$("#user-edit-position").val(),i.CompanyId=$("#user-edit-companyid").val(),i.ContactNo=$("#user-edit-contactno").val(),i.Country=$("#user-edit-country").val(),i.Status=$("#user-edit-isactive").is(":checked")?1:0,i.Timezone=null,i.UserInfoId=UserManagementNS.UserInfoId,u=[],f=$("#edit-selected-role-mapping-grid").data().kendoGrid.dataSource,r=0;r<f._data.length;r++)u.push({RoleId:f._data[r].roleId,Name:f._data[r].name});i.RoleMappingItems=u;i.FirstName!=null&&i.FirstName.length>0&&u.length>=1&&validateEmail(i.Email)?UserManagementNS.updateUser(i):i.LastName==null?toastr.error("Lastname is required"):validateEmail(i.Email)?i.RoleMappingItems.length<1?toastr.error("Role is required"):toastr.error("Firstname is required"):toastr.error("Not a valid email")}});$("#delete-user").click(function(){UserManagementNS.deleteUser()});UserManagementNS.populateUser();$.ajax({url:"api/vendor/items",type:"GET",contentType:"application/json; charset=utf-8",success:function(n){for(var t=0;t<n.length;t++)$("#user-edit-companyid").append($("<option><\/option>").attr("value",n[t].vendorId).text(n[t].name)),$("#user-add-companyid").append($("<option><\/option>").attr("value",n[t].vendorId).text(n[t].name))},error:function(){toastr.error("Something went wrong with the request")}})};UserManagementNS.createUser=function(n){$.ajax({url:"api/userinfo/",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#save-user-dismiss").trigger("click"),$("#user-grid").data("kendoGrid").dataSource.read(),UserManagementNS.selectFirstItem(),$("#user-add-firstname").val(null),$("#user-add-lastname").val(null),$("#user-add-email").val(null),$("#user-add-address").val(null),$("#user-add-companyid").val(null),$("#user-add-position").val(null),$("#user-add-contactno").val(null),$("#user-add-country").val(null),$("#user-add-timezone").val(null),document.getElementById("user-edit-isactive").checked=!0,toastr.success("User successfully added")):toastr.error("User already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};UserManagementNS.updateUser=function(n){$.ajax({url:"api/userinfo/"+UserManagementNS.UserInfoId,type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n!=!1&&n!="false"?($("#edit-user-dismiss").trigger("click"),$("#user-grid").data("kendoGrid").dataSource.read(),$("#user-edit-firstname").val(null),$("#user-edit-lastname").val(null),$("#user-edit-email").val(null),$("#user-edit-address").val(null),$("#user-edit-company").val(null),$("#user-edit-position").val(null),$("#user-edit-contactno").val(null),$("#user-edit-country").val(null),$("#user-edit-timezone").val(null),$("#user-edit-companyid").val(null),document.getElementById("user-edit-isactive").checked=!0,$("#edit-user-popup").prop("disabled",!0),$("#delete-user-popup").prop("disabled",!0),toastr.success("User successfully updated!")):toastr.error("User already exist!")},error:function(){toastr.error("Something went wrong with the request!")}})};UserManagementNS.deleteUser=function(){$.ajax({url:"api/userinfo/"+UserManagementNS.UserInfoId,type:"DELETE",contentType:"application/json; charset=utf-8",success:function(n){$("#delete-user-dismiss").trigger("click");n==!1?toastr.success("Error in deleting user"):($("#user-grid").data("kendoGrid").dataSource.read(),$("#user-edit-firstname").val(null),$("#user-edit-lastname").val(null),$("#user-edit-email").val(null),$("#user-edit-address").val(null),$("#user-edit-company").val(null),$("#user-edit-position").val(null),$("#user-edit-contactno").val(null),$("#user-edit-country").val(null),$("#user-edit-timezone").val(null),$("#user-edit-companyid").val(null),$("#edit-user-popup").prop("disabled",!0),$("#delete-user-popup").prop("disabled",!0));toastr.success("User successfully deleted!")},error:function(){toastr.error("Something went wrong with the request!")}})};UserManagementNS.selectFirstItem=function(){var n=$("#user-grid").data("kendoGrid");n.one("dataBound",function(t){setTimeout(function(){var i=t.sender.tbody.find("tr:first");n.select(i);i.trigger("click")},2e3)});n.dataSource.page(1)};UserManagementNS.populateAddRoleMappings=function(){$.ajax({url:"api/role/availableMappingList",type:"GET"}).done(function(n){UserManagementNS.initializeAddRoleMappingGrid(n)}).fail(function(){toastr.error("Something went wrong with the request!")})};UserManagementNS.populateEditRoleMappings=function(){UserManagementNS.initializeEditRoleMappingGrid(null)};UserManagementNS.initializeAddRoleMappingGrid=function(n){var i=$("#add-available-role-mapping-grid").kendoGrid({dataSource:n,columns:[{field:"roleId",title:"RoleId",hidden:!0},{field:"name",title:"Name",width:"50px"},],selectable:"row"}).data("kendoGrid"),t;i.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 100px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(n){var t=i.dataSource.skip(),f=n.oldIndex+t,u=n.newIndex+t,e=i.dataSource.data(),r=i.dataSource.getByUid(n.item.data("uid"));i.dataSource.remove(r);i.dataSource.insert(u,r)}});t=$("#add-selected-role-mapping-grid").kendoGrid({dataSource:[],columns:[{field:"roleId",title:"RoleId",hidden:!0},{field:"name",title:"Name",width:"50px"},],selectable:"row"}).data("kendoGrid");t.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 200px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(n){var i=t.dataSource.skip(),f=n.oldIndex+i,u=n.newIndex+i,e=t.dataSource.data(),r=t.dataSource.getByUid(n.item.data("uid"));t.dataSource.remove(r);t.dataSource.insert(u,r)}});$("#add-mapped-role-to-available").click(function(n){var t=$("#add-selected-role-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&currentSelection.each(function(n,i){var r=t.dataItem(i),u=$("#add-available-role-mapping-grid").data().kendoGrid.dataSource;u.add({roleId:r.roleId?r.roleId:null,name:r.name?r.name:null});t.dataSource.remove(r)});n.preventDefault()});$("#add-available-role-to-selected").click(function(n){var t=$("#add-available-role-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&t.select().each(function(){var n=t.dataItem($(this)),i=$("#add-selected-role-mapping-grid").data().kendoGrid.dataSource;i.add({roleId:n.roleId?n.roleId:null,name:n.name?n.name:null});t.dataSource.remove(n)});n.preventDefault()})};UserManagementNS.initializeEditRoleMappingGrid=function(){var t=$("#edit-available-role-mapping-grid").kendoGrid({dataSource:{transport:{read:{url:"api/userinfo/unmapped/"+UserManagementNS.UserInfoId,dataType:"json"}}},columns:[{field:"roleId",title:"RoleId",hidden:!0},{field:"name",title:"Name",width:"50px"},],selectable:"row"}).data("kendoGrid"),n;t.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 100px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(n){var i=t.dataSource.skip(),f=n.oldIndex+i,u=n.newIndex+i,e=t.dataSource.data(),r=t.dataSource.getByUid(n.item.data("uid"));t.dataSource.remove(r);t.dataSource.insert(u,r)}});n=$("#edit-selected-role-mapping-grid").kendoGrid({dataSource:{transport:{read:{url:"api/userinfo/mapped/"+UserManagementNS.UserInfoId,dataType:"json"}}},columns:[{field:"roleId",title:"RoleId",hidden:!0},{field:"name",title:"Name",width:"50px"},],selectable:"row"}).data("kendoGrid");n.table.kendoSortable({filter:">tbody >tr",hint:function(n){var t=$('<table style="width: 200px;" class="k-grid k-widget"><\/table>');return t.append(n.clone()),t.css("opacity",.7),t},cursor:"move",placeholder:function(){return $('<tr colspan="4" class="placeholder"><\/tr>')},change:function(t){var i=n.dataSource.skip(),f=t.oldIndex+i,u=t.newIndex+i,e=n.dataSource.data(),r=n.dataSource.getByUid(t.item.data("uid"));n.dataSource.remove(r);n.dataSource.insert(u,r)}});$("#edit-mapped-role-to-available").click(function(n){var t=$("#edit-selected-role-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&currentSelection.each(function(n,i){var r=t.dataItem(i),u=$("#edit-available-role-mapping-grid").data().kendoGrid.dataSource;u.add({roleId:r.roleId,name:r.name});t.dataSource.remove(r)});n.preventDefault()});$("#edit-available-role-to-selected").click(function(n){var t=$("#edit-available-role-mapping-grid").data("kendoGrid");currentSelection=t.select();t.select().length>=1&&t.select().each(function(){var n=t.dataItem($(this)),i=$("#edit-selected-role-mapping-grid").data().kendoGrid.dataSource;i.add({roleId:n.roleId?n.roleId:null,name:n.name?n.name:null});t.dataSource.remove(n)});n.preventDefault()})};MyProfile={};MyProfile.UserInfoId=null;MyProfile.Password=null;MyProfile.init=function(n){MyProfile.UserInfoId=n;MyProfile.hookup(n);$("h3#page-title").text("My Profile");$("#user-profile-edit-country").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:countryList,suggest:!0})};MyProfile.hookup=function(n){$.ajax({url:"api/userinfo/profile/"+n,type:"GET",cache:!1,contentType:"application/json; charset=utf-8",success:function(n){$("#user-profile-fullname").html(n.firstName+" "+n.lastName);$("#user-profile-email").html(n.email);$("#user-profile-edit-firstname").val(n.firstName);$("#user-profile-edit-lastname").val(n.lastName);$("#user-profile-edit-address").val(n.address);$("#user-profile-edit-contactno").val(n.contactNo);$("#user-profile-edit-email").val(n.email);var t=$("#user-profile-edit-country").data("kendoComboBox");t.value(n.country);$("#user-profile-edit-position").val(n.position);$("#user-profile-edit-password").val(n.password);MyProfile.Password=n.password;$("#user-profile-edit-password-confirm").val(n.password);$("#user-profile-company").html(n.company!=null?n.company:"Not available");$("#img-profile").attr("src",n.imageURL)},error:function(){toastr.error("Something went wrong with the request!")}});$("#img-profile").change(function(){MyProfile.ReadImage(this)});$("#edit-user-profile").click(function(){var n={};n.Address=$("#user-profile-edit-address").val();n.ContactNo=$("#user-profile-edit-contactno").val();n.ImageUrl=$("#img-profile").attr("src");n.Position=$("#user-profile-edit-position").val();n.Country=$("#user-profile-edit-country").val();n.UserInfoId=MyProfile.UserInfoId;MyProfile.updateProfile(n)});var t=$("#form-update-password").kendoValidator().data("kendoValidator"),i=$(".status");$("form#form-update-password").submit(function(n){if(n.preventDefault(),t.validate()){var i={};i.Password=$("#user-profile-edit-password").val();i.UserInfoId=MyProfile.UserInfoId;MyProfile.updatePassword(i)}})};MyProfile.updateProfile=function(n){$.ajax({type:"PUT",url:"api/userInfo/updateProfile/"+MyProfile.UserInfoId,data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(){toastr.success("Profile updated");$("#display-picture").attr("src",n.ImageUrl)},error:function(){toastr.error("Unable to save user profile.")}})};MyProfile.ReadImage=function(n){var i,r,t;n.files&&n.files[0]&&(i=n.files[0].name.split(".").pop().toLowerCase(),r=["jpg","jpeg","png"].indexOf(i)>-1,r?(t=new FileReader,t.onload=function(n){$("#img-profile").attr("src",n.target.result);var t=n.target.result;imageURL=t.replace(" ","+")},t.readAsDataURL(n.files[0])):(toastr.error("Supported filetypes are only jpg, jpeg and png. Please upload files with these types only"),document.getElementById("picture-file").value=""))};MyProfile.updatePassword=function(n){$("#user-profile-edit-password").val()==$("#user-profile-edit-password-confirm").val()?$("#user-profile-edit-password").val()==MyProfile.Password?toastr.error("You did not change anything."):$.ajax({type:"PUT",url:"api/userInfo/updatePassword/"+MyProfile.UserInfoId,data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(){toastr.success("Password successfully updated")},error:function(){toastr.error("Unable to save password.")}}):toastr.error("Password does not match")};VendorHistoryNS={};VendorHistoryNS.VendorId=null;VendorHistoryNS.InitializeControl=function(n){VendorHistoryNS.VendorId=n;VendorHistoryNS.LoadControls(n)};VendorHistoryNS.DataBound=function(){$("#saveVendor").focus();$("#vendorModal").animate({scrollTop:$("#saveVendor").offset().top},{duration:3e3,specialEasing:{width:"linear",height:"easeOutBounce"}})};VendorHistoryNS.LoadControls=function(){$("#vendor-alert-history-item").click(function(){VendorHistoryNS.getAlertHistory()});$("#vendor-contact-history-item").click(function(){VendorHistoryNS.getContactHistory()});$("#vendor-history-grid").kendoGrid({dataSource:{transport:{read:{url:"api/vendor/"+VendorHistoryNS.VendorId+"/vendorhistory",dataType:"json"}},schema:{model:{fields:{name:{type:"string"},status:{type:"int"},description:{type:"string"},email:{type:"string"},address:{type:"string"},contactNo:{type:"string"},modifiedOn:{type:"date"},modifiedBy:{type:"string"},createdOn:{type:"date"},createdBy:{type:"string"}}}},pageSize:10},noRecords:!0,pageable:!0,sortable:!0,filterable:!0,scrollable:!1,messages:{noRecords:"History not yet available"},columns:[{field:"name",title:"Company",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"email",title:"Email",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"contactNo",title:"ContactNo",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"status",title:"Status",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"modifiedOn",title:"Modified On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"modifiedBy",title:"Modified By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"createdOn",title:"Created On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"createdBy",title:"Created By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},hidden:!0},]})};VendorHistoryNS.getContactHistory=function(){$("#vendor-contact-history-grid").kendoGrid({dataSource:{transport:{read:{url:"api/vendor/"+VendorHistoryNS.VendorId+"/vendorcontacthistory",dataType:"json"}},schema:{model:{fields:{type:{type:"string"},name:{type:"string"},status:{type:"string"},createdBy:{type:"string"},createdOn:{type:"date"},modifiedOn:{type:"date"},modifiedBy:{type:"string"}}}},pageSize:10},noRecords:!0,pageable:!0,sortable:!0,filterable:!0,scrollable:!1,messages:{noRecords:"History not yet available"},columns:[{field:"name",title:"Name",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"type",title:"Type",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"status",title:"Status",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"createdOn",title:"Created On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"createdBy",title:"Created By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"modifiedOn",title:"Modified On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"modifiedBy",title:"Modified By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},]})};VendorHistoryNS.getAlertHistory=function(){$("#vendor-alert-history-grid").kendoGrid({dataSource:{transport:{read:{url:"api/vendor/"+VendorHistoryNS.VendorId+"/vendoralerthistory",dataType:"json"}},schema:{model:{fields:{value:{type:"string"},name:{type:"string"},emails:{type:"string"},createdBy:{type:"string"},createdOn:{type:"date"},modifiedOn:{type:"date"},modifiedBy:{type:"string"}}}},pageSize:10},noRecords:!0,pageable:!0,sortable:!0,filterable:!0,scrollable:!1,messages:{noRecords:"History not yet available"},columns:[{field:"name",title:"Name",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"value",title:"Value",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"createdOn",title:"Created On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"createdBy",title:"Created By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},{field:"modifiedOn",title:"Modified On",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}},format:"{0:MM/dd/yyyy h:mm:ss tt}"},{field:"modifiedBy",title:"Modified By",width:120,filterable:{cell:{operator:"contains",suggestionOperator:"contains"}}},]})};VendorManagementNS={};VendorManagementNS.VendorID="";VendorManagementNS.Mode=0;VendorManagementNS.GeneralInformationIsModified=!1;VendorManagementNS.ContactInformationIsModified=!1;VendorManagementNS.AlertsIsModified=!1;VendorManagementNS.DeletedContacts=[];VendorManagementNS.EmailPattern=null;VendorManagementNS.clearContactFields=function(){$("#contactFirstName").val(null);$("#contactLastName").val(null);$("#contactEmail").val(null);$("#contactAddress").val(null);$("#contactPhone").val(null);$("#contactPosition").val(null);var n=$("#contactCountry").data("kendoComboBox");n.value("")};VendorManagementNS.initializeAddMenu=function(){$("#vendor-contact-menu").addClass("disabled");$("#vendor-alert-menu").addClass("disabled");$("#vendor-history-menu").addClass("disabled");$("#vendor-contact-tab").attr("href","");$("#vendor-history-tab").attr("href","");$("#vendor-alert-tab").attr("href","");$("#vendor-general-info-tab").trigger("click");$("#vendor-history-menu").hide();$("#vendor-status-block").hide()};VendorManagementNS.initializeEditMenu=function(){$("#vendor-contact-menu").removeClass("disabled");$("#vendor-alert-menu").removeClass("disabled");$("#vendor-history-menu").removeClass("disabled");$("#vendor-contact-tab").attr("href","#vendor-contact-content");$("#vendor-alert-tab").attr("href","#vendor-alert-content");$("#vendor-history-tab").attr("href","#vendor-history-content");$("#vendor-general-info-tab").trigger("click");$("#vendor-history-menu").show()};VendorManagementNS.ReadImage=function(n){var i,r,t;n.files&&n.files[0]&&(i=n.files[0].name.split(".").pop().toLowerCase(),r=["jpg","jpeg","png"].indexOf(i)>-1,r?(t=new FileReader,t.onload=function(n){$("#img-profile").attr("src",n.target.result);var t=n.target.result;imageURL=t.replace(" ","+")},t.readAsDataURL(n.files[0])):(toastr.error("Supported filetypes are only jpg, jpeg and png. Please upload files with these types only"),document.getElementById("picture-file").value=""))};VendorManagementNS.SelectItem=function(n){var t=this.dataItem(n.item.index());$("#contactEmail").html(t.email);$("#contactAddress").html(t.address);$("#contactCountry").html(t.country);$("#contactPhone").html(t.contactNo);$("#contactId").html(t.userInfoId)};VendorManagementNS.init=function(){$("#form-general-info").kendoValidator().data("kendoValidator").validate();VendorManagementNS.registerEvents()};VendorManagementNS.getVendorById=function(n){$.ajax({url:"api/vendor/"+n,type:"GET",contentType:"application/json; charset=utf-8",success:function(n){n?($("#general-name").val(n.generalInformation.name),$("#general-address").val(n.generalInformation.address),$("#general-email").val(n.generalInformation.email),$("input[name=general-status][value="+n.generalInformation.isActive+"]").prop("checked",!0),$("#general-description").val(n.generalInformation.description),$("#general-contact").val(n.generalInformation.contactNo),$("#img-profile").attr("src",n.generalInformation.imageURL),n.generalInformation.email&&(VendorManagementNS.EmailPattern=n.generalInformation.email.split("@")[1]),n.alert&&(document.getElementById("isPrimaryContactChange").checked=n.alert.isPrimaryContactChange==1?!0:!1,document.getElementById("isNewlyAddedContact").checked=n.alert.isNewlyAddedContact==1?!0:!1,document.getElementById("isNewlyAddedProduct").checked=n.alert.isNewlyAddedProducts==1?!0:!1,$("#primaryContactChangeEmails").val(n.alert.primaryContactEmails),$("#newlyAddedContactsEmails").val(n.alert.newlyAddedContactsEmails),$("#newlyAddedProductsEmails").val(n.alert.newlyAddedProductsEmails),n.alert.primaryContactEmails?$("#isPrimaryContactChange").attr("disabled",!1):$("#isPrimaryContactChange").attr("disabled",!0),n.alert.newlyAddedContactsEmails?$("#isNewlyAddedContact").attr("disabled",!1):$("#isNewlyAddedContact").attr("disabled",!0),n.alert.newlyAddedProductsEmails?$("#isNewlyAddedProduct").attr("disabled",!1):$("#isNewlyAddedProduct").attr("disabled",!0),VendorManagementNS.populateContactGrid(n.contactInformation),VendorManagementNS.Mode=1)):toastr.error("Something went wrong with the request!")},error:function(){toastr.error("Something went wrong with the request!")}})};VendorManagementNS.populateContactGrid=function(n){$("#vendor-user-grid").data("kendoGrid").dataSource.data([]);var t=new kendo.data.DataSource({data:n}),i=$("#vendor-user-grid").data("kendoGrid");i.setDataSource(t)};VendorManagementNS.initializeModalControls=function(n){VendorManagementNS.getVendorById(n)};VendorManagementNS.registerEvents=function(){$("#contactCountry").kendoComboBox({dataTextField:"text",dataValueField:"value",change:function(n){var t=n.sender;t.value()&&t.select()===-1&&t.value("")},dataSource:countryList,suggest:!0});$("#img-profile").change(function(){VendorManagementNS.ReadImage(this)});var n=$("#form-general-info").kendoValidator().data("kendoValidator");$("#vendor-general-info-content :input").change(function(){VendorManagementNS.Mode==1&&(VendorManagementNS.GeneralInformationIsModified=!0)});$("#vendor-alert-content :input").change(function(){VendorManagementNS.Mode==1&&(VendorManagementNS.AlertsIsModified=!0)});$("#vendor-user-grid").change(function(){VendorManagementNS.Mode==1&&(VendorManagementNS.ContactInformationIsModified=!0)});$("#primaryContactChangeEmails").change(function(){$(this).val()?$("#isPrimaryContactChange").prop("disabled",!1):($("#isPrimaryContactChange").prop("checked",!1),$("#isPrimaryContactChange").attr("disabled",!0))});$("#newlyAddedContactsEmails").change(function(){$(this).val()?$("#isNewlyAddedContact").prop("disabled",!1):($("#isNewlyAddedContact").prop("checked",!1),$("#isNewlyAddedContact").attr("disabled",!0))});$("#newlyAddedProductsEmails").change(function(){$(this).val()?$("#isNewlyAddedProduct").prop("disabled",!1):($("#isNewlyAddedProduct").prop("checked",!1),$("#isNewlyAddedProduct").attr("disabled",!0))});$("#addVendor").click(function(){$("form#form-general-info").kendoValidator().data("kendoValidator").validate();VendorManagementNS.VendorID="";VendorManagementNS.Mode=0;VendorManagementNS.clearContactFields();$("form#form-general-info").kendoValidator().data("kendoValidator").validate();$("#vendor-user-grid").data("kendoGrid").dataSource.data([]);$("#isNewlyAddedProduct").attr("disabled",!0);$("#isNewlyAddedContact").attr("disabled",!0);$("#isPrimaryContactChange").attr("disabled",!0);VendorManagementNS.DeletedContacts=[];VendorManagementNS.EmailPattern=null;VendorManagementNS.initializeAddMenu()});$("form#form-general-info").submit(function(t){t.preventDefault();n.validate()&&VendorManagementNS.saveVendorGeneralInformation()});$("form#form-vendor-alert").submit(function(n){var r,f,e,t,u,i,o;n.preventDefault();r=!0;$("#primaryContactChangeEmails").val()&&(t=$("#primaryContactChangeEmails").val(),t.length>1&&(u=t.substr(t.length-1),u==";"&&(t=t.slice(0,-1),$("#primaryContactChangeEmails").val(t))),i=[],f=[],i=t.split(";"),$("#primaryContactChangeEmailsValidator").hide(),i.forEach(function(n){if(validateEmail(n)&&n.split("@")[1].toLowerCase()==VendorManagementNS.EmailPattern.toLowerCase())if(f.indexOf(n.toLowerCase())<0)f.push(n.toLowerCase());else{$("#primaryContactChangeEmailsValidator").show();r=!1;return}else{r=!1;$("#primaryContactChangeEmailsValidator").show();return}}));$("#newlyAddedContactsEmails").val()&&(t=$("#newlyAddedContactsEmails").val(),t.length>1&&(u=t.substr(t.length-1),u==";"&&(t=t.slice(0,-1),$("#newlyAddedContactsEmails").val(t))),i=[],e=[],i=t.split(";"),$("#newlyAddedContactsEmailsValidator").hide(),i.forEach(function(n){if(validateEmail(n)&&n.split("@")[1].toLowerCase()==VendorManagementNS.EmailPattern.toLowerCase())if(e.indexOf(n.toLowerCase())<0)e.push(n.toLowerCase());else{$("#newlyAddedContactsEmailsValidator").show();r=!1;return}else{r=!1;$("#newlyAddedContactsEmailsValidator").show();return}}));$("#newlyAddedProductsEmails").val()&&(t=$("#newlyAddedProductsEmails").val(),t.length>1&&(u=t.substr(t.length-1),u==";"&&(t=t.slice(0,-1),$("#newlyAddedProductsEmails").val(t))),i=[],o=[],i=t.split(";"),$("#newlyAddedProductsEmailsValidator").hide(),i.forEach(function(n){if(validateEmail(n)&&n.split("@")[1].toLowerCase()==VendorManagementNS.EmailPattern.toLowerCase())if(o.indexOf(n.toLowerCase())<0)o.push(n.toLowerCase());else{$("#newlyAddedProductsEmailsValidator").show();r=!1;return}else{r=!1;$("#newlyAddedProductsEmailsValidator").show();return}}));r&&VendorManagementNS.saveVendorAlerts()});$("#update-vendor-contact").click(function(){VendorManagementNS.saveVendorContacts()});$("#vendor-user-grid").kendoGrid({dataSource:[],dataBound:function(){$("a.k-button.k-button-icontext.k-grid-delete").html('<span class="fas fa-trash-alt"> <\/span>');$("a.k-button.k-button-icontext.k-grid-delete").css("color : black");$(".is-primary-contact").click(function(){var n=$(this).attr("item-guid");$(".is-primary-contact").each(function(){var i,t;for($(this).attr("data-value",2),i=$("#vendor-user-grid").data().kendoGrid.dataSource.view(),t=0;t<i.length;t++)i[t].uid.toLowerCase()!=n.toLowerCase()?i[t].set("type",2):i[t].set("type",1)});$(this).attr("data-value",1)})},selectable:!0,pageable:!0,columns:[{field:"userInfoId",title:"UserInfoId",hidden:!0},{field:"firstName",title:"First Name",width:"150px"},{field:"lastName",title:"Last Name",width:"150px"},{field:"email",title:"Email",width:"150px"},{field:"position",title:"Position",width:"150px"},{field:"country",title:"Country",width:"150px",hidden:!0},{field:"address",title:"Country",width:"100px",hidden:!0},{field:"contactNo",title:"Contact No.",width:"100px"},{field:"type",title:"Primary",width:"100px",template:'<p class="text-center is-primary-contact"  style="cursor: pointer" item-guid="#:uid#" data-value="#:type#"><span><i class="#: type  == 1 ? "fa fa-check" : "fa fa-times" #"><\/i><\/span><\/p>'},{field:"destroy",title:" ",width:"60px",template:"<center> <span class='fas fa-trash' style='text-align: center; cursor:pointer' onclick=\"VendorManagementNS.deleteUserContactRow('#= uid #')\" > <\/span> <\/center>"}],editable:"inline",noRecords:{template:"No data available."},pageable:!1});$("#vendor-history-menu").click(function(){$("#vendor-history-menu").hasClass("disabled")||VendorManagementNS.getHistory()});$("#add-user-to-list").click(function(n){var i,o,e;n.preventDefault();var r=$("#contactFirstName").val(),u=$("#contactLastName").val(),t=$("#contactEmail").val(),s=$("#contactAddress").val(),f=$("#contactCountry").val(),h=$("#contactPhone").val(),c=$("#contactPosition").val();if(r||$("#firstNameValidator").show(),r&&$("#firstNameValidator").hide(),u||$("#lastNameValidator").show(),u&&$("#lastNameValidator").hide(),t&&validateEmail(t)||$("#emailValidator").show(),!validateEmail(t)||t.split("@")[1]==VendorManagementNS.EmailPattern.toLowerCase()||$("#emailValidator").show(),t&&validateEmail(t)&&t.split("@")[1].toLowerCase()==VendorManagementNS.EmailPattern.toLowerCase()&&$("#emailValidator").hide(),f||$("#countryValidator").show(),f&&$("#countryValidator").hide(),r&&u&&validateEmail(t)&&f&&t.split("@")[1]==VendorManagementNS.EmailPattern.toLowerCase()){for(i=$("#vendor-user-grid").data().kendoGrid.dataSource,o=!1,e=0;e<i._view.length;e++)i._view[e].email.toLowerCase()==t.toLowerCase()&&(o=!0);o||t.split("@")[1].toLowerCase()!=VendorManagementNS.EmailPattern.toLowerCase()?t.split("@")[1].toLowerCase()==VendorManagementNS.EmailPattern.toLowerCase()?toastr.error("Email already exists."):toastr.error("Email should follow the company email's domain."):(i.add({userInfoId:null,firstName:r,lastName:u,email:t,address:s,country:f,contactNo:h,position:c,type:i._view.length<1?1:2}),VendorManagementNS.clearContactFields())}});$("#vendorModal").on("hidden.bs.modal",function(){$("form#form-general-info").trigger("reset");$("#vendorModalLabel").text("Add Vendor");VendorManagementNS.Mode=0;$("#form-general-info").kendoValidator().data("kendoValidator").validate();VendorManagementNS.GeneralInformationIsModified=!1;VendorManagementNS.ContactInformationIsModified=!1;VendorManagementNS.AlertsIsModified=!1;$("#img-profile").attr("src","")})};VendorManagementNS.showAddVendor=function(){VendorManagementNS.Mode=0};VendorManagementNS.showEditVendor=function(n){VendorManagementNS.VendorID=n;VendorManagementNS.Mode=1;$("#vendor-status-block").show();VendorManagementNS.initializeModalControls(VendorManagementNS.VendorID);VendorManagementNS.GeneralInformationIsModified=!1;VendorManagementNS.ContactInformationIsModified=!1;VendorManagementNS.AlertsIsModified=!1;var t=$("#form-general-info").kendoValidator().data("kendoValidator");t.hideMessages();$("#vendorModalLabel").text("Edit Vendor");$("#vendor-history-grid").data("kendoGrid")&&$("#vendor-history-grid").data("kendoGrid").dataSource.data([]);VendorManagementNS.DeletedContacts=[];$("#vendorModal").modal("show");VendorManagementNS.initializeEditMenu()};VendorManagementNS.deleteUserContactRow=function(n){var i,t,r,u;if(confirm("Are you sure you want to delete this item?"))for(i=$("#vendor-user-grid").data().kendoGrid.dataSource.view(),t=0;t<i.length;t++)i[t].uid.toLowerCase()==n.toLowerCase()&&(i[t].type!=1?(r=$("#vendor-user-grid").data("kendoGrid"),u=r.dataSource.getByUid(n.toLowerCase()),r.dataSource.remove(u),i[t].userInfoId!=null&&VendorManagementNS.DeletedContacts.push({UserInfoId:i[t].userInfoId})):toastr.error("Primary contact could not be deleted."))};VendorManagementNS.saveVendorGeneralInformation=function(){var n={};n.GeneralInformation={};n.GeneralInformation.ImageURL=$("#img-profile").attr("src");n.GeneralInformation.Name=$("#general-name").val();n.GeneralInformation.Address=$("#general-address").val();n.GeneralInformation.Email=$("#general-email").val();n.GeneralInformation.IsActive=TryParseInt($("input[name=general-status]:checked").val(),0);n.GeneralInformation.Description=$("#general-description").val();n.GeneralInformation.ContactNo=$("#general-contact").val();VendorManagementNS.Mode==0?(n.VendorId="00000000-0000-0000-0000-000000000000",n.GeneralInformation.IsActive=1,VendorManagementNS.createVendor(n)):(n.GeneralInformation.IsActive=TryParseInt($("input[name=general-status]:checked").val(),0),n.VendorId=VendorManagementNS.VendorID,VendorManagementNS.updateVendor(n))};VendorManagementNS.createVendor=function(n){$.ajax({url:"api/vendor/",type:"POST",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(t){t.error?toastr.error(t.error):($("#contractGrid").data("kendoGrid").dataSource.read(),toastr.success("Vendor successfully added"),VendorManagementNS.Mode=1,VendorManagementNS.DeletedContacts=[],VendorManagementNS.initializeEditMenu(),$("#vendorModalLabel").text("Edit Vendor"),VendorManagementNS.VendorID=t,VendorManagementNS.getVendorById(VendorManagementNS.VendorID),VendorManagementNS.EmailPattern=n.GeneralInformation.Email.split("@")[1],$("#vendor-history-grid").data("kendoGrid")&&$("#vendor-history-grid").data("kendoGrid").dataSource.data([]))},error:function(){toastr.error("Something went wrong with the request!")}})};VendorManagementNS.updateVendor=function(n){$.ajax({url:"api/vendor/"+VendorManagementNS.VendorID,type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(t){t.error?toastr.error(t.error):($("#contractGrid").data("kendoGrid").dataSource.read(),toastr.success("Vendor successfully updated"),VendorManagementNS.Mode=1,VendorManagementNS.DeletedContacts=[],VendorManagementNS.initializeEditMenu(),VendorManagementNS.getVendorById(VendorManagementNS.VendorID),VendorManagementNS.EmailPattern=n.GeneralInformation.Email.split("@")[1],$("#vendor-history-grid").data("kendoGrid")&&$("#vendor-history-grid").data("kendoGrid").dataSource.data([]))},error:function(){toastr.error("Something went wrong with the request!")}})};VendorManagementNS.saveVendorContacts=function(){var n,i,r;VendorManagementNS.clearContactFields();var t=$("#vendor-user-grid").data().kendoGrid.dataSource.view(),u=[],f=0;for(n=0;n<t.length;n++)i={},i.Address=t[n].address,i.FirstName=t[n].firstName,i.LastName=t[n].lastName,i.Email=t[n].email,i.ContactNo=t[n].contactNo,i.Position=t[n].position,i.UserInfoId=t[n].userInfoId==null?"00000000-0000-0000-0000-000000000000":t[n].userInfoId,i.Country=t[n].country,i.Type=t[n].type,u.push(i),t[n].type==1&&f++;if(f==0){toastr.error("Primary contact is required");return}r={};r.DeletedContacts=VendorManagementNS.DeletedContacts;r.ContactInformation=u;r.VendorId=VendorManagementNS.VendorID;VendorManagementNS.updateContacts(r)};VendorManagementNS.updateContacts=function(n){$.ajax({url:"api/vendor/"+VendorManagementNS.VendorID+"/contacts",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(t){t.error?toastr.error(t.error):($("#contractGrid").data("kendoGrid").dataSource.read(),n.DeletedContacts=[],VendorManagementNS.getVendorById(VendorManagementNS.VendorID),toastr.success("Vendor contacts successfully updated"))},error:function(){toastr.error("Something went wrong with the request!")}})};VendorManagementNS.saveVendorAlerts=function(){var n={};n.Alert={};n.Alert.IsPrimaryContactChange=$("#isPrimaryContactChange").is(":checked")?1:0;n.Alert.PrimaryContactEmails=$("#primaryContactChangeEmails").val();n.Alert.IsNewlyAddedContact=$("#isNewlyAddedContact").is(":checked")?1:0;n.Alert.NewlyAddedContactsEmails=$("#newlyAddedContactsEmails").val();n.Alert.IsNewlyAddedProducts=$("#isNewlyAddedProduct").is(":checked")?1:0;n.Alert.NewlyAddedProductsEmails=$("#newlyAddedProductsEmails").val();n.VendorId=VendorManagementNS.VendorID;VendorManagementNS.updateVendorAlerts(n)};VendorManagementNS.updateVendorAlerts=function(n){$.ajax({url:"api/vendor/"+VendorManagementNS.VendorID+"/alerts",type:"PUT",data:JSON.stringify(n),contentType:"application/json; charset=utf-8",success:function(n){n.error?toastr.error(n.error):(VendorManagementNS.getVendorById(VendorManagementNS.VendorID),toastr.success("Vendor alerts successfully updated"))},error:function(){toastr.error("Something went wrong with the request!")}})};VendorManagementNS.getHistory=function(){$.ajax({url:"/history/vendor?vendorId="+VendorManagementNS.VendorID}).done(function(n){$("#vendor-history-content-pane").empty();$("#vendor-history-content-pane").html(n)})};var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_SCOL=$(".right_scol"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");(function(n,t){var i=function(n,t,i){var r;return function(){function e(){i||n.apply(u,f);r=null}var u=this,f=arguments;r?clearTimeout(r):i&&n.apply(u,f);r=setTimeout(e,t||100)}};jQuery.fn[t]=function(n){return n?this.bind("resize",i(n)):this.trigger(t)}})(jQuery,"smartresize");$(document).ready(function(){var n=function(){$RIGHT_SCOL.css("min-height",$(window).height());var n=$BODY.outerHeight(),r=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),t=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),i=n<t?t:n;i-=$NAV_MENU.height()+r;$RIGHT_SCOL.css("min-height",i)};$SIDEBAR_MENU.find("a").on("click",function(){var t=$(this).parent();t.is(".active")?(t.removeClass("active active-sm"),$("ul:first",t).slideUp(function(){n()})):(t.parent().is(".child_menu")||($SIDEBAR_MENU.find("li").removeClass("active active-sm"),$SIDEBAR_MENU.find("li ul").slideUp()),t.addClass("active"),$("ul:first",t).slideDown(function(){n()}))});$MENU_TOGGLE.on("click",function(){$BODY.hasClass("nav-md")?($SIDEBAR_MENU.find("li.active ul").hide(),$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")):($SIDEBAR_MENU.find("li.active-sm ul").show(),$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm"));$BODY.toggleClass("nav-md nav-sm");n()});$SIDEBAR_MENU.find('a[href="'+CURRENT_URL+'"]').parent("li").addClass("current-page");$SIDEBAR_MENU.find("a").filter(function(){return this.href==CURRENT_URL}).parent("li").addClass("current-page").parents("ul").slideDown(function(){n()}).parent().addClass("active");$(window).smartresize(function(){n()});n();$.fn.mCustomScrollbar&&$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:!0,theme:"minimal",mouseWheel:{preventDefault:!0}})});$(document).ready(function(){$(".collapse-link").on("click",function(){var n=$(this).closest(".x_panel"),i=$(this).find("i"),t=n.find(".x_content");n.attr("style")?t.slideToggle(200,function(){n.removeAttr("style")}):(t.slideToggle(200),n.css("height","auto"));i.toggleClass("fa-chevron-up fa-chevron-down")});$(".close-link").click(function(){var n=$(this).closest(".x_panel");n.remove()})});$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})});$(".progress .progress-bar")[0]&&$(".progress .progress-bar").progressbar();$(document).ready(function(){if($(".js-switch")[0]){var n=Array.prototype.slice.call(document.querySelectorAll(".js-switch"));n.forEach(function(n){var t=new Switchery(n,{color:"#26B99A"})})}});$(document).ready(function(){$("input.flat")[0]&&$(document).ready(function(){$("input.flat").iCheck({checkboxClass:"icheckbox_flat-green",radioClass:"iradio_flat-green"})})});$("table input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$("table input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});checkState="";$(".bulk_action input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$(".bulk_action input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});$(".bulk_action input#check-all").on("ifChecked",function(){checkState="all";countChecked()});$(".bulk_action input#check-all").on("ifUnchecked",function(){checkState="none";countChecked()});$(document).ready(function(){$(".expand").on("click",function(){$(this).next().slideToggle(200);$expand=$(this).find(">:first-child");$expand.text()=="+"?$expand.text("-"):$expand.text("+")})});typeof NProgress!="undefined"&&($(document).ready(function(){NProgress.start()}),$(window).load(function(){NProgress.done()}));